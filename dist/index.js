(()=>{var e={7351:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){if(r===undefined)r=n;Object.defineProperty(e,r,{enumerable:true,get:function(){return t[n]}})}:function(e,t,n,r){if(r===undefined)r=n;e[r]=t[n]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)if(n!=="default"&&Object.hasOwnProperty.call(e,n))r(t,e,n);i(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.issue=t.issueCommand=void 0;const o=s(n(2037));const f=n(5278);function issueCommand(e,t,n){const r=new Command(e,t,n);process.stdout.write(r.toString()+o.EOL)}t.issueCommand=issueCommand;function issue(e,t=""){issueCommand(e,{},t)}t.issue=issue;const u="::";class Command{constructor(e,t,n){if(!e){e="missing.command"}this.command=e;this.properties=t;this.message=n}toString(){let e=u+this.command;if(this.properties&&Object.keys(this.properties).length>0){e+=" ";let t=true;for(const n in this.properties){if(this.properties.hasOwnProperty(n)){const r=this.properties[n];if(r){if(t){t=false}else{e+=","}e+=`${n}=${escapeProperty(r)}`}}}}e+=`${u}${escapeData(this.message)}`;return e}}function escapeData(e){return f.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function escapeProperty(e){return f.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}},2186:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){if(r===undefined)r=n;Object.defineProperty(e,r,{enumerable:true,get:function(){return t[n]}})}:function(e,t,n,r){if(r===undefined)r=n;e[r]=t[n]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)if(n!=="default"&&Object.hasOwnProperty.call(e,n))r(t,e,n);i(t,e);return t};var o=this&&this.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.getIDToken=t.getState=t.saveState=t.group=t.endGroup=t.startGroup=t.info=t.notice=t.warning=t.error=t.debug=t.isDebug=t.setFailed=t.setCommandEcho=t.setOutput=t.getBooleanInput=t.getMultilineInput=t.getInput=t.addPath=t.setSecret=t.exportVariable=t.ExitCode=void 0;const f=n(7351);const u=n(717);const l=n(5278);const h=s(n(2037));const p=s(n(1017));const g=n(8041);var _;(function(e){e[e["Success"]=0]="Success";e[e["Failure"]=1]="Failure"})(_=t.ExitCode||(t.ExitCode={}));function exportVariable(e,t){const n=l.toCommandValue(t);process.env[e]=n;const r=process.env["GITHUB_ENV"]||"";if(r){const t="_GitHubActionsFileCommandDelimeter_";const r=`${e}<<${t}${h.EOL}${n}${h.EOL}${t}`;u.issueCommand("ENV",r)}else{f.issueCommand("set-env",{name:e},n)}}t.exportVariable=exportVariable;function setSecret(e){f.issueCommand("add-mask",{},e)}t.setSecret=setSecret;function addPath(e){const t=process.env["GITHUB_PATH"]||"";if(t){u.issueCommand("PATH",e)}else{f.issueCommand("add-path",{},e)}process.env["PATH"]=`${e}${p.delimiter}${process.env["PATH"]}`}t.addPath=addPath;function getInput(e,t){const n=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!n){throw new Error(`Input required and not supplied: ${e}`)}if(t&&t.trimWhitespace===false){return n}return n.trim()}t.getInput=getInput;function getMultilineInput(e,t){const n=getInput(e,t).split("\n").filter((e=>e!==""));return n}t.getMultilineInput=getMultilineInput;function getBooleanInput(e,t){const n=["true","True","TRUE"];const r=["false","False","FALSE"];const i=getInput(e,t);if(n.includes(i))return true;if(r.includes(i))return false;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${e}\n`+`Support boolean input list: \`true | True | TRUE | false | False | FALSE\``)}t.getBooleanInput=getBooleanInput;function setOutput(e,t){process.stdout.write(h.EOL);f.issueCommand("set-output",{name:e},t)}t.setOutput=setOutput;function setCommandEcho(e){f.issue("echo",e?"on":"off")}t.setCommandEcho=setCommandEcho;function setFailed(e){process.exitCode=_.Failure;error(e)}t.setFailed=setFailed;function isDebug(){return process.env["RUNNER_DEBUG"]==="1"}t.isDebug=isDebug;function debug(e){f.issueCommand("debug",{},e)}t.debug=debug;function error(e,t={}){f.issueCommand("error",l.toCommandProperties(t),e instanceof Error?e.toString():e)}t.error=error;function warning(e,t={}){f.issueCommand("warning",l.toCommandProperties(t),e instanceof Error?e.toString():e)}t.warning=warning;function notice(e,t={}){f.issueCommand("notice",l.toCommandProperties(t),e instanceof Error?e.toString():e)}t.notice=notice;function info(e){process.stdout.write(e+h.EOL)}t.info=info;function startGroup(e){f.issue("group",e)}t.startGroup=startGroup;function endGroup(){f.issue("endgroup")}t.endGroup=endGroup;function group(e,t){return o(this,void 0,void 0,(function*(){startGroup(e);let n;try{n=yield t()}finally{endGroup()}return n}))}t.group=group;function saveState(e,t){f.issueCommand("save-state",{name:e},t)}t.saveState=saveState;function getState(e){return process.env[`STATE_${e}`]||""}t.getState=getState;function getIDToken(e){return o(this,void 0,void 0,(function*(){return yield g.OidcClient.getIDToken(e)}))}t.getIDToken=getIDToken;var E=n(1327);Object.defineProperty(t,"summary",{enumerable:true,get:function(){return E.summary}});var y=n(1327);Object.defineProperty(t,"markdownSummary",{enumerable:true,get:function(){return y.markdownSummary}});var m=n(2981);Object.defineProperty(t,"toPosixPath",{enumerable:true,get:function(){return m.toPosixPath}});Object.defineProperty(t,"toWin32Path",{enumerable:true,get:function(){return m.toWin32Path}});Object.defineProperty(t,"toPlatformPath",{enumerable:true,get:function(){return m.toPlatformPath}})},717:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){if(r===undefined)r=n;Object.defineProperty(e,r,{enumerable:true,get:function(){return t[n]}})}:function(e,t,n,r){if(r===undefined)r=n;e[r]=t[n]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)if(n!=="default"&&Object.hasOwnProperty.call(e,n))r(t,e,n);i(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.issueCommand=void 0;const o=s(n(7147));const f=s(n(2037));const u=n(5278);function issueCommand(e,t){const n=process.env[`GITHUB_${e}`];if(!n){throw new Error(`Unable to find environment variable for file command ${e}`)}if(!o.existsSync(n)){throw new Error(`Missing file at path: ${n}`)}o.appendFileSync(n,`${u.toCommandValue(t)}${f.EOL}`,{encoding:"utf8"})}t.issueCommand=issueCommand},8041:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.OidcClient=void 0;const i=n(6255);const s=n(5526);const o=n(2186);class OidcClient{static createHttpClient(e=true,t=10){const n={allowRetries:e,maxRetries:t};return new i.HttpClient("actions/oidc-client",[new s.BearerCredentialHandler(OidcClient.getRequestToken())],n)}static getRequestToken(){const e=process.env["ACTIONS_ID_TOKEN_REQUEST_TOKEN"];if(!e){throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_TOKEN env variable")}return e}static getIDTokenUrl(){const e=process.env["ACTIONS_ID_TOKEN_REQUEST_URL"];if(!e){throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_URL env variable")}return e}static getCall(e){var t;return r(this,void 0,void 0,(function*(){const n=OidcClient.createHttpClient();const r=yield n.getJson(e).catch((e=>{throw new Error(`Failed to get ID Token. \n \n        Error Code : ${e.statusCode}\n \n        Error Message: ${e.result.message}`)}));const i=(t=r.result)===null||t===void 0?void 0:t.value;if(!i){throw new Error("Response json body do not have ID Token field")}return i}))}static getIDToken(e){return r(this,void 0,void 0,(function*(){try{let t=OidcClient.getIDTokenUrl();if(e){const n=encodeURIComponent(e);t=`${t}&audience=${n}`}o.debug(`ID token url is ${t}`);const n=yield OidcClient.getCall(t);o.setSecret(n);return n}catch(e){throw new Error(`Error message: ${e.message}`)}}))}}t.OidcClient=OidcClient},2981:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){if(r===undefined)r=n;Object.defineProperty(e,r,{enumerable:true,get:function(){return t[n]}})}:function(e,t,n,r){if(r===undefined)r=n;e[r]=t[n]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)if(n!=="default"&&Object.hasOwnProperty.call(e,n))r(t,e,n);i(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.toPlatformPath=t.toWin32Path=t.toPosixPath=void 0;const o=s(n(1017));function toPosixPath(e){return e.replace(/[\\]/g,"/")}t.toPosixPath=toPosixPath;function toWin32Path(e){return e.replace(/[/]/g,"\\")}t.toWin32Path=toWin32Path;function toPlatformPath(e){return e.replace(/[/\\]/g,o.sep)}t.toPlatformPath=toPlatformPath},1327:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.summary=t.markdownSummary=t.SUMMARY_DOCS_URL=t.SUMMARY_ENV_VAR=void 0;const i=n(2037);const s=n(7147);const{access:o,appendFile:f,writeFile:u}=s.promises;t.SUMMARY_ENV_VAR="GITHUB_STEP_SUMMARY";t.SUMMARY_DOCS_URL="https://docs.github.com/actions/using-workflows/workflow-commands-for-github-actions#adding-a-job-summary";class Summary{constructor(){this._buffer=""}filePath(){return r(this,void 0,void 0,(function*(){if(this._filePath){return this._filePath}const e=process.env[t.SUMMARY_ENV_VAR];if(!e){throw new Error(`Unable to find environment variable for $${t.SUMMARY_ENV_VAR}. Check if your runtime environment supports job summaries.`)}try{yield o(e,s.constants.R_OK|s.constants.W_OK)}catch(t){throw new Error(`Unable to access summary file: '${e}'. Check if the file has correct read/write permissions.`)}this._filePath=e;return this._filePath}))}wrap(e,t,n={}){const r=Object.entries(n).map((([e,t])=>` ${e}="${t}"`)).join("");if(!t){return`<${e}${r}>`}return`<${e}${r}>${t}</${e}>`}write(e){return r(this,void 0,void 0,(function*(){const t=!!(e===null||e===void 0?void 0:e.overwrite);const n=yield this.filePath();const r=t?u:f;yield r(n,this._buffer,{encoding:"utf8"});return this.emptyBuffer()}))}clear(){return r(this,void 0,void 0,(function*(){return this.emptyBuffer().write({overwrite:true})}))}stringify(){return this._buffer}isEmptyBuffer(){return this._buffer.length===0}emptyBuffer(){this._buffer="";return this}addRaw(e,t=false){this._buffer+=e;return t?this.addEOL():this}addEOL(){return this.addRaw(i.EOL)}addCodeBlock(e,t){const n=Object.assign({},t&&{lang:t});const r=this.wrap("pre",this.wrap("code",e),n);return this.addRaw(r).addEOL()}addList(e,t=false){const n=t?"ol":"ul";const r=e.map((e=>this.wrap("li",e))).join("");const i=this.wrap(n,r);return this.addRaw(i).addEOL()}addTable(e){const t=e.map((e=>{const t=e.map((e=>{if(typeof e==="string"){return this.wrap("td",e)}const{header:t,data:n,colspan:r,rowspan:i}=e;const s=t?"th":"td";const o=Object.assign(Object.assign({},r&&{colspan:r}),i&&{rowspan:i});return this.wrap(s,n,o)})).join("");return this.wrap("tr",t)})).join("");const n=this.wrap("table",t);return this.addRaw(n).addEOL()}addDetails(e,t){const n=this.wrap("details",this.wrap("summary",e)+t);return this.addRaw(n).addEOL()}addImage(e,t,n){const{width:r,height:i}=n||{};const s=Object.assign(Object.assign({},r&&{width:r}),i&&{height:i});const o=this.wrap("img",null,Object.assign({src:e,alt:t},s));return this.addRaw(o).addEOL()}addHeading(e,t){const n=`h${t}`;const r=["h1","h2","h3","h4","h5","h6"].includes(n)?n:"h1";const i=this.wrap(r,e);return this.addRaw(i).addEOL()}addSeparator(){const e=this.wrap("hr",null);return this.addRaw(e).addEOL()}addBreak(){const e=this.wrap("br",null);return this.addRaw(e).addEOL()}addQuote(e,t){const n=Object.assign({},t&&{cite:t});const r=this.wrap("blockquote",e,n);return this.addRaw(r).addEOL()}addLink(e,t){const n=this.wrap("a",e,{href:t});return this.addRaw(n).addEOL()}}const l=new Summary;t.markdownSummary=l;t.summary=l},5278:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.toCommandProperties=t.toCommandValue=void 0;function toCommandValue(e){if(e===null||e===undefined){return""}else if(typeof e==="string"||e instanceof String){return e}return JSON.stringify(e)}t.toCommandValue=toCommandValue;function toCommandProperties(e){if(!Object.keys(e).length){return{}}return{title:e.title,file:e.file,line:e.startLine,endLine:e.endLine,col:e.startColumn,endColumn:e.endColumn}}t.toCommandProperties=toCommandProperties},5526:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.PersonalAccessTokenCredentialHandler=t.BearerCredentialHandler=t.BasicCredentialHandler=void 0;class BasicCredentialHandler{constructor(e,t){this.username=e;this.password=t}prepareRequest(e){if(!e.headers){throw Error("The request has no headers")}e.headers["Authorization"]=`Basic ${Buffer.from(`${this.username}:${this.password}`).toString("base64")}`}canHandleAuthentication(){return false}handleAuthentication(){return n(this,void 0,void 0,(function*(){throw new Error("not implemented")}))}}t.BasicCredentialHandler=BasicCredentialHandler;class BearerCredentialHandler{constructor(e){this.token=e}prepareRequest(e){if(!e.headers){throw Error("The request has no headers")}e.headers["Authorization"]=`Bearer ${this.token}`}canHandleAuthentication(){return false}handleAuthentication(){return n(this,void 0,void 0,(function*(){throw new Error("not implemented")}))}}t.BearerCredentialHandler=BearerCredentialHandler;class PersonalAccessTokenCredentialHandler{constructor(e){this.token=e}prepareRequest(e){if(!e.headers){throw Error("The request has no headers")}e.headers["Authorization"]=`Basic ${Buffer.from(`PAT:${this.token}`).toString("base64")}`}canHandleAuthentication(){return false}handleAuthentication(){return n(this,void 0,void 0,(function*(){throw new Error("not implemented")}))}}t.PersonalAccessTokenCredentialHandler=PersonalAccessTokenCredentialHandler},6255:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){if(r===undefined)r=n;Object.defineProperty(e,r,{enumerable:true,get:function(){return t[n]}})}:function(e,t,n,r){if(r===undefined)r=n;e[r]=t[n]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)if(n!=="default"&&Object.hasOwnProperty.call(e,n))r(t,e,n);i(t,e);return t};var o=this&&this.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.HttpClient=t.isHttps=t.HttpClientResponse=t.HttpClientError=t.getProxyUrl=t.MediaTypes=t.Headers=t.HttpCodes=void 0;const f=s(n(3685));const u=s(n(5687));const l=s(n(9835));const h=s(n(4294));var p;(function(e){e[e["OK"]=200]="OK";e[e["MultipleChoices"]=300]="MultipleChoices";e[e["MovedPermanently"]=301]="MovedPermanently";e[e["ResourceMoved"]=302]="ResourceMoved";e[e["SeeOther"]=303]="SeeOther";e[e["NotModified"]=304]="NotModified";e[e["UseProxy"]=305]="UseProxy";e[e["SwitchProxy"]=306]="SwitchProxy";e[e["TemporaryRedirect"]=307]="TemporaryRedirect";e[e["PermanentRedirect"]=308]="PermanentRedirect";e[e["BadRequest"]=400]="BadRequest";e[e["Unauthorized"]=401]="Unauthorized";e[e["PaymentRequired"]=402]="PaymentRequired";e[e["Forbidden"]=403]="Forbidden";e[e["NotFound"]=404]="NotFound";e[e["MethodNotAllowed"]=405]="MethodNotAllowed";e[e["NotAcceptable"]=406]="NotAcceptable";e[e["ProxyAuthenticationRequired"]=407]="ProxyAuthenticationRequired";e[e["RequestTimeout"]=408]="RequestTimeout";e[e["Conflict"]=409]="Conflict";e[e["Gone"]=410]="Gone";e[e["TooManyRequests"]=429]="TooManyRequests";e[e["InternalServerError"]=500]="InternalServerError";e[e["NotImplemented"]=501]="NotImplemented";e[e["BadGateway"]=502]="BadGateway";e[e["ServiceUnavailable"]=503]="ServiceUnavailable";e[e["GatewayTimeout"]=504]="GatewayTimeout"})(p=t.HttpCodes||(t.HttpCodes={}));var g;(function(e){e["Accept"]="accept";e["ContentType"]="content-type"})(g=t.Headers||(t.Headers={}));var _;(function(e){e["ApplicationJson"]="application/json"})(_=t.MediaTypes||(t.MediaTypes={}));function getProxyUrl(e){const t=l.getProxyUrl(new URL(e));return t?t.href:""}t.getProxyUrl=getProxyUrl;const E=[p.MovedPermanently,p.ResourceMoved,p.SeeOther,p.TemporaryRedirect,p.PermanentRedirect];const y=[p.BadGateway,p.ServiceUnavailable,p.GatewayTimeout];const m=["OPTIONS","GET","DELETE","HEAD"];const I=10;const b=5;class HttpClientError extends Error{constructor(e,t){super(e);this.name="HttpClientError";this.statusCode=t;Object.setPrototypeOf(this,HttpClientError.prototype)}}t.HttpClientError=HttpClientError;class HttpClientResponse{constructor(e){this.message=e}readBody(){return o(this,void 0,void 0,(function*(){return new Promise((e=>o(this,void 0,void 0,(function*(){let t=Buffer.alloc(0);this.message.on("data",(e=>{t=Buffer.concat([t,e])}));this.message.on("end",(()=>{e(t.toString())}))}))))}))}}t.HttpClientResponse=HttpClientResponse;function isHttps(e){const t=new URL(e);return t.protocol==="https:"}t.isHttps=isHttps;class HttpClient{constructor(e,t,n){this._ignoreSslError=false;this._allowRedirects=true;this._allowRedirectDowngrade=false;this._maxRedirects=50;this._allowRetries=false;this._maxRetries=1;this._keepAlive=false;this._disposed=false;this.userAgent=e;this.handlers=t||[];this.requestOptions=n;if(n){if(n.ignoreSslError!=null){this._ignoreSslError=n.ignoreSslError}this._socketTimeout=n.socketTimeout;if(n.allowRedirects!=null){this._allowRedirects=n.allowRedirects}if(n.allowRedirectDowngrade!=null){this._allowRedirectDowngrade=n.allowRedirectDowngrade}if(n.maxRedirects!=null){this._maxRedirects=Math.max(n.maxRedirects,0)}if(n.keepAlive!=null){this._keepAlive=n.keepAlive}if(n.allowRetries!=null){this._allowRetries=n.allowRetries}if(n.maxRetries!=null){this._maxRetries=n.maxRetries}}}options(e,t){return o(this,void 0,void 0,(function*(){return this.request("OPTIONS",e,null,t||{})}))}get(e,t){return o(this,void 0,void 0,(function*(){return this.request("GET",e,null,t||{})}))}del(e,t){return o(this,void 0,void 0,(function*(){return this.request("DELETE",e,null,t||{})}))}post(e,t,n){return o(this,void 0,void 0,(function*(){return this.request("POST",e,t,n||{})}))}patch(e,t,n){return o(this,void 0,void 0,(function*(){return this.request("PATCH",e,t,n||{})}))}put(e,t,n){return o(this,void 0,void 0,(function*(){return this.request("PUT",e,t,n||{})}))}head(e,t){return o(this,void 0,void 0,(function*(){return this.request("HEAD",e,null,t||{})}))}sendStream(e,t,n,r){return o(this,void 0,void 0,(function*(){return this.request(e,t,n,r)}))}getJson(e,t={}){return o(this,void 0,void 0,(function*(){t[g.Accept]=this._getExistingOrDefaultHeader(t,g.Accept,_.ApplicationJson);const n=yield this.get(e,t);return this._processResponse(n,this.requestOptions)}))}postJson(e,t,n={}){return o(this,void 0,void 0,(function*(){const r=JSON.stringify(t,null,2);n[g.Accept]=this._getExistingOrDefaultHeader(n,g.Accept,_.ApplicationJson);n[g.ContentType]=this._getExistingOrDefaultHeader(n,g.ContentType,_.ApplicationJson);const i=yield this.post(e,r,n);return this._processResponse(i,this.requestOptions)}))}putJson(e,t,n={}){return o(this,void 0,void 0,(function*(){const r=JSON.stringify(t,null,2);n[g.Accept]=this._getExistingOrDefaultHeader(n,g.Accept,_.ApplicationJson);n[g.ContentType]=this._getExistingOrDefaultHeader(n,g.ContentType,_.ApplicationJson);const i=yield this.put(e,r,n);return this._processResponse(i,this.requestOptions)}))}patchJson(e,t,n={}){return o(this,void 0,void 0,(function*(){const r=JSON.stringify(t,null,2);n[g.Accept]=this._getExistingOrDefaultHeader(n,g.Accept,_.ApplicationJson);n[g.ContentType]=this._getExistingOrDefaultHeader(n,g.ContentType,_.ApplicationJson);const i=yield this.patch(e,r,n);return this._processResponse(i,this.requestOptions)}))}request(e,t,n,r){return o(this,void 0,void 0,(function*(){if(this._disposed){throw new Error("Client has already been disposed.")}const i=new URL(t);let s=this._prepareRequest(e,i,r);const o=this._allowRetries&&m.includes(e)?this._maxRetries+1:1;let f=0;let u;do{u=yield this.requestRaw(s,n);if(u&&u.message&&u.message.statusCode===p.Unauthorized){let e;for(const t of this.handlers){if(t.canHandleAuthentication(u)){e=t;break}}if(e){return e.handleAuthentication(this,s,n)}else{return u}}let t=this._maxRedirects;while(u.message.statusCode&&E.includes(u.message.statusCode)&&this._allowRedirects&&t>0){const o=u.message.headers["location"];if(!o){break}const f=new URL(o);if(i.protocol==="https:"&&i.protocol!==f.protocol&&!this._allowRedirectDowngrade){throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.")}yield u.readBody();if(f.hostname!==i.hostname){for(const e in r){if(e.toLowerCase()==="authorization"){delete r[e]}}}s=this._prepareRequest(e,f,r);u=yield this.requestRaw(s,n);t--}if(!u.message.statusCode||!y.includes(u.message.statusCode)){return u}f+=1;if(f<o){yield u.readBody();yield this._performExponentialBackoff(f)}}while(f<o);return u}))}dispose(){if(this._agent){this._agent.destroy()}this._disposed=true}requestRaw(e,t){return o(this,void 0,void 0,(function*(){return new Promise(((n,r)=>{function callbackForResult(e,t){if(e){r(e)}else if(!t){r(new Error("Unknown error"))}else{n(t)}}this.requestRawWithCallback(e,t,callbackForResult)}))}))}requestRawWithCallback(e,t,n){if(typeof t==="string"){if(!e.options.headers){e.options.headers={}}e.options.headers["Content-Length"]=Buffer.byteLength(t,"utf8")}let r=false;function handleResult(e,t){if(!r){r=true;n(e,t)}}const i=e.httpModule.request(e.options,(e=>{const t=new HttpClientResponse(e);handleResult(undefined,t)}));let s;i.on("socket",(e=>{s=e}));i.setTimeout(this._socketTimeout||3*6e4,(()=>{if(s){s.end()}handleResult(new Error(`Request timeout: ${e.options.path}`))}));i.on("error",(function(e){handleResult(e)}));if(t&&typeof t==="string"){i.write(t,"utf8")}if(t&&typeof t!=="string"){t.on("close",(function(){i.end()}));t.pipe(i)}else{i.end()}}getAgent(e){const t=new URL(e);return this._getAgent(t)}_prepareRequest(e,t,n){const r={};r.parsedUrl=t;const i=r.parsedUrl.protocol==="https:";r.httpModule=i?u:f;const s=i?443:80;r.options={};r.options.host=r.parsedUrl.hostname;r.options.port=r.parsedUrl.port?parseInt(r.parsedUrl.port):s;r.options.path=(r.parsedUrl.pathname||"")+(r.parsedUrl.search||"");r.options.method=e;r.options.headers=this._mergeHeaders(n);if(this.userAgent!=null){r.options.headers["user-agent"]=this.userAgent}r.options.agent=this._getAgent(r.parsedUrl);if(this.handlers){for(const e of this.handlers){e.prepareRequest(r.options)}}return r}_mergeHeaders(e){if(this.requestOptions&&this.requestOptions.headers){return Object.assign({},lowercaseKeys(this.requestOptions.headers),lowercaseKeys(e||{}))}return lowercaseKeys(e||{})}_getExistingOrDefaultHeader(e,t,n){let r;if(this.requestOptions&&this.requestOptions.headers){r=lowercaseKeys(this.requestOptions.headers)[t]}return e[t]||r||n}_getAgent(e){let t;const n=l.getProxyUrl(e);const r=n&&n.hostname;if(this._keepAlive&&r){t=this._proxyAgent}if(this._keepAlive&&!r){t=this._agent}if(t){return t}const i=e.protocol==="https:";let s=100;if(this.requestOptions){s=this.requestOptions.maxSockets||f.globalAgent.maxSockets}if(n&&n.hostname){const e={maxSockets:s,keepAlive:this._keepAlive,proxy:Object.assign(Object.assign({},(n.username||n.password)&&{proxyAuth:`${n.username}:${n.password}`}),{host:n.hostname,port:n.port})};let r;const o=n.protocol==="https:";if(i){r=o?h.httpsOverHttps:h.httpsOverHttp}else{r=o?h.httpOverHttps:h.httpOverHttp}t=r(e);this._proxyAgent=t}if(this._keepAlive&&!t){const e={keepAlive:this._keepAlive,maxSockets:s};t=i?new u.Agent(e):new f.Agent(e);this._agent=t}if(!t){t=i?u.globalAgent:f.globalAgent}if(i&&this._ignoreSslError){t.options=Object.assign(t.options||{},{rejectUnauthorized:false})}return t}_performExponentialBackoff(e){return o(this,void 0,void 0,(function*(){e=Math.min(I,e);const t=b*Math.pow(2,e);return new Promise((e=>setTimeout((()=>e()),t)))}))}_processResponse(e,t){return o(this,void 0,void 0,(function*(){return new Promise(((n,r)=>o(this,void 0,void 0,(function*(){const i=e.message.statusCode||0;const s={statusCode:i,result:null,headers:{}};if(i===p.NotFound){n(s)}function dateTimeDeserializer(e,t){if(typeof t==="string"){const e=new Date(t);if(!isNaN(e.valueOf())){return e}}return t}let o;let f;try{f=yield e.readBody();if(f&&f.length>0){if(t&&t.deserializeDates){o=JSON.parse(f,dateTimeDeserializer)}else{o=JSON.parse(f)}s.result=o}s.headers=e.message.headers}catch(e){}if(i>299){let e;if(o&&o.message){e=o.message}else if(f&&f.length>0){e=f}else{e=`Failed request: (${i})`}const t=new HttpClientError(e,i);t.result=s.result;r(t)}else{n(s)}}))))}))}}t.HttpClient=HttpClient;const lowercaseKeys=e=>Object.keys(e).reduce(((t,n)=>(t[n.toLowerCase()]=e[n],t)),{})},9835:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.checkBypass=t.getProxyUrl=void 0;function getProxyUrl(e){const t=e.protocol==="https:";if(checkBypass(e)){return undefined}const n=(()=>{if(t){return process.env["https_proxy"]||process.env["HTTPS_PROXY"]}else{return process.env["http_proxy"]||process.env["HTTP_PROXY"]}})();if(n){return new URL(n)}else{return undefined}}t.getProxyUrl=getProxyUrl;function checkBypass(e){if(!e.hostname){return false}const t=process.env["no_proxy"]||process.env["NO_PROXY"]||"";if(!t){return false}let n;if(e.port){n=Number(e.port)}else if(e.protocol==="http:"){n=80}else if(e.protocol==="https:"){n=443}const r=[e.hostname.toUpperCase()];if(typeof n==="number"){r.push(`${r[0]}:${n}`)}for(const e of t.split(",").map((e=>e.trim().toUpperCase())).filter((e=>e))){if(r.some((t=>t===e))){return true}}return false}t.checkBypass=checkBypass},9348:e=>{e.exports={newInvalidAsn1Error:function(e){var t=new Error;t.name="InvalidAsn1Error";t.message=e||"";return t}}},194:(e,t,n)=>{var r=n(9348);var i=n(2473);var s=n(290);var o=n(3200);e.exports={Reader:s,Writer:o};for(var f in i){if(i.hasOwnProperty(f))e.exports[f]=i[f]}for(var u in r){if(r.hasOwnProperty(u))e.exports[u]=r[u]}},290:(e,t,n)=>{var r=n(9491);var i=n(5118).Buffer;var s=n(2473);var o=n(9348);var f=o.newInvalidAsn1Error;function Reader(e){if(!e||!i.isBuffer(e))throw new TypeError("data must be a node Buffer");this._buf=e;this._size=e.length;this._len=0;this._offset=0}Object.defineProperty(Reader.prototype,"length",{enumerable:true,get:function(){return this._len}});Object.defineProperty(Reader.prototype,"offset",{enumerable:true,get:function(){return this._offset}});Object.defineProperty(Reader.prototype,"remain",{get:function(){return this._size-this._offset}});Object.defineProperty(Reader.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}});Reader.prototype.readByte=function(e){if(this._size-this._offset<1)return null;var t=this._buf[this._offset]&255;if(!e)this._offset+=1;return t};Reader.prototype.peek=function(){return this.readByte(true)};Reader.prototype.readLength=function(e){if(e===undefined)e=this._offset;if(e>=this._size)return null;var t=this._buf[e++]&255;if(t===null)return null;if((t&128)===128){t&=127;if(t===0)throw f("Indefinite length not supported");if(t>4)throw f("encoding too long");if(this._size-e<t)return null;this._len=0;for(var n=0;n<t;n++)this._len=(this._len<<8)+(this._buf[e++]&255)}else{this._len=t}return e};Reader.prototype.readSequence=function(e){var t=this.peek();if(t===null)return null;if(e!==undefined&&e!==t)throw f("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var n=this.readLength(this._offset+1);if(n===null)return null;this._offset=n;return t};Reader.prototype.readInt=function(){return this._readTag(s.Integer)};Reader.prototype.readBoolean=function(){return this._readTag(s.Boolean)===0?false:true};Reader.prototype.readEnumeration=function(){return this._readTag(s.Enumeration)};Reader.prototype.readString=function(e,t){if(!e)e=s.OctetString;var n=this.peek();if(n===null)return null;if(n!==e)throw f("Expected 0x"+e.toString(16)+": got 0x"+n.toString(16));var r=this.readLength(this._offset+1);if(r===null)return null;if(this.length>this._size-r)return null;this._offset=r;if(this.length===0)return t?i.alloc(0):"";var o=this._buf.slice(this._offset,this._offset+this.length);this._offset+=this.length;return t?o:o.toString("utf8")};Reader.prototype.readOID=function(e){if(!e)e=s.OID;var t=this.readString(e,true);if(t===null)return null;var n=[];var r=0;for(var i=0;i<t.length;i++){var o=t[i]&255;r<<=7;r+=o&127;if((o&128)===0){n.push(r);r=0}}r=n.shift();n.unshift(r%40);n.unshift(r/40>>0);return n.join(".")};Reader.prototype._readTag=function(e){r.ok(e!==undefined);var t=this.peek();if(t===null)return null;if(t!==e)throw f("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var n=this.readLength(this._offset+1);if(n===null)return null;if(this.length>4)throw f("Integer too long: "+this.length);if(this.length>this._size-n)return null;this._offset=n;var i=this._buf[this._offset];var s=0;for(var o=0;o<this.length;o++){s<<=8;s|=this._buf[this._offset++]&255}if((i&128)===128&&o!==4)s-=1<<o*8;return s>>0};e.exports=Reader},2473:e=>{e.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}},3200:(e,t,n)=>{var r=n(9491);var i=n(5118).Buffer;var s=n(2473);var o=n(9348);var f=o.newInvalidAsn1Error;var u={size:1024,growthFactor:8};function merge(e,t){r.ok(e);r.equal(typeof e,"object");r.ok(t);r.equal(typeof t,"object");var n=Object.getOwnPropertyNames(e);n.forEach((function(n){if(t[n])return;var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r)}));return t}function Writer(e){e=merge(u,e||{});this._buf=i.alloc(e.size||1024);this._size=this._buf.length;this._offset=0;this._options=e;this._seq=[]}Object.defineProperty(Writer.prototype,"buffer",{get:function(){if(this._seq.length)throw f(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}});Writer.prototype.writeByte=function(e){if(typeof e!=="number")throw new TypeError("argument must be a Number");this._ensure(1);this._buf[this._offset++]=e};Writer.prototype.writeInt=function(e,t){if(typeof e!=="number")throw new TypeError("argument must be a Number");if(typeof t!=="number")t=s.Integer;var n=4;while(((e&4286578688)===0||(e&4286578688)===4286578688>>0)&&n>1){n--;e<<=8}if(n>4)throw f("BER ints cannot be > 0xffffffff");this._ensure(2+n);this._buf[this._offset++]=t;this._buf[this._offset++]=n;while(n-- >0){this._buf[this._offset++]=(e&4278190080)>>>24;e<<=8}};Writer.prototype.writeNull=function(){this.writeByte(s.Null);this.writeByte(0)};Writer.prototype.writeEnumeration=function(e,t){if(typeof e!=="number")throw new TypeError("argument must be a Number");if(typeof t!=="number")t=s.Enumeration;return this.writeInt(e,t)};Writer.prototype.writeBoolean=function(e,t){if(typeof e!=="boolean")throw new TypeError("argument must be a Boolean");if(typeof t!=="number")t=s.Boolean;this._ensure(3);this._buf[this._offset++]=t;this._buf[this._offset++]=1;this._buf[this._offset++]=e?255:0};Writer.prototype.writeString=function(e,t){if(typeof e!=="string")throw new TypeError("argument must be a string (was: "+typeof e+")");if(typeof t!=="number")t=s.OctetString;var n=i.byteLength(e);this.writeByte(t);this.writeLength(n);if(n){this._ensure(n);this._buf.write(e,this._offset);this._offset+=n}};Writer.prototype.writeBuffer=function(e,t){if(typeof t!=="number")throw new TypeError("tag must be a number");if(!i.isBuffer(e))throw new TypeError("argument must be a buffer");this.writeByte(t);this.writeLength(e.length);this._ensure(e.length);e.copy(this._buf,this._offset,0,e.length);this._offset+=e.length};Writer.prototype.writeStringArray=function(e){if(!e instanceof Array)throw new TypeError("argument must be an Array[String]");var t=this;e.forEach((function(e){t.writeString(e)}))};Writer.prototype.writeOID=function(e,t){if(typeof e!=="string")throw new TypeError("argument must be a string");if(typeof t!=="number")t=s.OID;if(!/^([0-9]+\.){3,}[0-9]+$/.test(e))throw new Error("argument is not a valid OID string");function encodeOctet(e,t){if(t<128){e.push(t)}else if(t<16384){e.push(t>>>7|128);e.push(t&127)}else if(t<2097152){e.push(t>>>14|128);e.push((t>>>7|128)&255);e.push(t&127)}else if(t<268435456){e.push(t>>>21|128);e.push((t>>>14|128)&255);e.push((t>>>7|128)&255);e.push(t&127)}else{e.push((t>>>28|128)&255);e.push((t>>>21|128)&255);e.push((t>>>14|128)&255);e.push((t>>>7|128)&255);e.push(t&127)}}var n=e.split(".");var r=[];r.push(parseInt(n[0],10)*40+parseInt(n[1],10));n.slice(2).forEach((function(e){encodeOctet(r,parseInt(e,10))}));var i=this;this._ensure(2+r.length);this.writeByte(t);this.writeLength(r.length);r.forEach((function(e){i.writeByte(e)}))};Writer.prototype.writeLength=function(e){if(typeof e!=="number")throw new TypeError("argument must be a Number");this._ensure(4);if(e<=127){this._buf[this._offset++]=e}else if(e<=255){this._buf[this._offset++]=129;this._buf[this._offset++]=e}else if(e<=65535){this._buf[this._offset++]=130;this._buf[this._offset++]=e>>8;this._buf[this._offset++]=e}else if(e<=16777215){this._buf[this._offset++]=131;this._buf[this._offset++]=e>>16;this._buf[this._offset++]=e>>8;this._buf[this._offset++]=e}else{throw f("Length too long (> 4 bytes)")}};Writer.prototype.startSequence=function(e){if(typeof e!=="number")e=s.Sequence|s.Constructor;this.writeByte(e);this._seq.push(this._offset);this._ensure(3);this._offset+=3};Writer.prototype.endSequence=function(){var e=this._seq.pop();var t=e+3;var n=this._offset-t;if(n<=127){this._shift(t,n,-2);this._buf[e]=n}else if(n<=255){this._shift(t,n,-1);this._buf[e]=129;this._buf[e+1]=n}else if(n<=65535){this._buf[e]=130;this._buf[e+1]=n>>8;this._buf[e+2]=n}else if(n<=16777215){this._shift(t,n,1);this._buf[e]=131;this._buf[e+1]=n>>16;this._buf[e+2]=n>>8;this._buf[e+3]=n}else{throw f("Sequence too long")}};Writer.prototype._shift=function(e,t,n){r.ok(e!==undefined);r.ok(t!==undefined);r.ok(n);this._buf.copy(this._buf,e+n,e,e+t);this._offset+=n};Writer.prototype._ensure=function(e){r.ok(e);if(this._size-this._offset<e){var t=this._size*this._options.growthFactor;if(t-this._offset<e)t+=e;var n=i.alloc(t);this._buf.copy(n,0,0,this._offset);this._buf=n;this._size=t}};e.exports=Writer},970:(e,t,n)=>{var r=n(194);e.exports={Ber:r,BerReader:r.Reader,BerWriter:r.Writer}},5447:(e,t,n)=>{"use strict";var r=n(8729).lowlevel.crypto_hash;var i=0;var Blowfish=function(){this.S=[new Uint32Array([3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946]),new Uint32Array([1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055]),new Uint32Array([3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504]),new Uint32Array([976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462])];this.P=new Uint32Array([608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731])};function F(e,t,n){return(e[0][t[n+3]]+e[1][t[n+2]]^e[2][t[n+1]])+e[3][t[n]]}Blowfish.prototype.encipher=function(e,t){if(t===undefined){t=new Uint8Array(e.buffer);if(e.byteOffset!==0)t=t.subarray(e.byteOffset)}e[0]^=this.P[0];for(var n=1;n<16;n+=2){e[1]^=F(this.S,t,0)^this.P[n];e[0]^=F(this.S,t,4)^this.P[n+1]}var r=e[0];e[0]=e[1]^this.P[17];e[1]=r};Blowfish.prototype.decipher=function(e){var t=new Uint8Array(e.buffer);if(e.byteOffset!==0)t=t.subarray(e.byteOffset);e[0]^=this.P[17];for(var n=16;n>0;n-=2){e[1]^=F(this.S,t,0)^this.P[n];e[0]^=F(this.S,t,4)^this.P[n-1]}var r=e[0];e[0]=e[1]^this.P[0];e[1]=r};function stream2word(e,t){var n,r=0;for(n=0;n<4;n++,i++){if(i>=t)i=0;r=r<<8|e[i]}return r}Blowfish.prototype.expand0state=function(e,t){var n=new Uint32Array(2),r,s;var o=new Uint8Array(n.buffer);for(r=0,i=0;r<18;r++){this.P[r]^=stream2word(e,t)}i=0;for(r=0;r<18;r+=2){this.encipher(n,o);this.P[r]=n[0];this.P[r+1]=n[1]}for(r=0;r<4;r++){for(s=0;s<256;s+=2){this.encipher(n,o);this.S[r][s]=n[0];this.S[r][s+1]=n[1]}}};Blowfish.prototype.expandstate=function(e,t,n,r){var s=new Uint32Array(2),o,f;for(o=0,i=0;o<18;o++){this.P[o]^=stream2word(n,r)}for(o=0,i=0;o<18;o+=2){s[0]^=stream2word(e,t);s[1]^=stream2word(e,t);this.encipher(s);this.P[o]=s[0];this.P[o+1]=s[1]}for(o=0;o<4;o++){for(f=0;f<256;f+=2){s[0]^=stream2word(e,t);s[1]^=stream2word(e,t);this.encipher(s);this.S[o][f]=s[0];this.S[o][f+1]=s[1]}}i=0};Blowfish.prototype.enc=function(e,t){for(var n=0;n<t;n++){this.encipher(e.subarray(n*2))}};Blowfish.prototype.dec=function(e,t){for(var n=0;n<t;n++){this.decipher(e.subarray(n*2))}};var s=8,o=32;function bcrypt_hash(e,t,n){var r=new Blowfish,i=new Uint32Array(s),o,f=new Uint8Array([79,120,121,99,104,114,111,109,97,116,105,99,66,108,111,119,102,105,115,104,83,119,97,116,68,121,110,97,109,105,116,101]);r.expandstate(t,64,e,64);for(o=0;o<64;o++){r.expand0state(t,64);r.expand0state(e,64)}for(o=0;o<s;o++)i[o]=stream2word(f,f.byteLength);for(o=0;o<64;o++)r.enc(i,i.byteLength/8);for(o=0;o<s;o++){n[4*o+3]=i[o]>>>24;n[4*o+2]=i[o]>>>16;n[4*o+1]=i[o]>>>8;n[4*o+0]=i[o]}}function bcrypt_pbkdf(e,t,n,i,s,f,u){var l=new Uint8Array(64),h=new Uint8Array(64),p=new Uint8Array(o),g=new Uint8Array(o),_=new Uint8Array(i+4),E,y,m,I,b,w,C=f;if(u<1)return-1;if(t===0||i===0||f===0||f>p.byteLength*p.byteLength||i>1<<20)return-1;I=Math.floor((f+p.byteLength-1)/p.byteLength);m=Math.floor((f+I-1)/I);for(E=0;E<i;E++)_[E]=n[E];r(l,e,t);for(w=1;f>0;w++){_[i+0]=w>>>24;_[i+1]=w>>>16;_[i+2]=w>>>8;_[i+3]=w;r(h,_,i+4);bcrypt_hash(l,h,g);for(E=p.byteLength;E--;)p[E]=g[E];for(E=1;E<u;E++){r(h,g,g.byteLength);bcrypt_hash(l,h,g);for(y=0;y<p.byteLength;y++)p[y]^=g[y]}m=Math.min(m,f);for(E=0;E<m;E++){b=E*I+(w-1);if(b>=C)break;s[b]=p[E]}f-=E}return 0}e.exports={BLOCKS:s,HASHSIZE:o,hash:bcrypt_hash,pbkdf:bcrypt_pbkdf}},4137:(e,t,n)=>{"use strict";const r=n(4240);e.exports=r.getCPUInfo},1554:e=>{"use strict";const isStream=e=>e!==null&&typeof e==="object"&&typeof e.pipe==="function";isStream.writable=e=>isStream(e)&&e.writable!==false&&typeof e._write==="function"&&typeof e._writableState==="object";isStream.readable=e=>isStream(e)&&e.readable!==false&&typeof e._read==="function"&&typeof e._readableState==="object";isStream.duplex=e=>isStream.writable(e)&&isStream.readable(e);isStream.transform=e=>isStream.duplex(e)&&typeof e._transform==="function";e.exports=isStream},9126:(e,t,n)=>{"use strict";const r=n(7147);const i=n(1017);const{promisify:s}=n(3837);const o=n(3689);const f=o.satisfies(process.version,">=10.12.0");const checkPath=e=>{if(process.platform==="win32"){const t=/[<>:"|?*]/.test(e.replace(i.parse(e).root,""));if(t){const t=new Error(`Path contains invalid characters: ${e}`);t.code="EINVAL";throw t}}};const processOptions=e=>{const t={mode:511,fs:r};return{...t,...e}};const permissionError=e=>{const t=new Error(`operation not permitted, mkdir '${e}'`);t.code="EPERM";t.errno=-4048;t.path=e;t.syscall="mkdir";return t};const makeDir=async(e,t)=>{checkPath(e);t=processOptions(t);const n=s(t.fs.mkdir);const o=s(t.fs.stat);if(f&&t.fs.mkdir===r.mkdir){const r=i.resolve(e);await n(r,{mode:t.mode,recursive:true});return r}const make=async e=>{try{await n(e,t.mode);return e}catch(t){if(t.code==="EPERM"){throw t}if(t.code==="ENOENT"){if(i.dirname(e)===e){throw permissionError(e)}if(t.message.includes("null bytes")){throw t}await make(i.dirname(e));return make(e)}try{const t=await o(e);if(!t.isDirectory()){throw new Error("The path is not a directory")}}catch(e){throw t}return e}};return make(i.resolve(e))};e.exports=makeDir;e.exports.sync=(e,t)=>{checkPath(e);t=processOptions(t);if(f&&t.fs.mkdirSync===r.mkdirSync){const n=i.resolve(e);r.mkdirSync(n,{mode:t.mode,recursive:true});return n}const make=e=>{try{t.fs.mkdirSync(e,t.mode)}catch(n){if(n.code==="EPERM"){throw n}if(n.code==="ENOENT"){if(i.dirname(e)===e){throw permissionError(e)}if(n.message.includes("null bytes")){throw n}make(i.dirname(e));return make(e)}try{if(!t.fs.statSync(e).isDirectory()){throw new Error("The path is not a directory")}}catch(e){throw n}}return e};return make(i.resolve(e))}},3689:(e,t)=>{t=e.exports=SemVer;var n;if(typeof process==="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)){n=function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER");console.log.apply(console,e)}}else{n=function(){}}t.SEMVER_SPEC_VERSION="2.0.0";var r=256;var i=Number.MAX_SAFE_INTEGER||9007199254740991;var s=16;var o=t.re=[];var f=t.src=[];var u=t.tokens={};var l=0;function tok(e){u[e]=l++}tok("NUMERICIDENTIFIER");f[u.NUMERICIDENTIFIER]="0|[1-9]\\d*";tok("NUMERICIDENTIFIERLOOSE");f[u.NUMERICIDENTIFIERLOOSE]="[0-9]+";tok("NONNUMERICIDENTIFIER");f[u.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";tok("MAINVERSION");f[u.MAINVERSION]="("+f[u.NUMERICIDENTIFIER]+")\\."+"("+f[u.NUMERICIDENTIFIER]+")\\."+"("+f[u.NUMERICIDENTIFIER]+")";tok("MAINVERSIONLOOSE");f[u.MAINVERSIONLOOSE]="("+f[u.NUMERICIDENTIFIERLOOSE]+")\\."+"("+f[u.NUMERICIDENTIFIERLOOSE]+")\\."+"("+f[u.NUMERICIDENTIFIERLOOSE]+")";tok("PRERELEASEIDENTIFIER");f[u.PRERELEASEIDENTIFIER]="(?:"+f[u.NUMERICIDENTIFIER]+"|"+f[u.NONNUMERICIDENTIFIER]+")";tok("PRERELEASEIDENTIFIERLOOSE");f[u.PRERELEASEIDENTIFIERLOOSE]="(?:"+f[u.NUMERICIDENTIFIERLOOSE]+"|"+f[u.NONNUMERICIDENTIFIER]+")";tok("PRERELEASE");f[u.PRERELEASE]="(?:-("+f[u.PRERELEASEIDENTIFIER]+"(?:\\."+f[u.PRERELEASEIDENTIFIER]+")*))";tok("PRERELEASELOOSE");f[u.PRERELEASELOOSE]="(?:-?("+f[u.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+f[u.PRERELEASEIDENTIFIERLOOSE]+")*))";tok("BUILDIDENTIFIER");f[u.BUILDIDENTIFIER]="[0-9A-Za-z-]+";tok("BUILD");f[u.BUILD]="(?:\\+("+f[u.BUILDIDENTIFIER]+"(?:\\."+f[u.BUILDIDENTIFIER]+")*))";tok("FULL");tok("FULLPLAIN");f[u.FULLPLAIN]="v?"+f[u.MAINVERSION]+f[u.PRERELEASE]+"?"+f[u.BUILD]+"?";f[u.FULL]="^"+f[u.FULLPLAIN]+"$";tok("LOOSEPLAIN");f[u.LOOSEPLAIN]="[v=\\s]*"+f[u.MAINVERSIONLOOSE]+f[u.PRERELEASELOOSE]+"?"+f[u.BUILD]+"?";tok("LOOSE");f[u.LOOSE]="^"+f[u.LOOSEPLAIN]+"$";tok("GTLT");f[u.GTLT]="((?:<|>)?=?)";tok("XRANGEIDENTIFIERLOOSE");f[u.XRANGEIDENTIFIERLOOSE]=f[u.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*";tok("XRANGEIDENTIFIER");f[u.XRANGEIDENTIFIER]=f[u.NUMERICIDENTIFIER]+"|x|X|\\*";tok("XRANGEPLAIN");f[u.XRANGEPLAIN]="[v=\\s]*("+f[u.XRANGEIDENTIFIER]+")"+"(?:\\.("+f[u.XRANGEIDENTIFIER]+")"+"(?:\\.("+f[u.XRANGEIDENTIFIER]+")"+"(?:"+f[u.PRERELEASE]+")?"+f[u.BUILD]+"?"+")?)?";tok("XRANGEPLAINLOOSE");f[u.XRANGEPLAINLOOSE]="[v=\\s]*("+f[u.XRANGEIDENTIFIERLOOSE]+")"+"(?:\\.("+f[u.XRANGEIDENTIFIERLOOSE]+")"+"(?:\\.("+f[u.XRANGEIDENTIFIERLOOSE]+")"+"(?:"+f[u.PRERELEASELOOSE]+")?"+f[u.BUILD]+"?"+")?)?";tok("XRANGE");f[u.XRANGE]="^"+f[u.GTLT]+"\\s*"+f[u.XRANGEPLAIN]+"$";tok("XRANGELOOSE");f[u.XRANGELOOSE]="^"+f[u.GTLT]+"\\s*"+f[u.XRANGEPLAINLOOSE]+"$";tok("COERCE");f[u.COERCE]="(^|[^\\d])"+"(\\d{1,"+s+"})"+"(?:\\.(\\d{1,"+s+"}))?"+"(?:\\.(\\d{1,"+s+"}))?"+"(?:$|[^\\d])";tok("COERCERTL");o[u.COERCERTL]=new RegExp(f[u.COERCE],"g");tok("LONETILDE");f[u.LONETILDE]="(?:~>?)";tok("TILDETRIM");f[u.TILDETRIM]="(\\s*)"+f[u.LONETILDE]+"\\s+";o[u.TILDETRIM]=new RegExp(f[u.TILDETRIM],"g");var h="$1~";tok("TILDE");f[u.TILDE]="^"+f[u.LONETILDE]+f[u.XRANGEPLAIN]+"$";tok("TILDELOOSE");f[u.TILDELOOSE]="^"+f[u.LONETILDE]+f[u.XRANGEPLAINLOOSE]+"$";tok("LONECARET");f[u.LONECARET]="(?:\\^)";tok("CARETTRIM");f[u.CARETTRIM]="(\\s*)"+f[u.LONECARET]+"\\s+";o[u.CARETTRIM]=new RegExp(f[u.CARETTRIM],"g");var p="$1^";tok("CARET");f[u.CARET]="^"+f[u.LONECARET]+f[u.XRANGEPLAIN]+"$";tok("CARETLOOSE");f[u.CARETLOOSE]="^"+f[u.LONECARET]+f[u.XRANGEPLAINLOOSE]+"$";tok("COMPARATORLOOSE");f[u.COMPARATORLOOSE]="^"+f[u.GTLT]+"\\s*("+f[u.LOOSEPLAIN]+")$|^$";tok("COMPARATOR");f[u.COMPARATOR]="^"+f[u.GTLT]+"\\s*("+f[u.FULLPLAIN]+")$|^$";tok("COMPARATORTRIM");f[u.COMPARATORTRIM]="(\\s*)"+f[u.GTLT]+"\\s*("+f[u.LOOSEPLAIN]+"|"+f[u.XRANGEPLAIN]+")";o[u.COMPARATORTRIM]=new RegExp(f[u.COMPARATORTRIM],"g");var g="$1$2$3";tok("HYPHENRANGE");f[u.HYPHENRANGE]="^\\s*("+f[u.XRANGEPLAIN]+")"+"\\s+-\\s+"+"("+f[u.XRANGEPLAIN]+")"+"\\s*$";tok("HYPHENRANGELOOSE");f[u.HYPHENRANGELOOSE]="^\\s*("+f[u.XRANGEPLAINLOOSE]+")"+"\\s+-\\s+"+"("+f[u.XRANGEPLAINLOOSE]+")"+"\\s*$";tok("STAR");f[u.STAR]="(<|>)?=?\\s*\\*";for(var _=0;_<l;_++){n(_,f[_]);if(!o[_]){o[_]=new RegExp(f[_])}}t.parse=parse;function parse(e,t){if(!t||typeof t!=="object"){t={loose:!!t,includePrerelease:false}}if(e instanceof SemVer){return e}if(typeof e!=="string"){return null}if(e.length>r){return null}var n=t.loose?o[u.LOOSE]:o[u.FULL];if(!n.test(e)){return null}try{return new SemVer(e,t)}catch(e){return null}}t.valid=valid;function valid(e,t){var n=parse(e,t);return n?n.version:null}t.clean=clean;function clean(e,t){var n=parse(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}t.SemVer=SemVer;function SemVer(e,t){if(!t||typeof t!=="object"){t={loose:!!t,includePrerelease:false}}if(e instanceof SemVer){if(e.loose===t.loose){return e}else{e=e.version}}else if(typeof e!=="string"){throw new TypeError("Invalid Version: "+e)}if(e.length>r){throw new TypeError("version is longer than "+r+" characters")}if(!(this instanceof SemVer)){return new SemVer(e,t)}n("SemVer",e,t);this.options=t;this.loose=!!t.loose;var s=e.trim().match(t.loose?o[u.LOOSE]:o[u.FULL]);if(!s){throw new TypeError("Invalid Version: "+e)}this.raw=e;this.major=+s[1];this.minor=+s[2];this.patch=+s[3];if(this.major>i||this.major<0){throw new TypeError("Invalid major version")}if(this.minor>i||this.minor<0){throw new TypeError("Invalid minor version")}if(this.patch>i||this.patch<0){throw new TypeError("Invalid patch version")}if(!s[4]){this.prerelease=[]}else{this.prerelease=s[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<i){return t}}return e}))}this.build=s[5]?s[5].split("."):[];this.format()}SemVer.prototype.format=function(){this.version=this.major+"."+this.minor+"."+this.patch;if(this.prerelease.length){this.version+="-"+this.prerelease.join(".")}return this.version};SemVer.prototype.toString=function(){return this.version};SemVer.prototype.compare=function(e){n("SemVer.compare",this.version,this.options,e);if(!(e instanceof SemVer)){e=new SemVer(e,this.options)}return this.compareMain(e)||this.comparePre(e)};SemVer.prototype.compareMain=function(e){if(!(e instanceof SemVer)){e=new SemVer(e,this.options)}return compareIdentifiers(this.major,e.major)||compareIdentifiers(this.minor,e.minor)||compareIdentifiers(this.patch,e.patch)};SemVer.prototype.comparePre=function(e){if(!(e instanceof SemVer)){e=new SemVer(e,this.options)}if(this.prerelease.length&&!e.prerelease.length){return-1}else if(!this.prerelease.length&&e.prerelease.length){return 1}else if(!this.prerelease.length&&!e.prerelease.length){return 0}var t=0;do{var r=this.prerelease[t];var i=e.prerelease[t];n("prerelease compare",t,r,i);if(r===undefined&&i===undefined){return 0}else if(i===undefined){return 1}else if(r===undefined){return-1}else if(r===i){continue}else{return compareIdentifiers(r,i)}}while(++t)};SemVer.prototype.compareBuild=function(e){if(!(e instanceof SemVer)){e=new SemVer(e,this.options)}var t=0;do{var r=this.build[t];var i=e.build[t];n("prerelease compare",t,r,i);if(r===undefined&&i===undefined){return 0}else if(i===undefined){return 1}else if(r===undefined){return-1}else if(r===i){continue}else{return compareIdentifiers(r,i)}}while(++t)};SemVer.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0;this.patch=0;this.minor=0;this.major++;this.inc("pre",t);break;case"preminor":this.prerelease.length=0;this.patch=0;this.minor++;this.inc("pre",t);break;case"prepatch":this.prerelease.length=0;this.inc("patch",t);this.inc("pre",t);break;case"prerelease":if(this.prerelease.length===0){this.inc("patch",t)}this.inc("pre",t);break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0){this.major++}this.minor=0;this.patch=0;this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0){this.minor++}this.patch=0;this.prerelease=[];break;case"patch":if(this.prerelease.length===0){this.patch++}this.prerelease=[];break;case"pre":if(this.prerelease.length===0){this.prerelease=[0]}else{var n=this.prerelease.length;while(--n>=0){if(typeof this.prerelease[n]==="number"){this.prerelease[n]++;n=-2}}if(n===-1){this.prerelease.push(0)}}if(t){if(this.prerelease[0]===t){if(isNaN(this.prerelease[1])){this.prerelease=[t,0]}}else{this.prerelease=[t,0]}}break;default:throw new Error("invalid increment argument: "+e)}this.format();this.raw=this.version;return this};t.inc=inc;function inc(e,t,n,r){if(typeof n==="string"){r=n;n=undefined}try{return new SemVer(e,n).inc(t,r).version}catch(e){return null}}t.diff=diff;function diff(e,t){if(eq(e,t)){return null}else{var n=parse(e);var r=parse(t);var i="";if(n.prerelease.length||r.prerelease.length){i="pre";var s="prerelease"}for(var o in n){if(o==="major"||o==="minor"||o==="patch"){if(n[o]!==r[o]){return i+o}}}return s}}t.compareIdentifiers=compareIdentifiers;var E=/^[0-9]+$/;function compareIdentifiers(e,t){var n=E.test(e);var r=E.test(t);if(n&&r){e=+e;t=+t}return e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1}t.rcompareIdentifiers=rcompareIdentifiers;function rcompareIdentifiers(e,t){return compareIdentifiers(t,e)}t.major=major;function major(e,t){return new SemVer(e,t).major}t.minor=minor;function minor(e,t){return new SemVer(e,t).minor}t.patch=patch;function patch(e,t){return new SemVer(e,t).patch}t.compare=compare;function compare(e,t,n){return new SemVer(e,n).compare(new SemVer(t,n))}t.compareLoose=compareLoose;function compareLoose(e,t){return compare(e,t,true)}t.compareBuild=compareBuild;function compareBuild(e,t,n){var r=new SemVer(e,n);var i=new SemVer(t,n);return r.compare(i)||r.compareBuild(i)}t.rcompare=rcompare;function rcompare(e,t,n){return compare(t,e,n)}t.sort=sort;function sort(e,n){return e.sort((function(e,r){return t.compareBuild(e,r,n)}))}t.rsort=rsort;function rsort(e,n){return e.sort((function(e,r){return t.compareBuild(r,e,n)}))}t.gt=gt;function gt(e,t,n){return compare(e,t,n)>0}t.lt=lt;function lt(e,t,n){return compare(e,t,n)<0}t.eq=eq;function eq(e,t,n){return compare(e,t,n)===0}t.neq=neq;function neq(e,t,n){return compare(e,t,n)!==0}t.gte=gte;function gte(e,t,n){return compare(e,t,n)>=0}t.lte=lte;function lte(e,t,n){return compare(e,t,n)<=0}t.cmp=cmp;function cmp(e,t,n,r){switch(t){case"===":if(typeof e==="object")e=e.version;if(typeof n==="object")n=n.version;return e===n;case"!==":if(typeof e==="object")e=e.version;if(typeof n==="object")n=n.version;return e!==n;case"":case"=":case"==":return eq(e,n,r);case"!=":return neq(e,n,r);case">":return gt(e,n,r);case">=":return gte(e,n,r);case"<":return lt(e,n,r);case"<=":return lte(e,n,r);default:throw new TypeError("Invalid operator: "+t)}}t.Comparator=Comparator;function Comparator(e,t){if(!t||typeof t!=="object"){t={loose:!!t,includePrerelease:false}}if(e instanceof Comparator){if(e.loose===!!t.loose){return e}else{e=e.value}}if(!(this instanceof Comparator)){return new Comparator(e,t)}n("comparator",e,t);this.options=t;this.loose=!!t.loose;this.parse(e);if(this.semver===y){this.value=""}else{this.value=this.operator+this.semver.version}n("comp",this)}var y={};Comparator.prototype.parse=function(e){var t=this.options.loose?o[u.COMPARATORLOOSE]:o[u.COMPARATOR];var n=e.match(t);if(!n){throw new TypeError("Invalid comparator: "+e)}this.operator=n[1]!==undefined?n[1]:"";if(this.operator==="="){this.operator=""}if(!n[2]){this.semver=y}else{this.semver=new SemVer(n[2],this.options.loose)}};Comparator.prototype.toString=function(){return this.value};Comparator.prototype.test=function(e){n("Comparator.test",e,this.options.loose);if(this.semver===y||e===y){return true}if(typeof e==="string"){try{e=new SemVer(e,this.options)}catch(e){return false}}return cmp(e,this.operator,this.semver,this.options)};Comparator.prototype.intersects=function(e,t){if(!(e instanceof Comparator)){throw new TypeError("a Comparator is required")}if(!t||typeof t!=="object"){t={loose:!!t,includePrerelease:false}}var n;if(this.operator===""){if(this.value===""){return true}n=new Range(e.value,t);return satisfies(this.value,n,t)}else if(e.operator===""){if(e.value===""){return true}n=new Range(this.value,t);return satisfies(e.semver,n,t)}var r=(this.operator===">="||this.operator===">")&&(e.operator===">="||e.operator===">");var i=(this.operator==="<="||this.operator==="<")&&(e.operator==="<="||e.operator==="<");var s=this.semver.version===e.semver.version;var o=(this.operator===">="||this.operator==="<=")&&(e.operator===">="||e.operator==="<=");var f=cmp(this.semver,"<",e.semver,t)&&((this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"));var u=cmp(this.semver,">",e.semver,t)&&((this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">"));return r||i||s&&o||f||u};t.Range=Range;function Range(e,t){if(!t||typeof t!=="object"){t={loose:!!t,includePrerelease:false}}if(e instanceof Range){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease){return e}else{return new Range(e.raw,t)}}if(e instanceof Comparator){return new Range(e.value,t)}if(!(this instanceof Range)){return new Range(e,t)}this.options=t;this.loose=!!t.loose;this.includePrerelease=!!t.includePrerelease;this.raw=e;this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length}));if(!this.set.length){throw new TypeError("Invalid SemVer Range: "+e)}this.format()}Range.prototype.format=function(){this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim();return this.range};Range.prototype.toString=function(){return this.range};Range.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var r=t?o[u.HYPHENRANGELOOSE]:o[u.HYPHENRANGE];e=e.replace(r,hyphenReplace);n("hyphen replace",e);e=e.replace(o[u.COMPARATORTRIM],g);n("comparator trim",e,o[u.COMPARATORTRIM]);e=e.replace(o[u.TILDETRIM],h);e=e.replace(o[u.CARETTRIM],p);e=e.split(/\s+/).join(" ");var i=t?o[u.COMPARATORLOOSE]:o[u.COMPARATOR];var s=e.split(" ").map((function(e){return parseComparator(e,this.options)}),this).join(" ").split(/\s+/);if(this.options.loose){s=s.filter((function(e){return!!e.match(i)}))}s=s.map((function(e){return new Comparator(e,this.options)}),this);return s};Range.prototype.intersects=function(e,t){if(!(e instanceof Range)){throw new TypeError("a Range is required")}return this.set.some((function(n){return isSatisfiable(n,t)&&e.set.some((function(e){return isSatisfiable(e,t)&&n.every((function(n){return e.every((function(e){return n.intersects(e,t)}))}))}))}))};function isSatisfiable(e,t){var n=true;var r=e.slice();var i=r.pop();while(n&&r.length){n=r.every((function(e){return i.intersects(e,t)}));i=r.pop()}return n}t.toComparators=toComparators;function toComparators(e,t){return new Range(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))}function parseComparator(e,t){n("comp",e,t);e=replaceCarets(e,t);n("caret",e);e=replaceTildes(e,t);n("tildes",e);e=replaceXRanges(e,t);n("xrange",e);e=replaceStars(e,t);n("stars",e);return e}function isX(e){return!e||e.toLowerCase()==="x"||e==="*"}function replaceTildes(e,t){return e.trim().split(/\s+/).map((function(e){return replaceTilde(e,t)})).join(" ")}function replaceTilde(e,t){var r=t.loose?o[u.TILDELOOSE]:o[u.TILDE];return e.replace(r,(function(t,r,i,s,o){n("tilde",e,t,r,i,s,o);var f;if(isX(r)){f=""}else if(isX(i)){f=">="+r+".0.0 <"+(+r+1)+".0.0"}else if(isX(s)){f=">="+r+"."+i+".0 <"+r+"."+(+i+1)+".0"}else if(o){n("replaceTilde pr",o);f=">="+r+"."+i+"."+s+"-"+o+" <"+r+"."+(+i+1)+".0"}else{f=">="+r+"."+i+"."+s+" <"+r+"."+(+i+1)+".0"}n("tilde return",f);return f}))}function replaceCarets(e,t){return e.trim().split(/\s+/).map((function(e){return replaceCaret(e,t)})).join(" ")}function replaceCaret(e,t){n("caret",e,t);var r=t.loose?o[u.CARETLOOSE]:o[u.CARET];return e.replace(r,(function(t,r,i,s,o){n("caret",e,t,r,i,s,o);var f;if(isX(r)){f=""}else if(isX(i)){f=">="+r+".0.0 <"+(+r+1)+".0.0"}else if(isX(s)){if(r==="0"){f=">="+r+"."+i+".0 <"+r+"."+(+i+1)+".0"}else{f=">="+r+"."+i+".0 <"+(+r+1)+".0.0"}}else if(o){n("replaceCaret pr",o);if(r==="0"){if(i==="0"){f=">="+r+"."+i+"."+s+"-"+o+" <"+r+"."+i+"."+(+s+1)}else{f=">="+r+"."+i+"."+s+"-"+o+" <"+r+"."+(+i+1)+".0"}}else{f=">="+r+"."+i+"."+s+"-"+o+" <"+(+r+1)+".0.0"}}else{n("no pr");if(r==="0"){if(i==="0"){f=">="+r+"."+i+"."+s+" <"+r+"."+i+"."+(+s+1)}else{f=">="+r+"."+i+"."+s+" <"+r+"."+(+i+1)+".0"}}else{f=">="+r+"."+i+"."+s+" <"+(+r+1)+".0.0"}}n("caret return",f);return f}))}function replaceXRanges(e,t){n("replaceXRanges",e,t);return e.split(/\s+/).map((function(e){return replaceXRange(e,t)})).join(" ")}function replaceXRange(e,t){e=e.trim();var r=t.loose?o[u.XRANGELOOSE]:o[u.XRANGE];return e.replace(r,(function(r,i,s,o,f,u){n("xRange",e,r,i,s,o,f,u);var l=isX(s);var h=l||isX(o);var p=h||isX(f);var g=p;if(i==="="&&g){i=""}u=t.includePrerelease?"-0":"";if(l){if(i===">"||i==="<"){r="<0.0.0-0"}else{r="*"}}else if(i&&g){if(h){o=0}f=0;if(i===">"){i=">=";if(h){s=+s+1;o=0;f=0}else{o=+o+1;f=0}}else if(i==="<="){i="<";if(h){s=+s+1}else{o=+o+1}}r=i+s+"."+o+"."+f+u}else if(h){r=">="+s+".0.0"+u+" <"+(+s+1)+".0.0"+u}else if(p){r=">="+s+"."+o+".0"+u+" <"+s+"."+(+o+1)+".0"+u}n("xRange return",r);return r}))}function replaceStars(e,t){n("replaceStars",e,t);return e.trim().replace(o[u.STAR],"")}function hyphenReplace(e,t,n,r,i,s,o,f,u,l,h,p,g){if(isX(n)){t=""}else if(isX(r)){t=">="+n+".0.0"}else if(isX(i)){t=">="+n+"."+r+".0"}else{t=">="+t}if(isX(u)){f=""}else if(isX(l)){f="<"+(+u+1)+".0.0"}else if(isX(h)){f="<"+u+"."+(+l+1)+".0"}else if(p){f="<="+u+"."+l+"."+h+"-"+p}else{f="<="+f}return(t+" "+f).trim()}Range.prototype.test=function(e){if(!e){return false}if(typeof e==="string"){try{e=new SemVer(e,this.options)}catch(e){return false}}for(var t=0;t<this.set.length;t++){if(testSet(this.set[t],e,this.options)){return true}}return false};function testSet(e,t,r){for(var i=0;i<e.length;i++){if(!e[i].test(t)){return false}}if(t.prerelease.length&&!r.includePrerelease){for(i=0;i<e.length;i++){n(e[i].semver);if(e[i].semver===y){continue}if(e[i].semver.prerelease.length>0){var s=e[i].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch){return true}}}return false}return true}t.satisfies=satisfies;function satisfies(e,t,n){try{t=new Range(t,n)}catch(e){return false}return t.test(e)}t.maxSatisfying=maxSatisfying;function maxSatisfying(e,t,n){var r=null;var i=null;try{var s=new Range(t,n)}catch(e){return null}e.forEach((function(e){if(s.test(e)){if(!r||i.compare(e)===-1){r=e;i=new SemVer(r,n)}}}));return r}t.minSatisfying=minSatisfying;function minSatisfying(e,t,n){var r=null;var i=null;try{var s=new Range(t,n)}catch(e){return null}e.forEach((function(e){if(s.test(e)){if(!r||i.compare(e)===1){r=e;i=new SemVer(r,n)}}}));return r}t.minVersion=minVersion;function minVersion(e,t){e=new Range(e,t);var n=new SemVer("0.0.0");if(e.test(n)){return n}n=new SemVer("0.0.0-0");if(e.test(n)){return n}n=null;for(var r=0;r<e.set.length;++r){var i=e.set[r];i.forEach((function(e){var t=new SemVer(e.semver.version);switch(e.operator){case">":if(t.prerelease.length===0){t.patch++}else{t.prerelease.push(0)}t.raw=t.format();case"":case">=":if(!n||gt(n,t)){n=t}break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}))}if(n&&e.test(n)){return n}return null}t.validRange=validRange;function validRange(e,t){try{return new Range(e,t).range||"*"}catch(e){return null}}t.ltr=ltr;function ltr(e,t,n){return outside(e,t,"<",n)}t.gtr=gtr;function gtr(e,t,n){return outside(e,t,">",n)}t.outside=outside;function outside(e,t,n,r){e=new SemVer(e,r);t=new Range(t,r);var i,s,o,f,u;switch(n){case">":i=gt;s=lte;o=lt;f=">";u=">=";break;case"<":i=lt;s=gte;o=gt;f="<";u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(satisfies(e,t,r)){return false}for(var l=0;l<t.set.length;++l){var h=t.set[l];var p=null;var g=null;h.forEach((function(e){if(e.semver===y){e=new Comparator(">=0.0.0")}p=p||e;g=g||e;if(i(e.semver,p.semver,r)){p=e}else if(o(e.semver,g.semver,r)){g=e}}));if(p.operator===f||p.operator===u){return false}if((!g.operator||g.operator===f)&&s(e,g.semver)){return false}else if(g.operator===u&&o(e,g.semver)){return false}}return true}t.prerelease=prerelease;function prerelease(e,t){var n=parse(e,t);return n&&n.prerelease.length?n.prerelease:null}t.intersects=intersects;function intersects(e,t,n){e=new Range(e,n);t=new Range(t,n);return e.intersects(t)}t.coerce=coerce;function coerce(e,t){if(e instanceof SemVer){return e}if(typeof e==="number"){e=String(e)}if(typeof e!=="string"){return null}t=t||{};var n=null;if(!t.rtl){n=e.match(o[u.COERCE])}else{var r;while((r=o[u.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length)){if(!n||r.index+r[0].length!==n.index+n[0].length){n=r}o[u.COERCERTL].lastIndex=r.index+r[1].length+r[2].length}o[u.COERCERTL].lastIndex=-1}if(n===null){return null}return parse(n[2]+"."+(n[3]||"0")+"."+(n[4]||"0"),t)}},5118:(e,t,n)=>{"use strict";var r=n(4300);var i=r.Buffer;var s={};var o;for(o in r){if(!r.hasOwnProperty(o))continue;if(o==="SlowBuffer"||o==="Buffer")continue;s[o]=r[o]}var f=s.Buffer={};for(o in i){if(!i.hasOwnProperty(o))continue;if(o==="allocUnsafe"||o==="allocUnsafeSlow")continue;f[o]=i[o]}s.Buffer.prototype=i.prototype;if(!f.from||f.from===Uint8Array.from){f.from=function(e,t,n){if(typeof e==="number"){throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e)}if(e&&typeof e.length==="undefined"){throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}return i(e,t,n)}}if(!f.alloc){f.alloc=function(e,t,n){if(typeof e!=="number"){throw new TypeError('The "size" argument must be of type number. Received type '+typeof e)}if(e<0||e>=2*(1<<30)){throw new RangeError('The value "'+e+'" is invalid for option "size"')}var r=i(e);if(!t||t.length===0){r.fill(0)}else if(typeof n==="string"){r.fill(t,n)}else{r.fill(t)}return r}}if(!s.kStringMaxLength){try{s.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch(e){}}if(!s.constants){s.constants={MAX_LENGTH:s.kMaxLength};if(s.kStringMaxLength){s.constants.MAX_STRING_LENGTH=s.kStringMaxLength}}e.exports=s},8741:e=>{e.exports=shellescape;function shellescape(e){var t=[];e.forEach((function(e){if(!/^[A-Za-z0-9_\/-]+$/.test(e)){e="'"+e.replace(/'/g,"'\\''")+"'";e=e.replace(/^(?:'')+/g,"").replace(/\\'''/g,"\\'")}t.push(e)}));return t.join(" ")}},3204:(e,t,n)=>{"use strict";const{Duplex:r,Readable:i,Writable:s}=n(2781);const{CHANNEL_EXTENDED_DATATYPE:{STDERR:o}}=n(6832);const{bufferSlice:f}=n(9475);const u=32*1024;const l=2*1024*1024;const h=l/2;class ClientStderr extends i{constructor(e,t){super(t);this._channel=e}_read(e){if(this._channel._waitChanDrain){this._channel._waitChanDrain=false;if(this._channel.incoming.window<=h)windowAdjust(this._channel)}}}class ServerStderr extends s{constructor(e){super({highWaterMark:l});this._channel=e}_write(e,t,n){const r=this._channel;const i=r._client._protocol;const s=r.outgoing;const u=s.packetSize;const l=s.id;let h=s.window;const p=e.length;let g=0;if(s.state!=="open")return;while(p-g>0&&h>0){let t=p-g;if(t>h)t=h;if(t>u)t=u;if(g===0&&t===p)i.channelExtData(l,e,o);else i.channelExtData(l,f(e,g,g+t),o);g+=t;h-=t}s.window=h;if(p-g>0){if(h===0)r._waitWindow=true;if(g>0)r._chunkErr=f(e,g,p);else r._chunkErr=e;r._chunkcbErr=n;return}n()}}class Channel extends r{constructor(e,t,n){const r={highWaterMark:l,allowHalfOpen:!n||n&&n.allowHalfOpen!==false,emitClose:false};super(r);this.allowHalfOpen=r.allowHalfOpen;const i=!!(n&&n.server);this.server=i;this.type=t.type;this.subtype=undefined;this.incoming=t.incoming;this.outgoing=t.outgoing;this._callbacks=[];this._client=e;this._hasX11=false;this._exit={code:undefined,signal:undefined,dump:undefined,desc:undefined};this.stdin=this.stdout=this;if(i)this.stderr=new ServerStderr(this);else this.stderr=new ClientStderr(this,r);this._waitWindow=false;this._waitChanDrain=false;this._chunk=undefined;this._chunkcb=undefined;this._chunkErr=undefined;this._chunkcbErr=undefined;this.on("finish",onFinish).on("prefinish",onFinish);this.on("end",onEnd).on("close",onEnd)}_read(e){if(this._waitChanDrain){this._waitChanDrain=false;if(this.incoming.window<=h)windowAdjust(this)}}_write(e,t,n){const r=this._client._protocol;const i=this.outgoing;const s=i.packetSize;const o=i.id;let u=i.window;const l=e.length;let h=0;if(i.state!=="open")return;while(l-h>0&&u>0){let t=l-h;if(t>u)t=u;if(t>s)t=s;if(h===0&&t===l)r.channelData(o,e);else r.channelData(o,f(e,h,h+t));h+=t;u-=t}i.window=u;if(l-h>0){if(u===0)this._waitWindow=true;if(h>0)this._chunk=f(e,h,l);else this._chunk=e;this._chunkcb=n;return}n()}eof(){if(this.outgoing.state==="open"){this.outgoing.state="eof";this._client._protocol.channelEOF(this.outgoing.id)}}close(){if(this.outgoing.state==="open"||this.outgoing.state==="eof"){this.outgoing.state="closing";this._client._protocol.channelClose(this.outgoing.id)}}destroy(){this.end();this.close();return this}setWindow(e,t,n,r){if(this.server)throw new Error("Client-only method called in server mode");if(this.type==="session"&&(this.subtype==="shell"||this.subtype==="exec")&&this.writable&&this.outgoing.state==="open"){this._client._protocol.windowChange(this.outgoing.id,e,t,n,r)}}signal(e){if(this.server)throw new Error("Client-only method called in server mode");if(this.type==="session"&&this.writable&&this.outgoing.state==="open"){this._client._protocol.signal(this.outgoing.id,e)}}exit(e,t,n){if(!this.server)throw new Error("Server-only method called in client mode");if(this.type==="session"&&this.writable&&this.outgoing.state==="open"){if(typeof e==="number"){this._client._protocol.exitStatus(this.outgoing.id,e)}else{this._client._protocol.exitSignal(this.outgoing.id,e,t,n)}}}}function onFinish(){this.eof();if(this.server||!this.allowHalfOpen)this.close();this.writable=false}function onEnd(){this.readable=false}function windowAdjust(e){if(e.outgoing.state==="closed")return;const t=l-e.incoming.window;if(t<=0)return;e.incoming.window+=t;e._client._protocol.channelWindowAdjust(e.outgoing.id,t)}e.exports={Channel:Channel,MAX_WINDOW:l,PACKET_SIZE:u,windowAdjust:windowAdjust,WINDOW_THRESHOLD:h}},9054:(e,t,n)=>{"use strict";const{Socket:r}=n(1808);const{Duplex:i}=n(2781);const{resolve:s}=n(1017);const{readFile:o}=n(7147);const{execFile:f,spawn:u}=n(2081);const{isParsedKey:l,parseKey:h}=n(2218);const{makeBufferParser:p,readUInt32BE:g,writeUInt32BE:_,writeUInt32LE:E}=n(9475);function once(e){let t=false;return(...n)=>{if(t)return;t=true;e(...n)}}function concat(e,t){const n=Buffer.allocUnsafe(e.length+t.length);e.copy(n,0);t.copy(n,e.length);return n}function noop(){}const y=Buffer.alloc(0);const m=p();class BaseAgent{getIdentities(e){e(new Error("Missing getIdentities() implementation"))}sign(e,t,n,r){if(typeof n==="function")r=n;r(new Error("Missing sign() implementation"))}}class OpenSSHAgent extends BaseAgent{constructor(e){super();this.socketPath=e}getStream(e){e=once(e);const t=new r;t.on("connect",(()=>{e(null,t)}));t.on("close",onFail).on("end",onFail).on("error",onFail);t.connect(this.socketPath);function onFail(){try{t.destroy()}catch{}e(new Error("Failed to connect to agent"))}}getIdentities(e){e=once(e);this.getStream(((t,n)=>{function onFail(t){if(n){try{n.destroy()}catch{}}if(!t)t=new Error("Failed to retrieve identities from agent");e(t)}if(t)return onFail(t);const r=new C(true);r.on("error",onFail);r.pipe(n).pipe(r);n.on("close",onFail).on("end",onFail).on("error",onFail);r.getIdentities(((t,r)=>{if(t)return onFail(t);try{n.destroy()}catch{}e(null,r)}))}))}sign(e,t,n,r){if(typeof n==="function"){r=n;n=undefined}else if(typeof n!=="object"||n===null){n=undefined}r=once(r);this.getStream(((i,s)=>{function onFail(e){if(s){try{s.destroy()}catch{}}if(!e)e=new Error("Failed to sign data with agent");r(e)}if(i)return onFail(i);const o=new C(true);o.on("error",onFail);o.pipe(s).pipe(o);s.on("close",onFail).on("end",onFail).on("error",onFail);o.sign(e,t,n,((e,t)=>{if(e)return onFail(e);try{s.destroy()}catch{}r(null,t)}))}))}}const I=(()=>{const e=10;const t=11;const r=12;const s=13;const o=14;const f=15;const l=n.ab+"pagent.exe";const h={[e]:new Error("Invalid pagent.exe arguments"),[t]:new Error("Pageant is not running"),[r]:new Error("pagent.exe could not create an mmap"),[s]:new Error("pagent.exe could not set mode for stdin"),[o]:new Error("pagent.exe could not set mode for stdout"),[f]:new Error("pagent.exe did not get expected input payload")};function destroy(e){e.buffer=null;if(e.proc){e.proc.kill();e.proc=undefined}}class PageantSocket extends i{constructor(){super();this.proc=undefined;this.buffer=null}_read(e){}_write(e,t,r){if(this.buffer===null){this.buffer=e}else{const t=Buffer.allocUnsafe(this.buffer.length+e.length);this.buffer.copy(t,0);e.copy(t,this.buffer.length);this.buffer=t}if(this.buffer.length<4)return r();const i=g(this.buffer,0);if(this.buffer.length-4<i)return r();e=this.buffer.slice(0,4+i);if(this.buffer.length>4+i)return r(new Error("Unexpected multiple agent requests"));this.buffer=null;let s;const o=this.proc=u(n.ab+"pagent.exe",[e.length]);o.stdout.on("data",(e=>{this.push(e)}));o.on("error",(e=>{s=e;r(s)}));o.on("close",(e=>{this.proc=undefined;if(!s){if(s=h[e])return r(s);r()}}));o.stdin.end(e)}_final(e){destroy(this);e()}_destroy(e,t){destroy(this);t()}}return class PageantAgent extends OpenSSHAgent{getStream(e){e(null,new PageantSocket)}}})();const b=(()=>{const e=/^!<socket >(\d+) s ([A-Z0-9]{8}-[A-Z0-9]{8}-[A-Z0-9]{8}-[A-Z0-9]{8})/;return class CygwinAgent extends OpenSSHAgent{getStream(t){t=once(t);let n=this.socketPath;let i=false;o(n,(function readCygsocket(s,u){if(s){if(i)return t(new Error("Invalid cygwin unix socket path"));f("cygpath",["-w",n],((e,r,s)=>{if(e||r.length===0)return t(new Error("Invalid cygwin unix socket path"));i=true;n=r.toString().replace(/[\r\n]/g,"");o(n,readCygsocket)}));return}const l=e.exec(u.toString("ascii"));if(!l)return t(new Error("Malformed cygwin unix socket file"));let h;let p=0;let _=false;const y=[];let m;let I=Buffer.alloc(12);const b=parseInt(l[1],10);const w=l[2].replace(/-/g,"");const C=Buffer.allocUnsafe(16);for(let e=0,t=0;t<32;++e,t+=2)C[e]=parseInt(w.substring(t,t+2),16);for(let e=0;e<16;e+=4)E(C,g(C,e),e);tryConnect();function _onconnect(){p=0;h="secret";m.write(C)}function _ondata(e){p+=e.length;if(h==="secret"){if(p===16){p=0;h="creds";m.write(I)}return}if(h==="creds"){if(!_)y.push(e);if(p===12){m.removeListener("connect",_onconnect);m.removeListener("data",_ondata);m.removeListener("error",onFail);m.removeListener("end",onFail);m.removeListener("close",onFail);if(_)return t(null,m);_=true;I=Buffer.concat(y);E(I,process.pid,0);m.on("error",(()=>{}));m.destroy();tryConnect()}}}function onFail(){t(new Error("Problem negotiating cygwin unix socket security"))}function tryConnect(){m=new r;m.on("connect",_onconnect);m.on("data",_ondata);m.on("error",onFail);m.on("end",onFail);m.on("close",onFail);m.connect(b)}}))}}})();const w=/^[/\\][/\\]\.[/\\]pipe[/\\].+/;function createAgent(e){if(process.platform==="win32"&&!w.test(e)){return e==="pageant"?new I:new b(e)}return new OpenSSHAgent(e)}const C=(()=>{const e=11;const t=13;const n=5;const r=12;const s=14;const o=1<<1;const f=1<<2;const u=0;const p=1;function processResponses(e){let t;while(e[w].length){const n=e[w][0][I];if(n===undefined)break;e[w].shift();t=e.push(n)}return t}const E=Symbol("Inbound Request Type");const I=Symbol("Inbound Request Response");const b=Symbol("Inbound Request Context");class AgentInboundRequest{constructor(e,t){this[E]=e;this[I]=undefined;this[b]=t}hasResponded(){return this[I]!==undefined}getType(){return this[E]}getContext(){return this[b]}}function respond(e,t,n){t[I]=n;return processResponses(e)}function cleanup(e){e[k]=null;if(e[C]===u){const t=e[w];if(t&&t.length){e[w]=[];for(const e of t)e.cb(new Error("No reply from server"))}}try{e.end()}catch{}setImmediate((()=>{if(!e[v])e.emit("end");if(!e[B])e.emit("close")}))}function onClose(){this[B]=true}function onEnd(){this[v]=true}const w=Symbol("Requests");const C=Symbol("Agent Protocol Role");const k=Symbol("Agent Protocol Buffer");const R=Symbol("Agent Protocol Current Message Length");const B=Symbol("Agent Protocol Closed");const v=Symbol("Agent Protocol Ended");return class AgentProtocol extends i{constructor(e){super({autoDestroy:true,emitClose:false});this[C]=e?u:p;this[w]=[];this[k]=null;this[R]=-1;this.once("end",onEnd);this.once("close",onClose)}_read(e){}_write(i,l,p){if(this[k]===null)this[k]=i;else this[k]=concat(this[k],i);let _=this[k];let E=_.length;let y=0;while(y<E){if(E<5)break;if(this[R]===-1)this[R]=g(_,y);if(E<4+this[R])break;const i=_[y+=4];++y;if(this[C]===u){if(this[w].length===0)return p(new Error("Received unexpected message from server"));const o=this[w].shift();switch(i){case n:o.cb(new Error("Agent responded with failure"));break;case r:{if(o.type!==e)return p(new Error("Agent responded with wrong message type"));m.init(_,y);const t=m.readUInt32BE();if(t===undefined){m.clear();return p(new Error("Malformed agent response"))}const n=[];for(let e=0;e<t;++e){let e=m.readString();if(e===undefined){m.clear();return p(new Error("Malformed agent response"))}const t=m.readString(true);if(t===undefined){m.clear();return p(new Error("Malformed agent response"))}e=h(e);if(e instanceof Error)continue;e.comment=e.comment||t;n.push(e)}y=m.pos();m.clear();o.cb(null,n);break}case s:{if(o.type!==t)return p(new Error("Agent responded with wrong message type"));m.init(_,y);let e=m.readString();y=m.pos();m.clear();if(e===undefined)return p(new Error("Malformed agent response"));m.init(e,0);m.readString(true);e=m.readString();m.clear();if(e===undefined)return p(new Error("Malformed OpenSSH signature format"));o.cb(null,e);break}default:return p(new Error("Agent responded with unsupported message type"))}}else{switch(i){case e:{const e=new AgentInboundRequest(i);this[w].push(e);this.emit("identities",e);break}case t:{m.init(_,y);let e=m.readString();const t=m.readString();const n=m.readUInt32BE();y=m.pos();m.clear();if(n===undefined){const e=new AgentInboundRequest(i);this[w].push(e);return this.failureReply(e)}e=h(e);if(e instanceof Error){const e=new AgentInboundRequest(i);this[w].push(e);return this.failureReply(e)}const r={hash:undefined};let s;if(e.type==="ssh-rsa"){if(n&o){s="rsa-sha2-256";r.hash="sha256"}else if(n&f){s="rsa-sha2-512";r.hash="sha512"}}if(s===undefined)s=e.type;const u=new AgentInboundRequest(i,s);this[w].push(u);this.emit("sign",u,e,t,r);break}default:{const e=new AgentInboundRequest(i);this[w].push(e);this.failureReply(e)}}}this[R]=-1;if(y===E){this[k]=null;break}else{this[k]=_=_.slice(y);E=_.length;y=0}}p()}_destroy(e,t){cleanup(this);t()}_final(e){cleanup(this);e()}sign(e,n,r,i){if(this[C]!==u)throw new Error("Client-only method called with server role");if(typeof r==="function"){i=r;r=undefined}else if(typeof r!=="object"||r===null){r=undefined}let s=0;e=h(e);if(e instanceof Error)throw new Error("Invalid public key argument");if(e.type==="ssh-rsa"&&r){switch(r.hash){case"sha256":s=o;break;case"sha512":s=f;break}}e=e.getPublicSSH();const l=t;const p=e.length;const g=n.length;let E=0;const y=Buffer.allocUnsafe(4+1+4+p+4+g+4);_(y,y.length-4,E);y[E+=4]=l;_(y,p,++E);e.copy(y,E+=4);_(y,g,E+=p);n.copy(y,E+=4);_(y,s,E+=g);if(typeof i!=="function")i=noop;this[w].push({type:l,cb:i});return this.push(y)}getIdentities(t){if(this[C]!==u)throw new Error("Client-only method called with server role");const n=e;let r=0;const i=Buffer.allocUnsafe(4+1);_(i,i.length-4,r);i[r+=4]=n;if(typeof t!=="function")t=noop;this[w].push({type:n,cb:t});return this.push(i)}failureReply(e){if(this[C]!==p)throw new Error("Server-only method called with client role");if(!(e instanceof AgentInboundRequest))throw new Error("Wrong request argument");if(e.hasResponded())return true;let t=0;const r=Buffer.allocUnsafe(4+1);_(r,r.length-4,t);r[t+=4]=n;return respond(this,e,r)}getIdentitiesReply(t,n){if(this[C]!==p)throw new Error("Server-only method called with client role");if(!(t instanceof AgentInboundRequest))throw new Error("Wrong request argument");if(t.hasResponded())return true;if(t.getType()!==e)throw new Error("Invalid response to request");if(!Array.isArray(n))throw new Error("Keys argument must be an array");let i=4;const s=[];for(let e=0;e<n.length;++e){const t=n[e];if(typeof t!=="object"||t===null)throw new Error(`Invalid key entry: ${t}`);let r;let o;if(l(t)){r=t}else if(l(t.pubKey)){r=t.pubKey}else{if(typeof t.pubKey!=="object"||t.pubKey===null)continue;({pubKey:r,comment:o}=t.pubKey);r=h(r);if(r instanceof Error)continue}o=r.comment||o;r=r.getPublicSSH();i+=4+r.length;if(o&&typeof o==="string")o=Buffer.from(o);else if(!Buffer.isBuffer(o))o=y;i+=4+o.length;s.push({pubKey:r,comment:o})}let o=0;const f=Buffer.allocUnsafe(4+1+i);_(f,f.length-4,o);f[o+=4]=r;_(f,s.length,++o);o+=4;for(let e=0;e<s.length;++e){const{pubKey:t,comment:n}=s[e];_(f,t.length,o);t.copy(f,o+=4);_(f,n.length,o+=t.length);o+=4;if(n.length){n.copy(f,o);o+=n.length}}return respond(this,t,f)}signReply(e,n){if(this[C]!==p)throw new Error("Server-only method called with client role");if(!(e instanceof AgentInboundRequest))throw new Error("Wrong request argument");if(e.hasResponded())return true;if(e.getType()!==t)throw new Error("Invalid response to request");if(!Buffer.isBuffer(n))throw new Error("Signature argument must be a Buffer");if(n.length===0)throw new Error("Signature argument must be non-empty");let r=0;const i=e.getContext();const o=Buffer.byteLength(i);const f=Buffer.allocUnsafe(4+1+4+4+o+4+n.length);_(f,f.length-4,r);f[r+=4]=s;_(f,4+o+4+n.length,++r);_(f,o,r+=4);f.utf8Write(i,r+=4,o);_(f,n.length,r+=o);n.copy(f,r+=4);return respond(this,e,f)}}})();const k=Symbol("Agent");const R=Symbol("Agent Keys");const B=Symbol("Agent Keys Index");const v=Symbol("Agent Init Callbacks");class AgentContext{constructor(e){if(typeof e==="string")e=createAgent(e);else if(!isAgent(e))throw new Error("Invalid agent argument");this[k]=e;this[R]=null;this[B]=-1;this[v]=null}init(e){if(typeof e!=="function")e=noop;if(this[R]===null){if(this[v]===null){this[v]=[e];const doCbs=(...e)=>{process.nextTick((()=>{const t=this[v];this[v]=null;for(const n of t)n(...e)}))};this[k].getIdentities(once(((e,t)=>{if(e)return doCbs(e);if(!Array.isArray(t)){return doCbs(new Error("Agent implementation failed to provide keys"))}const n=[];for(let e of t){e=h(e);if(e instanceof Error){continue}n.push(e)}this[R]=n;this[B]=-1;doCbs()})))}else{this[v].push(e)}}else{process.nextTick(e)}}nextKey(){if(this[R]===null||++this[B]>=this[R].length){return false}return this[R][this[B]]}currentKey(){if(this[R]===null||this[B]>=this[R].length){return null}return this[R][this[B]]}pos(){if(this[R]===null||this[B]>=this[R].length){return-1}return this[B]}reset(){this[B]=-1}sign(...e){this[k].sign(...e)}}function isAgent(e){return e instanceof BaseAgent}e.exports={AgentContext:AgentContext,AgentProtocol:C,BaseAgent:BaseAgent,createAgent:createAgent,CygwinAgent:b,isAgent:isAgent,OpenSSHAgent:OpenSSHAgent,PageantAgent:I}},6063:(e,t,n)=>{"use strict";const{createHash:r,getHashes:i,randomFillSync:s}=n(6113);const{Socket:o}=n(1808);const{lookup:f}=n(9523);const u=n(2361);const l=i();const{COMPAT:h,CHANNEL_EXTENDED_DATATYPE:{STDERR:p},CHANNEL_OPEN_FAILURE:g,DEFAULT_CIPHER:_,DEFAULT_COMPRESSION:E,DEFAULT_KEX:y,DEFAULT_MAC:m,DEFAULT_SERVER_HOST_KEY:I,DISCONNECT_REASON:b,DISCONNECT_REASON_BY_VALUE:w,SUPPORTED_CIPHER:C,SUPPORTED_COMPRESSION:k,SUPPORTED_KEX:R,SUPPORTED_MAC:B,SUPPORTED_SERVER_HOST_KEY:v}=n(6832);const{init:O}=n(5708);const T=n(9031);const{parseKey:P}=n(2218);const{SFTP:L}=n(2026);const{bufferCopy:U,makeBufferParser:D,makeError:Q,readUInt32BE:x,sigSSHToASN1:W,writeUInt32BE:q}=n(9475);const{AgentContext:G,createAgent:$,isAgent:Y}=n(9054);const{Channel:j,MAX_WINDOW:V,PACKET_SIZE:z,windowAdjust:J,WINDOW_THRESHOLD:ee}=n(3204);const{ChannelManager:te,generateAlgorithmList:ne,isWritable:re,onChannelOpenFailure:ie,onCHANNEL_CLOSE:se}=n(834);const oe=D();const ae=D();const ce=/^OpenSSH_(?:(?![0-4])\d)|(?:\d{2,})/;const noop=e=>{};class Client extends u{constructor(){super();this.config={host:undefined,port:undefined,localAddress:undefined,localPort:undefined,forceIPv4:undefined,forceIPv6:undefined,keepaliveCountMax:undefined,keepaliveInterval:undefined,readyTimeout:undefined,ident:undefined,username:undefined,password:undefined,privateKey:undefined,tryKeyboard:undefined,agent:undefined,allowAgentFwd:undefined,authHandler:undefined,hostHashAlgo:undefined,hostHashCb:undefined,strictVendor:undefined,debug:undefined};this._agent=undefined;this._readyTimeout=undefined;this._chanMgr=undefined;this._callbacks=undefined;this._forwarding=undefined;this._forwardingUnix=undefined;this._acceptX11=undefined;this._agentFwdEnabled=undefined;this._remoteVer=undefined;this._protocol=undefined;this._sock=undefined;this._resetKA=undefined}connect(e){if(this._sock&&re(this._sock)){this.once("close",(()=>{this.connect(e)}));this.end();return this}this.config.host=e.hostname||e.host||"localhost";this.config.port=e.port||22;this.config.localAddress=typeof e.localAddress==="string"?e.localAddress:undefined;this.config.localPort=typeof e.localPort==="string"||typeof e.localPort==="number"?e.localPort:undefined;this.config.forceIPv4=e.forceIPv4||false;this.config.forceIPv6=e.forceIPv6||false;this.config.keepaliveCountMax=typeof e.keepaliveCountMax==="number"&&e.keepaliveCountMax>=0?e.keepaliveCountMax:3;this.config.keepaliveInterval=typeof e.keepaliveInterval==="number"&&e.keepaliveInterval>0?e.keepaliveInterval:0;this.config.readyTimeout=typeof e.readyTimeout==="number"&&e.readyTimeout>=0?e.readyTimeout:2e4;this.config.ident=typeof e.ident==="string"||Buffer.isBuffer(e.ident)?e.ident:undefined;const t={kex:undefined,serverHostKey:undefined,cs:{cipher:undefined,mac:undefined,compress:undefined,lang:[]},sc:undefined};let n=true;if(typeof e.algorithms==="object"&&e.algorithms!==null){t.kex=ne(e.algorithms.kex,y,R);if(t.kex!==y)n=false;t.serverHostKey=ne(e.algorithms.serverHostKey,I,v);if(t.serverHostKey!==I)n=false;t.cs.cipher=ne(e.algorithms.cipher,_,C);if(t.cs.cipher!==_)n=false;t.cs.mac=ne(e.algorithms.hmac,m,B);if(t.cs.mac!==m)n=false;t.cs.compress=ne(e.algorithms.compress,E,k);if(t.cs.compress!==E)n=false;if(!n)t.sc=t.cs}if(typeof e.username==="string")this.config.username=e.username;else if(typeof e.user==="string")this.config.username=e.user;else throw new Error("Invalid username");this.config.password=typeof e.password==="string"?e.password:undefined;this.config.privateKey=typeof e.privateKey==="string"||Buffer.isBuffer(e.privateKey)?e.privateKey:undefined;this.config.localHostname=typeof e.localHostname==="string"?e.localHostname:undefined;this.config.localUsername=typeof e.localUsername==="string"?e.localUsername:undefined;this.config.tryKeyboard=e.tryKeyboard===true;if(typeof e.agent==="string"&&e.agent.length)this.config.agent=$(e.agent);else if(Y(e.agent))this.config.agent=e.agent;else this.config.agent=undefined;this.config.allowAgentFwd=e.agentForward===true&&this.config.agent!==undefined;let i=this.config.authHandler=typeof e.authHandler==="function"||Array.isArray(e.authHandler)?e.authHandler:undefined;this.config.strictVendor=typeof e.strictVendor==="boolean"?e.strictVendor:true;const s=this.config.debug=typeof e.debug==="function"?e.debug:undefined;if(e.agentForward===true&&!this.config.allowAgentFwd){throw new Error("You must set a valid agent path to allow agent forwarding")}let u=this._callbacks=[];this._chanMgr=new te(this);this._forwarding={};this._forwardingUnix={};this._acceptX11=0;this._agentFwdEnabled=false;this._agent=this.config.agent?this.config.agent:undefined;this._remoteVer=undefined;let h;if(this.config.privateKey){h=P(this.config.privateKey,e.passphrase);if(h instanceof Error)throw new Error(`Cannot parse privateKey: ${h.message}`);if(Array.isArray(h)){h=h[0]}if(h.getPrivatePEM()===null){throw new Error("privateKey value does not contain a (valid) private key")}}let g;if(typeof e.hostVerifier==="function"){const t=e.hostVerifier;let n;if(l.indexOf(e.hostHash)!==-1){n=r(e.hostHash)}g=(e,r)=>{if(n){n.update(e);e=n.digest("hex")}const i=t(e,r);if(i!==undefined)r(i)}}const U=this._sock=e.sock||new o;let D=false;let x=false;if(this._protocol)this._protocol.cleanup();const W=!s?undefined:(e,t,n)=>{s(`Debug output from server: ${JSON.stringify(n)}`)};const q=this._protocol=new T({ident:this.config.ident,offer:n?undefined:t,onWrite:e=>{if(re(U))U.write(e)},onError:e=>{if(e.level==="handshake")clearTimeout(this._readyTimeout);if(!q._destruct)U.removeAllListeners("data");this.emit("error",e);try{U.end()}catch{}},onHeader:e=>{x=true;this._remoteVer=e.versions.software;if(e.greeting)this.emit("greeting",e.greeting)},onHandshakeComplete:e=>{this.emit("handshake",e);if(!D){D=true;q.service("ssh-userauth")}},debug:s,hostVerifier:g,messageHandlers:{DEBUG:W,DISCONNECT:(e,t,n)=>{if(t!==b.BY_APPLICATION){if(!n){n=w[t];if(n===undefined)n=`Unexpected disconnection reason: ${t}`}const e=new Error(n);e.code=t;this.emit("error",e)}U.end()},SERVICE_ACCEPT:(e,t)=>{if(t==="ssh-userauth")tryNextAuth()},USERAUTH_BANNER:(e,t)=>{this.emit("banner",t)},USERAUTH_SUCCESS:e=>{resetKA();clearTimeout(this._readyTimeout);this.emit("ready")},USERAUTH_FAILURE:(e,t,n)=>{if(de.type==="agent"){const e=de.agentCtx.pos();s&&s(`Client: Agent key #${e+1} failed`);return tryNextAgentKey()}s&&s(`Client: ${de.type} auth failed`);pe=n;ge=t;tryNextAuth()},USERAUTH_PASSWD_CHANGEREQ:(e,t)=>{if(de.type==="password"){this.emit("change password",t,(e=>{q.authPassword(this.config.username,this.config.password,e)}))}},USERAUTH_PK_OK:e=>{if(de.type==="agent"){const e=de.agentCtx.currentKey();q.authPK(de.username,e,((t,n)=>{de.agentCtx.sign(e,t,{},((e,t)=>{if(e){e.level="agent";this.emit("error",e)}else{return n(t)}tryNextAgentKey()}))}))}else if(de.type==="publickey"){q.authPK(de.username,de.key,((e,t)=>{const n=de.key.sign(e);if(n instanceof Error){n.message=`Error signing data with key: ${n.message}`;n.level="client-authentication";this.emit("error",n);return tryNextAuth()}t(n)}))}},USERAUTH_INFO_REQUEST:(e,t,n,r)=>{if(de.type==="keyboard-interactive"){const e=Array.isArray(r)?r.length:0;if(e===0){s&&s("Client: Sending automatic USERAUTH_INFO_RESPONSE");q.authInfoRes();return}de.prompt(t,n,"",r,(e=>{q.authInfoRes(e)}))}},REQUEST_SUCCESS:(e,t)=>{if(u.length)u.shift()(false,t)},REQUEST_FAILURE:e=>{if(u.length)u.shift()(true)},GLOBAL_REQUEST:(e,t,n,r)=>{switch(t){case"hostkeys-00@openssh.com":hostKeysProve(this,r,((e,t)=>{if(e)return;this.emit("hostkeys",t)}));if(n)q.requestSuccess();break;default:if(n)q.requestFailure()}},CHANNEL_OPEN:(e,t)=>{onCHANNEL_OPEN(this,t)},CHANNEL_OPEN_CONFIRMATION:(e,t)=>{const n=this._chanMgr.get(t.recipient);if(typeof n!=="function")return;const r=n.type==="sftp";const i=r?"session":n.type;const o={type:i,incoming:{id:t.recipient,window:V,packetSize:z,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};const f=r?new L(this,o,{debug:s}):new j(this,o);this._chanMgr.update(t.recipient,f);n(undefined,f)},CHANNEL_OPEN_FAILURE:(e,t,n,r)=>{const i=this._chanMgr.get(t);if(typeof i!=="function")return;const s={reason:n,description:r};ie(this,t,s,i)},CHANNEL_DATA:(e,t,n)=>{const r=this._chanMgr.get(t);if(typeof r!=="object"||r===null)return;if(r.incoming.window===0)return;r.incoming.window-=n.length;if(r.push(n)===false){r._waitChanDrain=true;return}if(r.incoming.window<=ee)J(r)},CHANNEL_EXTENDED_DATA:(e,t,n,r)=>{if(r!==p)return;const i=this._chanMgr.get(t);if(typeof i!=="object"||i===null)return;if(i.incoming.window===0)return;i.incoming.window-=n.length;if(!i.stderr.push(n)){i._waitChanDrain=true;return}if(i.incoming.window<=ee)J(i)},CHANNEL_WINDOW_ADJUST:(e,t,n)=>{const r=this._chanMgr.get(t);if(typeof r!=="object"||r===null)return;r.outgoing.window+=n;if(r._waitWindow){r._waitWindow=false;if(r._chunk){r._write(r._chunk,null,r._chunkcb)}else if(r._chunkcb){r._chunkcb()}else if(r._chunkErr){r.stderr._write(r._chunkErr,null,r._chunkcbErr)}else if(r._chunkcbErr){r._chunkcbErr()}}},CHANNEL_SUCCESS:(e,t)=>{const n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;this._resetKA();if(n._callbacks.length)n._callbacks.shift()(false)},CHANNEL_FAILURE:(e,t)=>{const n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;this._resetKA();if(n._callbacks.length)n._callbacks.shift()(true)},CHANNEL_REQUEST:(e,t,n,r,i)=>{const s=this._chanMgr.get(t);if(typeof s!=="object"||s===null)return;const o=s._exit;if(o.code!==undefined)return;switch(n){case"exit-status":s.emit("exit",o.code=i);return;case"exit-signal":s.emit("exit",o.code=null,o.signal=`SIG${i.signal}`,o.dump=i.coreDumped,o.desc=i.errorMessage);return}if(r)e.channelFailure(s.outgoing.id)},CHANNEL_EOF:(e,t)=>{const n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;if(n.incoming.state!=="open")return;n.incoming.state="eof";if(n.readable)n.push(null);if(n.stderr.readable)n.stderr.push(null)},CHANNEL_CLOSE:(e,t)=>{se(this,t,this._chanMgr.get(t))}}});U.pause();const oe=this.config.keepaliveInterval;const ae=this.config.keepaliveCountMax;let ce=0;let fe;const sendKA=()=>{if(++ce>ae){clearInterval(fe);if(U.readable){const e=new Error("Keepalive timeout");e.level="client-timeout";this.emit("error",e);U.destroy()}return}if(re(U)){u.push(resetKA);q.ping()}else{clearInterval(fe)}};function resetKA(){if(oe>0){ce=0;clearInterval(fe);if(re(U))fe=setInterval(sendKA,oe)}}this._resetKA=resetKA;const ue=(()=>{let e=false;return()=>{if(e)return;e=true;if(he&&!x){const e=Q("Connection lost before handshake","protocol",true);this.emit("error",e)}}})();const le=(()=>{let e=false;return()=>{if(e)return;e=true;he=true;s&&s("Socket connected");this.emit("connect");O.then((()=>{q.start();U.on("data",(e=>{try{q.parse(e,0,e.length)}catch(e){this.emit("error",e);try{if(re(U))U.end()}catch{}}}));if(U.stderr&&typeof U.stderr.resume==="function")U.stderr.resume();U.resume()})).catch((e=>{this.emit("error",e);try{if(re(U))U.end()}catch{}}))}})();let he=false;U.on("connect",le).on("timeout",(()=>{this.emit("timeout")})).on("error",(e=>{s&&s(`Socket error: ${e.message}`);clearTimeout(this._readyTimeout);e.level="client-socket";this.emit("error",e)})).on("end",(()=>{s&&s("Socket ended");ue();q.cleanup();clearTimeout(this._readyTimeout);clearInterval(fe);this.emit("end")})).on("close",(()=>{s&&s("Socket closed");ue();q.cleanup();clearTimeout(this._readyTimeout);clearInterval(fe);this.emit("close");const e=u;u=this._callbacks=[];const t=new Error("No response from server");for(let n=0;n<e.length;++n)e[n](t);this._chanMgr.cleanup(t)}));let de;let pe=null;let ge=null;const Ae=["none"];if(this.config.password!==undefined)Ae.push("password");if(h!==undefined)Ae.push("publickey");if(this._agent!==undefined)Ae.push("agent");if(this.config.tryKeyboard)Ae.push("keyboard-interactive");if(h!==undefined&&this.config.localHostname!==undefined&&this.config.localUsername!==undefined){Ae.push("hostbased")}if(Array.isArray(i))i=makeSimpleAuthHandler(i);else if(typeof i!=="function")i=makeSimpleAuthHandler(Ae);let _e=false;const doNextAuth=e=>{if(_e)return;_e=true;if(e===false){const e=new Error("All configured authentication methods failed");e.level="client-authentication";this.emit("error",e);this.end();return}if(typeof e==="string"){const t=e;if(Ae.indexOf(t)===-1)return skipAuth(`Authentication method not allowed: ${t}`);const n=this.config.username;switch(t){case"password":e={type:t,username:n,password:this.config.password};break;case"publickey":e={type:t,username:n,key:h};break;case"hostbased":e={type:t,username:n,key:h,localHostname:this.config.localHostname,localUsername:this.config.localUsername};break;case"agent":e={type:t,username:n,agentCtx:new G(this._agent)};break;case"keyboard-interactive":e={type:t,username:n,prompt:(...e)=>this.emit("keyboard-interactive",...e)};break;case"none":e={type:t,username:n};break;default:return skipAuth(`Skipping unsupported authentication method: ${e}`)}}else if(typeof e!=="object"||e===null){return skipAuth(`Skipping invalid authentication attempt: ${e}`)}else{const t=e.username;if(typeof t!=="string"){return skipAuth(`Skipping invalid authentication attempt: ${e}`)}const n=e.type;switch(n){case"password":{const{password:r}=e;if(typeof r!=="string"&&!Buffer.isBuffer(r))return skipAuth("Skipping invalid password auth attempt");e={type:n,username:t,password:r};break}case"publickey":{const r=P(e.key,e.passphrase);if(r instanceof Error)return skipAuth("Skipping invalid key auth attempt");if(!r.isPrivateKey())return skipAuth("Skipping non-private key");e={type:n,username:t,key:r};break}case"hostbased":{const{localHostname:r,localUsername:i}=e;const s=P(e.key,e.passphrase);if(s instanceof Error||typeof r!=="string"||typeof i!=="string"){return skipAuth("Skipping invalid hostbased auth attempt")}if(!s.isPrivateKey())return skipAuth("Skipping non-private key");e={type:n,username:t,key:s,localHostname:r,localUsername:i};break}case"agent":{let r=e.agent;if(typeof r==="string"&&r.length){r=$(r)}else if(!Y(r)){return skipAuth(`Skipping invalid agent: ${e.agent}`)}e={type:n,username:t,agentCtx:new G(r)};break}case"keyboard-interactive":{const{prompt:r}=e;if(typeof r!=="function"){return skipAuth("Skipping invalid keyboard-interactive auth attempt")}e={type:n,username:t,prompt:r};break}case"none":e={type:n,username:t};break;default:return skipAuth(`Skipping unsupported authentication method: ${e}`)}}de=e;try{const e=de.username;switch(de.type){case"password":q.authPassword(e,de.password);break;case"publickey":q.authPK(e,de.key);break;case"hostbased":q.authHostbased(e,de.key,de.localHostname,de.localUsername,((e,t)=>{const n=de.key.sign(e);if(n instanceof Error){n.message=`Error while signing with key: ${n.message}`;n.level="client-authentication";this.emit("error",n);return tryNextAuth()}t(n)}));break;case"agent":de.agentCtx.init((e=>{if(e){e.level="agent";this.emit("error",e);return tryNextAuth()}tryNextAgentKey()}));break;case"keyboard-interactive":q.authKeyboard(e);break;case"none":q.authNone(e);break}}finally{_e=false}};function skipAuth(e){s&&s(e);process.nextTick(tryNextAuth)}function tryNextAuth(){_e=false;const e=i(ge,pe,doNextAuth);if(_e||e===undefined)return;doNextAuth(e)}const tryNextAgentKey=()=>{if(de.type==="agent"){const e=de.agentCtx.nextKey();if(e===false){s&&s("Agent: No more keys left to try");s&&s("Client: agent auth failed");tryNextAuth()}else{const t=de.agentCtx.pos();s&&s(`Agent: Trying key #${t+1}`);q.authPK(de.username,e)}}};const startTimeout=()=>{if(this.config.readyTimeout>0){this._readyTimeout=setTimeout((()=>{const e=new Error("Timed out while waiting for handshake");e.level="client-timeout";this.emit("error",e);U.destroy()}),this.config.readyTimeout)}};if(!e.sock){let t=this.config.host;const n=this.config.forceIPv4;const r=this.config.forceIPv6;s&&s(`Client: Trying ${t} on port ${this.config.port} ...`);const doConnect=()=>{startTimeout();U.connect({host:t,port:this.config.port,localAddress:this.config.localAddress,localPort:this.config.localPort});U.setNoDelay(true);U.setMaxListeners(0);U.setTimeout(typeof e.timeout==="number"?e.timeout:0)};if(!n&&!r||n&&r){doConnect()}else{f(t,n?4:6,((e,r,i)=>{if(e){const r=n?"IPv4":"IPv6";const i=new Error(`Error while looking up ${r} address for '${t}': ${e}`);clearTimeout(this._readyTimeout);i.level="client-dns";this.emit("error",i);this.emit("close");return}t=r;doConnect()}))}}else{startTimeout();if(typeof U.connecting==="boolean"){if(!U.connecting){le()}}else{le()}}return this}end(){if(this._sock&&re(this._sock)){this._protocol.disconnect(b.BY_APPLICATION);this._sock.end()}return this}destroy(){this._sock&&re(this._sock)&&this._sock.destroy();return this}exec(e,t,n){if(!this._sock||!re(this._sock))throw new Error("Not connected");if(typeof t==="function"){n=t;t={}}const r={allowHalfOpen:t.allowHalfOpen!==false};openChannel(this,"session",r,((r,i)=>{if(r){n(r);return}const s=[];function reqCb(e){if(e){i.close();n(e);return}if(s.length)s.shift()()}if(this.config.allowAgentFwd===true||t&&t.agentForward===true&&this._agent!==undefined){s.push((()=>reqAgentFwd(i,reqCb)))}if(typeof t==="object"&&t!==null){if(typeof t.env==="object"&&t.env!==null)reqEnv(i,t.env);if(typeof t.pty==="object"&&t.pty!==null||t.pty===true){s.push((()=>reqPty(i,t.pty,reqCb)))}if(typeof t.x11==="object"&&t.x11!==null||t.x11==="number"||t.x11===true){s.push((()=>reqX11(i,t.x11,reqCb)))}}s.push((()=>reqExec(i,e,t,n)));s.shift()()}));return this}shell(e,t,n){if(!this._sock||!re(this._sock))throw new Error("Not connected");if(typeof e==="function"){n=e;e=t=undefined}else if(typeof t==="function"){n=t;t=undefined}if(e&&(e.x11!==undefined||e.env!==undefined)){t=e;e=undefined}openChannel(this,"session",((r,i)=>{if(r){n(r);return}const s=[];function reqCb(e){if(e){i.close();n(e);return}if(s.length)s.shift()()}if(this.config.allowAgentFwd===true||t&&t.agentForward===true&&this._agent!==undefined){s.push((()=>reqAgentFwd(i,reqCb)))}if(e!==false)s.push((()=>reqPty(i,e,reqCb)));if(typeof t==="object"&&t!==null){if(typeof t.env==="object"&&t.env!==null)reqEnv(i,t.env);if(typeof t.x11==="object"&&t.x11!==null||t.x11==="number"||t.x11===true){s.push((()=>reqX11(i,t.x11,reqCb)))}}s.push((()=>reqShell(i,n)));s.shift()()}));return this}subsys(e,t){if(!this._sock||!re(this._sock))throw new Error("Not connected");openChannel(this,"session",((n,r)=>{if(n){t(n);return}reqSubsystem(r,e,((e,n)=>{if(e){t(e);return}t(undefined,n)}))}));return this}forwardIn(e,t,n){if(!this._sock||!re(this._sock))throw new Error("Not connected");const r=typeof n==="function";if(r){this._callbacks.push(((r,i)=>{if(r){n(r!==true?r:new Error(`Unable to bind to ${e}:${t}`));return}let s=t;if(t===0&&i&&i.length>=4){s=x(i,0);if(!(this._protocol._compatFlags&h.DYN_RPORT_BUG))t=s}this._forwarding[`${e}:${t}`]=s;n(undefined,s)}))}this._protocol.tcpipForward(e,t,r);return this}unforwardIn(e,t,n){if(!this._sock||!re(this._sock))throw new Error("Not connected");const r=typeof n==="function";if(r){this._callbacks.push((r=>{if(r){n(r!==true?r:new Error(`Unable to unbind from ${e}:${t}`));return}delete this._forwarding[`${e}:${t}`];n()}))}this._protocol.cancelTcpipForward(e,t,r);return this}forwardOut(e,t,n,r,i){if(!this._sock||!re(this._sock))throw new Error("Not connected");const s={srcIP:e,srcPort:t,dstIP:n,dstPort:r};if(typeof i!=="function")i=noop;openChannel(this,"direct-tcpip",s,i);return this}openssh_noMoreSessions(e){if(!this._sock||!re(this._sock))throw new Error("Not connected");const t=typeof e==="function";if(!this.config.strictVendor||this.config.strictVendor&&ce.test(this._remoteVer)){if(t){this._callbacks.push((t=>{if(t){e(t!==true?t:new Error("Unable to disable future sessions"));return}e()}))}this._protocol.openssh_noMoreSessions(t);return this}if(!t)return this;process.nextTick(e,new Error("strictVendor enabled and server is not OpenSSH or compatible version"));return this}openssh_forwardInStreamLocal(e,t){if(!this._sock||!re(this._sock))throw new Error("Not connected");const n=typeof t==="function";if(!this.config.strictVendor||this.config.strictVendor&&ce.test(this._remoteVer)){if(n){this._callbacks.push((n=>{if(n){t(n!==true?n:new Error(`Unable to bind to ${e}`));return}this._forwardingUnix[e]=true;t()}))}this._protocol.openssh_streamLocalForward(e,n);return this}if(!n)return this;process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version"));return this}openssh_unforwardInStreamLocal(e,t){if(!this._sock||!re(this._sock))throw new Error("Not connected");const n=typeof t==="function";if(!this.config.strictVendor||this.config.strictVendor&&ce.test(this._remoteVer)){if(n){this._callbacks.push((n=>{if(n){t(n!==true?n:new Error(`Unable to unbind from ${e}`));return}delete this._forwardingUnix[e];t()}))}this._protocol.openssh_cancelStreamLocalForward(e,n);return this}if(!n)return this;process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version"));return this}openssh_forwardOutStreamLocal(e,t){if(!this._sock||!re(this._sock))throw new Error("Not connected");if(typeof t!=="function")t=noop;if(!this.config.strictVendor||this.config.strictVendor&&ce.test(this._remoteVer)){openChannel(this,"direct-streamlocal@openssh.com",{socketPath:e},t);return this}process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version"));return this}sftp(e){if(!this._sock||!re(this._sock))throw new Error("Not connected");openChannel(this,"sftp",((t,n)=>{if(t){e(t);return}reqSubsystem(n,"sftp",((t,r)=>{if(t){e(t);return}function removeListeners(){n.removeListener("ready",onReady);n.removeListener("error",onError);n.removeListener("exit",onExit);n.removeListener("close",onExit)}function onReady(){removeListeners();e(undefined,n)}function onError(t){removeListeners();e(t)}function onExit(t,n){removeListeners();let r;if(typeof t==="number")r=`Received exit code ${t} while establishing SFTP session`;else if(n!==undefined)r=`Received signal ${n} while establishing SFTP session`;else r="Received unexpected SFTP session termination";const i=new Error(r);i.code=t;i.signal=n;e(i)}n.on("ready",onReady).on("error",onError).on("exit",onExit).on("close",onExit);n._init()}))}));return this}}function openChannel(e,t,n,r){const i=V;const s=z;if(typeof n==="function"){r=n;n={}}const wrapper=(e,t)=>{r(e,t)};wrapper.type=t;const o=e._chanMgr.add(wrapper);if(o===-1){r(new Error("No free channels available"));return}switch(t){case"session":case"sftp":e._protocol.session(o,i,s);break;case"direct-tcpip":e._protocol.directTcpip(o,i,s,n);break;case"direct-streamlocal@openssh.com":e._protocol.openssh_directStreamLocal(o,i,s,n);break;default:throw new Error(`Unsupported channel type: ${t}`)}}function reqX11(e,t,n){const r={single:false,protocol:"MIT-MAGIC-COOKIE-1",cookie:undefined,screen:0};if(typeof t==="function"){n=t}else if(typeof t==="object"&&t!==null){if(typeof t.single==="boolean")r.single=t.single;if(typeof t.screen==="number")r.screen=t.screen;if(typeof t.protocol==="string")r.protocol=t.protocol;if(typeof t.cookie==="string")r.cookie=t.cookie;else if(Buffer.isBuffer(t.cookie))r.cookie=t.cookie.hexSlice(0,t.cookie.length)}if(r.cookie===undefined)r.cookie=fe();const i=typeof n==="function";if(e.outgoing.state!=="open"){if(i)n(new Error("Channel is not open"));return}if(i){e._callbacks.push((t=>{if(t){n(t!==true?t:new Error("Unable to request X11"));return}e._hasX11=true;++e._client._acceptX11;e.once("close",(()=>{if(e._client._acceptX11)--e._client._acceptX11}));n()}))}e._client._protocol.x11Forward(e.outgoing.id,r,i)}function reqPty(e,t,n){let r=24;let i=80;let s=640;let o=480;let f="vt100";let u=null;if(typeof t==="function"){n=t}else if(typeof t==="object"&&t!==null){if(typeof t.rows==="number")r=t.rows;if(typeof t.cols==="number")i=t.cols;if(typeof t.width==="number")s=t.width;if(typeof t.height==="number")o=t.height;if(typeof t.term==="string")f=t.term;if(typeof t.modes==="object")u=t.modes}const l=typeof n==="function";if(e.outgoing.state!=="open"){if(l)n(new Error("Channel is not open"));return}if(l){e._callbacks.push((e=>{if(e){n(e!==true?e:new Error("Unable to request a pseudo-terminal"));return}n()}))}e._client._protocol.pty(e.outgoing.id,r,i,o,s,f,u,l)}function reqAgentFwd(e,t){const n=typeof t==="function";if(e.outgoing.state!=="open"){n&&t(new Error("Channel is not open"));return}if(e._client._agentFwdEnabled){n&&t(false);return}e._client._agentFwdEnabled=true;e._callbacks.push((r=>{if(r){e._client._agentFwdEnabled=false;if(n){t(r!==true?r:new Error("Unable to request agent forwarding"))}return}if(n)t()}));e._client._protocol.openssh_agentForward(e.outgoing.id,true)}function reqShell(e,t){if(e.outgoing.state!=="open"){t(new Error("Channel is not open"));return}e._callbacks.push((n=>{if(n){t(n!==true?n:new Error("Unable to open shell"));return}e.subtype="shell";t(undefined,e)}));e._client._protocol.shell(e.outgoing.id,true)}function reqExec(e,t,n,r){if(e.outgoing.state!=="open"){r(new Error("Channel is not open"));return}e._callbacks.push((t=>{if(t){r(t!==true?t:new Error("Unable to exec"));return}e.subtype="exec";e.allowHalfOpen=n.allowHalfOpen!==false;r(undefined,e)}));e._client._protocol.exec(e.outgoing.id,t,true)}function reqEnv(e,t){if(e.outgoing.state!=="open")return;const n=Object.keys(t||{});for(let r=0;r<n.length;++r){const i=n[r];const s=t[i];e._client._protocol.env(e.outgoing.id,i,s,false)}}function reqSubsystem(e,t,n){if(e.outgoing.state!=="open"){n(new Error("Channel is not open"));return}e._callbacks.push((r=>{if(r){n(r!==true?r:new Error(`Unable to start subsystem: ${t}`));return}e.subtype="subsystem";n(undefined,e)}));e._client._protocol.subsystem(e.outgoing.id,t,true)}function onCHANNEL_OPEN(e,t){let n=-1;let r;const accept=()=>{const r={type:t.type,incoming:{id:n,window:V,packetSize:z,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};const i=new j(e,r);e._chanMgr.update(n,i);e._protocol.channelOpenConfirm(t.sender,n,V,z);return i};const reject=()=>{if(r===undefined){if(n===-1)r=g.RESOURCE_SHORTAGE;else r=g.CONNECT_FAILED}if(n!==-1)e._chanMgr.remove(n);e._protocol.channelOpenFail(t.sender,r,"")};const reserveChannel=()=>{n=e._chanMgr.add();if(n===-1){r=g.RESOURCE_SHORTAGE;if(e.config.debug){e.config.debug("Client: Automatic rejection of incoming channel open: "+"no channels available")}}return n!==-1};const i=t.data;switch(t.type){case"forwarded-tcpip":{const t=e._forwarding[`${i.destIP}:${i.destPort}`];if(t!==undefined&&reserveChannel()){if(i.destPort===0)i.destPort=t;e.emit("tcp connection",i,accept,reject);return}break}case"forwarded-streamlocal@openssh.com":if(e._forwardingUnix[i.socketPath]!==undefined&&reserveChannel()){e.emit("unix connection",i,accept,reject);return}break;case"auth-agent@openssh.com":if(e._agentFwdEnabled&&typeof e._agent.getStream==="function"&&reserveChannel()){e._agent.getStream(((e,t)=>{if(e)return reject();const n=accept();n.pipe(t).pipe(n)}));return}break;case"x11":if(e._acceptX11!==0&&reserveChannel()){e.emit("x11",i,accept,reject);return}break;default:r=g.UNKNOWN_CHANNEL_TYPE;if(e.config.debug){e.config.debug("Client: Automatic rejection of unsupported incoming channel open "+`type: ${t.type}`)}}if(r===undefined){r=g.ADMINISTRATIVELY_PROHIBITED;if(e.config.debug){e.config.debug("Client: Automatic rejection of unexpected incoming channel open for: "+t.type)}}reject()}const fe=(()=>{const e=Buffer.allocUnsafe(16);return()=>{s(e,0,16);return e.hexSlice(0,16)}})();function makeSimpleAuthHandler(e){if(!Array.isArray(e))throw new Error("authList must be an array");let t=0;return(n,r,i)=>{if(t===e.length)return false;return e[t++]}}function hostKeysProve(e,t,n){if(!e._sock||!re(e._sock))return;if(typeof n!=="function")n=noop;if(!Array.isArray(t))throw new TypeError("Invalid keys argument type");const r=[];for(const e of t){const t=P(e);if(t instanceof Error)throw t;r.push(t)}if(!e.config.strictVendor||e.config.strictVendor&&ce.test(e._remoteVer)){e._callbacks.push(((t,i)=>{if(t){n(t!==true?t:new Error("Server failed to prove supplied keys"));return}const s=[];let o=0;oe.init(i,0);while(oe.avail()){if(o===r.length)break;const t=r[o++];const n=t.getPublicSSH();const i=oe.readString();ae.init(i,0);const f=ae.readString(true);let u=ae.readString();let l;if(f!==t.type){if(t.type==="ssh-rsa"){switch(f){case"rsa-sha2-256":l="sha256";break;case"rsa-sha2-512":l="sha512";break;default:continue}}else{continue}}const h=e._protocol._kex.sessionID;const p=Buffer.allocUnsafe(4+29+4+h.length+4+n.length);let g=0;q(p,29,g);p.utf8Write("hostkeys-prove-00@openssh.com",g+=4,29);q(p,h.length,g+=29);U(h,p,0,h.length,g+=4);q(p,n.length,g+=h.length);U(n,p,0,n.length,g+=4);if(!(u=W(u,f)))continue;if(t.verify(p,u,l)===true)s.push(t)}ae.clear();oe.clear();n(null,s)}));e._protocol.openssh_hostKeysProve(r);return}process.nextTick(n,new Error("strictVendor enabled and server is not OpenSSH or compatible version"))}e.exports=Client},2994:(e,t,n)=>{"use strict";const{Agent:r}=n(3685);const{Agent:i}=n(5687);const{connect:s}=n(4404);let o;for(const e of[r,i]){class SSHAgent extends e{constructor(e,t){super(t);this._connectCfg=e;this._defaultSrcIP=t&&t.srcIP||"localhost"}createConnection(t,r){const i=t&&t.localAddress||this._defaultSrcIP;const s=t&&t.localPort||0;const f=t.host;const u=t.port;if(o===undefined)o=n(6063);const l=new o;let h=false;l.on("ready",(()=>{l.forwardOut(i,s,f,u,((n,i)=>{h=true;if(n){l.end();return r(n)}i.once("close",(()=>l.end()));r(null,decorateStream(i,e,t))}))})).on("error",r).on("close",(()=>{if(!h)r(new Error("Unexpected connection close"))})).connect(this._connectCfg)}}t[e===r?"SSHTTPAgent":"SSHTTPSAgent"]=SSHAgent}function noop(){}function decorateStream(e,t,n){if(t===r){e.setKeepAlive=noop;e.setNoDelay=noop;e.setTimeout=noop;e.ref=noop;e.unref=noop;e.destroySoon=e.destroy;return e}n.socket=e;const i=s(n);const o=(()=>{let t=false;return()=>{if(t)return;t=true;if(e.isPaused())e.resume()}})();i.on("end",o).on("close",o);return i}},5869:(e,t,n)=>{"use strict";const{AgentProtocol:r,BaseAgent:i,createAgent:s,CygwinAgent:o,OpenSSHAgent:f,PageantAgent:u}=n(9054);const{SSHTTPAgent:l,SSHTTPSAgent:h}=n(2994);const{parseKey:p}=n(2218);const{flagsToString:g,OPEN_MODE:_,STATUS_CODE:E,stringToFlags:y}=n(2026);e.exports={AgentProtocol:r,BaseAgent:i,createAgent:s,Client:n(6063),CygwinAgent:o,HTTPAgent:l,HTTPSAgent:h,OpenSSHAgent:f,PageantAgent:u,Server:n(2986),utils:{parseKey:p,sftp:{flagsToString:g,OPEN_MODE:_,STATUS_CODE:E,stringToFlags:y}}}},9031:(e,t,n)=>{"use strict";const{inspect:r}=n(3837);const{bindingAvailable:i,NullCipher:s,NullDecipher:o}=n(5708);const{COMPAT_CHECKS:f,DISCONNECT_REASON:u,MESSAGE:l,SIGNALS:h,TERMINAL_MODE:p}=n(6832);const{DEFAULT_KEXINIT:g,KexInit:_,kexinit:E,onKEXPayload:y}=n(4126);const{parseKey:m}=n(2218);const I=n(172);const{bufferCopy:b,bufferFill:w,bufferSlice:C,convertSignature:k,sendPacket:R,writeUInt32BE:B}=n(9475);const{PacketReader:v,PacketWriter:O,ZlibPacketReader:T,ZlibPacketWriter:P}=n(6715);const L=n(6674).i8;const U=new Map(Object.values(u).map((e=>[e,1])));const D=Buffer.from(`SSH-2.0-ssh2js${L}`);const Q=Buffer.from(`${D}\r\n`);const x=8192;const W=1024;const q=Buffer.from([l.GLOBAL_REQUEST,0,0,0,21,107,101,101,112,97,108,105,118,101,64,111,112,101,110,115,115,104,46,99,111,109,1]);const G=Buffer.from([p.TTY_OP_END]);function noop(){}class Protocol{constructor(e){const t=e.onWrite;if(typeof t!=="function")throw new Error("Missing onWrite function");this._onWrite=e=>{t(e)};const n=e.onError;if(typeof n!=="function")throw new Error("Missing onError function");this._onError=e=>{n(e)};const o=e.debug;this._debug=typeof o==="function"?e=>{o(e)}:undefined;const f=e.onHeader;this._onHeader=typeof f==="function"?(...e)=>{f(...e)}:noop;const u=e.onPacket;this._onPacket=typeof u==="function"?()=>{u()}:noop;let l=e.onHandshakeComplete;if(typeof l!=="function")l=noop;this._onHandshakeComplete=(...e)=>{this._debug&&this._debug("Handshake completed");const t=this._queue;if(t){this._queue=undefined;this._debug&&this._debug(`Draining outbound queue (${t.length}) ...`);for(let e=0;e<t.length;++e){const n=t[e];let r=this._packetRW.write.finalize(n);if(r===n){const e=this._cipher.allocPacket(n.length);e.set(n,5);r=e}R(this,r)}this._debug&&this._debug("... finished draining outbound queue")}l(...e)};this._queue=undefined;const h=e.messageHandlers;if(typeof h==="object"&&h!==null)this._handlers=h;else this._handlers={};this._onPayload=onPayload.bind(this);this._server=!!e.server;this._banner=undefined;let p;if(this._server){if(typeof e.hostKeys!=="object"||e.hostKeys===null)throw new Error("Missing server host key(s)");this._hostKeys=e.hostKeys;if(typeof e.greeting==="string"&&e.greeting.length){p=e.greeting.slice(-2)==="\r\n"?e.greeting:`${e.greeting}\r\n`}if(typeof e.banner==="string"&&e.banner.length){this._banner=e.banner.slice(-2)==="\r\n"?e.banner:`${e.banner}\r\n`}}else{this._hostKeys=undefined}let E=e.offer;if(typeof E!=="object"||E===null)E=g;else if(E.constructor!==_)E=new _(E);this._kex=undefined;this._kexinit=undefined;this._offer=E;this._cipher=new s(0,this._onWrite);this._decipher=undefined;this._skipNextInboundPacket=false;this._packetRW={read:new v,write:new O(this)};this._hostVerifier=!this._server&&typeof e.hostVerifier==="function"?e.hostVerifier:undefined;this._parse=parseHeader;this._buffer=undefined;this._authsQueue=[];this._authenticated=false;this._remoteIdentRaw=undefined;let y;if(typeof e.ident==="string"){this._identRaw=Buffer.from(`SSH-2.0-${e.ident}`);y=Buffer.allocUnsafe(this._identRaw.length+2);y.set(this._identRaw,0);y[y.length-2]=13;y[y.length-1]=10}else if(Buffer.isBuffer(e.ident)){const t=Buffer.allocUnsafe(8+e.ident.length);t.latin1Write("SSH-2.0-",0,8);t.set(e.ident,8);this._identRaw=t;y=Buffer.allocUnsafe(t.length+2);y.set(t,0);y[y.length-2]=13;y[y.length-1]=10}else{this._identRaw=D;y=Q}this._compatFlags=0;if(this._debug){if(i)this._debug("Custom crypto binding available");else this._debug("Custom crypto binding not available")}this._debug&&this._debug(`Local ident: ${r(this._identRaw.toString())}`);this.start=()=>{this.start=undefined;if(p)this._onWrite(p);this._onWrite(y)}}_destruct(e){this._packetRW.read.cleanup();this._packetRW.write.cleanup();this._cipher&&this._cipher.free();this._decipher&&this._decipher.free();if(typeof e!=="string"||e.length===0)e="fatal error";this.parse=()=>{throw new Error(`Instance unusable after ${e}`)};this._onWrite=()=>{throw new Error(`Instance unusable after ${e}`)};this._destruct=undefined}cleanup(){this._destruct&&this._destruct()}parse(e,t,n){while(t<n)t=this._parse(e,t,n)}disconnect(e){const t=1+4+4+4;let n=this._packetRW.write.allocStartKEX;const r=this._packetRW.write.alloc(t,true);const i=n+t;if(!U.has(e))e=u.PROTOCOL_ERROR;r[n]=l.DISCONNECT;B(r,e,++n);r.fill(0,n+=4,i);this._debug&&this._debug(`Outbound: Sending DISCONNECT (${e})`);R(this,this._packetRW.write.finalize(r,true),true)}ping(){const e=this._packetRW.write.allocStart;const t=this._packetRW.write.alloc(q.length);t.set(q,e);this._debug&&this._debug("Outbound: Sending ping (GLOBAL_REQUEST: keepalive@openssh.com)");R(this,this._packetRW.write.finalize(t))}rekey(){if(this._kexinit===undefined){this._debug&&this._debug("Outbound: Initiated explicit rekey");this._queue=[];E(this)}else{this._debug&&this._debug("Outbound: Ignoring rekey during handshake")}}requestSuccess(e){let t=this._packetRW.write.allocStart;let n;if(Buffer.isBuffer(e)){n=this._packetRW.write.alloc(1+e.length);n[t]=l.REQUEST_SUCCESS;n.set(e,++t)}else{n=this._packetRW.write.alloc(1);n[t]=l.REQUEST_SUCCESS}this._debug&&this._debug("Outbound: Sending REQUEST_SUCCESS");R(this,this._packetRW.write.finalize(n))}requestFailure(){const e=this._packetRW.write.allocStart;const t=this._packetRW.write.alloc(1);t[e]=l.REQUEST_FAILURE;this._debug&&this._debug("Outbound: Sending REQUEST_FAILURE");R(this,this._packetRW.write.finalize(t))}channelSuccess(e){let t=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4);n[t]=l.CHANNEL_SUCCESS;B(n,e,++t);this._debug&&this._debug(`Outbound: Sending CHANNEL_SUCCESS (r:${e})`);R(this,this._packetRW.write.finalize(n))}channelFailure(e){let t=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4);n[t]=l.CHANNEL_FAILURE;B(n,e,++t);this._debug&&this._debug(`Outbound: Sending CHANNEL_FAILURE (r:${e})`);R(this,this._packetRW.write.finalize(n))}channelEOF(e){let t=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4);n[t]=l.CHANNEL_EOF;B(n,e,++t);this._debug&&this._debug(`Outbound: Sending CHANNEL_EOF (r:${e})`);R(this,this._packetRW.write.finalize(n))}channelClose(e){let t=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4);n[t]=l.CHANNEL_CLOSE;B(n,e,++t);this._debug&&this._debug(`Outbound: Sending CHANNEL_CLOSE (r:${e})`);R(this,this._packetRW.write.finalize(n))}channelWindowAdjust(e,t){let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+4);r[n]=l.CHANNEL_WINDOW_ADJUST;B(r,e,++n);B(r,t,n+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_WINDOW_ADJUST (r:${e}, ${t})`);R(this,this._packetRW.write.finalize(r))}channelData(e,t){const n=Buffer.isBuffer(t);const r=n?t.length:Buffer.byteLength(t);let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+4+r);s[i]=l.CHANNEL_DATA;B(s,e,++i);B(s,r,i+=4);if(n)s.set(t,i+=4);else s.utf8Write(t,i+=4,r);this._debug&&this._debug(`Outbound: Sending CHANNEL_DATA (r:${e}, ${r})`);R(this,this._packetRW.write.finalize(s))}channelExtData(e,t,n){const r=Buffer.isBuffer(t);const i=r?t.length:Buffer.byteLength(t);let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+4+4+i);o[s]=l.CHANNEL_EXTENDED_DATA;B(o,e,++s);B(o,n,s+=4);B(o,i,s+=4);if(r)o.set(t,s+=4);else o.utf8Write(t,s+=4,i);this._debug&&this._debug(`Outbound: Sending CHANNEL_EXTENDED_DATA (r:${e})`);R(this,this._packetRW.write.finalize(o))}channelOpenConfirm(e,t,n,r){let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+4+4+4);s[i]=l.CHANNEL_OPEN_CONFIRMATION;B(s,e,++i);B(s,t,i+=4);B(s,n,i+=4);B(s,r,i+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN_CONFIRMATION (r:${e}, l:${t})`);R(this,this._packetRW.write.finalize(s))}channelOpenFail(e,t,n){if(typeof n!=="string")n="";const r=Buffer.byteLength(n);let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+4+4+r+4);s[i]=l.CHANNEL_OPEN_FAILURE;B(s,e,++i);B(s,t,i+=4);B(s,r,i+=4);i+=4;if(r){s.utf8Write(n,i,r);i+=r}B(s,0,i);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN_FAILURE (r:${e})`);R(this,this._packetRW.write.finalize(s))}service(e){if(this._server)throw new Error("Client-only method called in server mode");const t=Buffer.byteLength(e);let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+t);r[n]=l.SERVICE_REQUEST;B(r,t,++n);r.utf8Write(e,n+=4,t);this._debug&&this._debug(`Outbound: Sending SERVICE_REQUEST (${e})`);R(this,this._packetRW.write.finalize(r))}authPassword(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const r=Buffer.byteLength(e);const i=Buffer.byteLength(t);const s=n?Buffer.byteLength(n):0;let o=this._packetRW.write.allocStart;const f=this._packetRW.write.alloc(1+4+r+4+14+4+8+1+4+i+(n?4+s:0));f[o]=l.USERAUTH_REQUEST;B(f,r,++o);f.utf8Write(e,o+=4,r);B(f,14,o+=r);f.utf8Write("ssh-connection",o+=4,14);B(f,8,o+=14);f.utf8Write("password",o+=4,8);f[o+=8]=n?1:0;B(f,i,++o);if(Buffer.isBuffer(t))b(t,f,0,i,o+=4);else f.utf8Write(t,o+=4,i);if(n){B(f,s,o+=i);if(Buffer.isBuffer(n))b(n,f,0,s,o+=4);else f.utf8Write(n,o+=4,s);this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (changed password)")}else{this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (password)")}this._authsQueue.push("password");R(this,this._packetRW.write.finalize(f))}authPK(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");t=m(t);if(t instanceof Error)throw new Error("Invalid key");const r=t.type;t=t.getPublicSSH();const i=Buffer.byteLength(e);const s=Buffer.byteLength(r);const o=t.length;const f=this._kex.sessionID;const u=f.length;const h=(n?4+u:0)+1+4+i+4+14+4+9+1+4+s+4+o;let p;let g;if(n){p=Buffer.allocUnsafe(h);g=0;B(p,u,g);p.set(f,g+=4);g+=u}else{p=this._packetRW.write.alloc(h);g=this._packetRW.write.allocStart}p[g]=l.USERAUTH_REQUEST;B(p,i,++g);p.utf8Write(e,g+=4,i);B(p,14,g+=i);p.utf8Write("ssh-connection",g+=4,14);B(p,9,g+=14);p.utf8Write("publickey",g+=4,9);p[g+=9]=n?1:0;B(p,s,++g);p.utf8Write(r,g+=4,s);B(p,o,g+=s);p.set(t,g+=4);if(!n){this._authsQueue.push("publickey");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (publickey -- check)");R(this,this._packetRW.write.finalize(p));return}n(p,(n=>{n=k(n,r);if(n===false)throw new Error("Error while converting handshake signature");const f=n.length;g=this._packetRW.write.allocStart;p=this._packetRW.write.alloc(1+4+i+4+14+4+9+1+4+s+4+o+4+4+s+4+f);p[g]=l.USERAUTH_REQUEST;B(p,i,++g);p.utf8Write(e,g+=4,i);B(p,14,g+=i);p.utf8Write("ssh-connection",g+=4,14);B(p,9,g+=14);p.utf8Write("publickey",g+=4,9);p[g+=9]=1;B(p,s,++g);p.utf8Write(r,g+=4,s);B(p,o,g+=s);p.set(t,g+=4);B(p,4+s+4+f,g+=o);B(p,s,g+=4);p.utf8Write(r,g+=4,s);B(p,f,g+=s);p.set(n,g+=4);this._authsQueue.push("publickey");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (publickey)");R(this,this._packetRW.write.finalize(p))}))}authHostbased(e,t,n,r,i){if(this._server)throw new Error("Client-only method called in server mode");t=m(t);if(t instanceof Error)throw new Error("Invalid key");const s=t.type;t=t.getPublicSSH();const o=Buffer.byteLength(e);const f=Buffer.byteLength(s);const u=t.length;const h=this._kex.sessionID;const p=h.length;const g=Buffer.byteLength(n);const _=Buffer.byteLength(r);const E=Buffer.allocUnsafe(4+p+1+4+o+4+14+4+9+4+f+4+u+4+g+4+_);let y=0;B(E,p,y);E.set(h,y+=4);E[y+=p]=l.USERAUTH_REQUEST;B(E,o,++y);E.utf8Write(e,y+=4,o);B(E,14,y+=o);E.utf8Write("ssh-connection",y+=4,14);B(E,9,y+=14);E.utf8Write("hostbased",y+=4,9);B(E,f,y+=9);E.utf8Write(s,y+=4,f);B(E,u,y+=f);E.set(t,y+=4);B(E,g,y+=u);E.utf8Write(n,y+=4,g);B(E,_,y+=g);E.utf8Write(r,y+=4,_);i(E,(e=>{e=k(e,s);if(!e)throw new Error("Error while converting handshake signature");const t=e.length;const n=E.length-p-4;y=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(n+4+4+f+4+t);b(E,r,4+p,E.length,y);B(r,4+f+4+t,y+=n);B(r,f,y+=4);r.utf8Write(s,y+=4,f);B(r,t,y+=f);r.set(e,y+=4);this._authsQueue.push("hostbased");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (hostbased)");R(this,this._packetRW.write.finalize(r))}))}authKeyboard(e){if(this._server)throw new Error("Client-only method called in server mode");const t=Buffer.byteLength(e);let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+t+4+14+4+20+4+4);r[n]=l.USERAUTH_REQUEST;B(r,t,++n);r.utf8Write(e,n+=4,t);B(r,14,n+=t);r.utf8Write("ssh-connection",n+=4,14);B(r,20,n+=14);r.utf8Write("keyboard-interactive",n+=4,20);B(r,0,n+=20);B(r,0,n+=4);this._authsQueue.push("keyboard-interactive");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (keyboard-interactive)");R(this,this._packetRW.write.finalize(r))}authNone(e){if(this._server)throw new Error("Client-only method called in server mode");const t=Buffer.byteLength(e);let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+t+4+14+4+4);r[n]=l.USERAUTH_REQUEST;B(r,t,++n);r.utf8Write(e,n+=4,t);B(r,14,n+=t);r.utf8Write("ssh-connection",n+=4,14);B(r,4,n+=14);r.utf8Write("none",n+=4,4);this._authsQueue.push("none");this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (none)");R(this,this._packetRW.write.finalize(r))}authInfoRes(e){if(this._server)throw new Error("Client-only method called in server mode");let t=0;let n;if(e){n=new Array(e.length);for(let r=0;r<e.length;++r){const i=Buffer.byteLength(e[r]);n[r]=i;t+=4+i}}let r=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+t);i[r]=l.USERAUTH_INFO_RESPONSE;if(e){B(i,e.length,++r);r+=4;for(let t=0;t<e.length;++t){const s=n[t];B(i,s,r);r+=4;if(s){i.utf8Write(e[t],r,s);r+=s}}}else{B(i,0,++r)}this._debug&&this._debug("Outbound: Sending USERAUTH_INFO_RESPONSE");R(this,this._packetRW.write.finalize(i))}tcpipForward(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const r=Buffer.byteLength(e);let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+13+1+4+r+4);s[i]=l.GLOBAL_REQUEST;B(s,13,++i);s.utf8Write("tcpip-forward",i+=4,13);s[i+=13]=n===undefined||n===true?1:0;B(s,r,++i);s.utf8Write(e,i+=4,r);B(s,t,i+=r);this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (tcpip-forward)");R(this,this._packetRW.write.finalize(s))}cancelTcpipForward(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const r=Buffer.byteLength(e);let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+20+1+4+r+4);s[i]=l.GLOBAL_REQUEST;B(s,20,++i);s.utf8Write("cancel-tcpip-forward",i+=4,20);s[i+=20]=n===undefined||n===true?1:0;B(s,r,++i);s.utf8Write(e,i+=4,r);B(s,t,i+=r);this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (cancel-tcpip-forward)");R(this,this._packetRW.write.finalize(s))}openssh_streamLocalForward(e,t){if(this._server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+31+1+4+n);i[r]=l.GLOBAL_REQUEST;B(i,31,++r);i.utf8Write("streamlocal-forward@openssh.com",r+=4,31);i[r+=31]=t===undefined||t===true?1:0;B(i,n,++r);i.utf8Write(e,r+=4,n);this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (streamlocal-forward@openssh.com)");R(this,this._packetRW.write.finalize(i))}openssh_cancelStreamLocalForward(e,t){if(this._server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+38+1+4+n);i[r]=l.GLOBAL_REQUEST;B(i,38,++r);i.utf8Write("cancel-streamlocal-forward@openssh.com",r+=4,38);i[r+=38]=t===undefined||t===true?1:0;B(i,n,++r);i.utf8Write(e,r+=4,n);if(this._debug){this._debug("Outbound: Sending GLOBAL_REQUEST "+"(cancel-streamlocal-forward@openssh.com)")}R(this,this._packetRW.write.finalize(i))}directTcpip(e,t,n,r){if(this._server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(r.srcIP);const s=Buffer.byteLength(r.dstIP);let o=this._packetRW.write.allocStart;const f=this._packetRW.write.alloc(1+4+12+4+4+4+4+i+4+4+s+4);f[o]=l.CHANNEL_OPEN;B(f,12,++o);f.utf8Write("direct-tcpip",o+=4,12);B(f,e,o+=12);B(f,t,o+=4);B(f,n,o+=4);B(f,s,o+=4);f.utf8Write(r.dstIP,o+=4,s);B(f,r.dstPort,o+=s);B(f,i,o+=4);f.utf8Write(r.srcIP,o+=4,i);B(f,r.srcPort,o+=i);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, direct-tcpip)`);R(this,this._packetRW.write.finalize(f))}openssh_directStreamLocal(e,t,n,r){if(this._server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(r.socketPath);let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+30+4+4+4+4+i+4+4);o[s]=l.CHANNEL_OPEN;B(o,30,++s);o.utf8Write("direct-streamlocal@openssh.com",s+=4,30);B(o,e,s+=30);B(o,t,s+=4);B(o,n,s+=4);B(o,i,s+=4);o.utf8Write(r.socketPath,s+=4,i);w(o,0,s+=i,s+8);if(this._debug){this._debug("Outbound: Sending CHANNEL_OPEN "+`(r:${e}, direct-streamlocal@openssh.com)`)}R(this,this._packetRW.write.finalize(o))}openssh_noMoreSessions(e){if(this._server)throw new Error("Client-only method called in server mode");let t=this._packetRW.write.allocStart;const n=this._packetRW.write.alloc(1+4+28+1);n[t]=l.GLOBAL_REQUEST;B(n,28,++t);n.utf8Write("no-more-sessions@openssh.com",t+=4,28);n[t+=28]=e===undefined||e===true?1:0;this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (no-more-sessions@openssh.com)");R(this,this._packetRW.write.finalize(n))}session(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");let r=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+7+4+4+4);i[r]=l.CHANNEL_OPEN;B(i,7,++r);i.utf8Write("session",r+=4,7);B(i,e,r+=7);B(i,t,r+=4);B(i,n,r+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, session)`);R(this,this._packetRW.write.finalize(i))}windowChange(e,t,n,r,i){if(this._server)throw new Error("Client-only method called in server mode");let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+4+13+1+4+4+4+4);o[s]=l.CHANNEL_REQUEST;B(o,e,++s);B(o,13,s+=4);o.utf8Write("window-change",s+=4,13);o[s+=13]=0;B(o,n,++s);B(o,t,s+=4);B(o,i,s+=4);B(o,r,s+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, window-change)`);R(this,this._packetRW.write.finalize(o))}pty(e,t,n,r,i,s,o,f){if(this._server)throw new Error("Client-only method called in server mode");if(!s||!s.length)s="vt100";if(o&&!Buffer.isBuffer(o)&&!Array.isArray(o)&&typeof o==="object"&&o!==null){o=modesToBytes(o)}if(!o||!o.length)o=G;const u=s.length;const h=o.length;let p=this._packetRW.write.allocStart;const g=this._packetRW.write.alloc(1+4+4+7+1+4+u+4+4+4+4+4+h);g[p]=l.CHANNEL_REQUEST;B(g,e,++p);B(g,7,p+=4);g.utf8Write("pty-req",p+=4,7);g[p+=7]=f===undefined||f===true?1:0;B(g,u,++p);g.utf8Write(s,p+=4,u);B(g,n,p+=u);B(g,t,p+=4);B(g,i,p+=4);B(g,r,p+=4);B(g,h,p+=4);p+=4;if(Array.isArray(o)){for(let e=0;e<h;++e)g[p++]=o[e]}else if(Buffer.isBuffer(o)){g.set(o,p)}this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, pty-req)`);R(this,this._packetRW.write.finalize(g))}shell(e,t){if(this._server)throw new Error("Client-only method called in server mode");let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+4+5+1);r[n]=l.CHANNEL_REQUEST;B(r,e,++n);B(r,5,n+=4);r.utf8Write("shell",n+=4,5);r[n+=5]=t===undefined||t===true?1:0;this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, shell)`);R(this,this._packetRW.write.finalize(r))}exec(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const r=Buffer.isBuffer(t);const i=r?t.length:Buffer.byteLength(t);let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+4+4+1+4+i);o[s]=l.CHANNEL_REQUEST;B(o,e,++s);B(o,4,s+=4);o.utf8Write("exec",s+=4,4);o[s+=4]=n===undefined||n===true?1:0;B(o,i,++s);if(r)o.set(t,s+=4);else o.utf8Write(t,s+=4,i);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, exec: ${t})`);R(this,this._packetRW.write.finalize(o))}signal(e,t){if(this._server)throw new Error("Client-only method called in server mode");const n=t;t=t.toUpperCase();if(t.slice(0,3)==="SIG")t=t.slice(3);if(h[t]!==1)throw new Error(`Invalid signal: ${n}`);const r=t.length;let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+4+6+1+4+r);s[i]=l.CHANNEL_REQUEST;B(s,e,++i);B(s,6,i+=4);s.utf8Write("signal",i+=4,6);s[i+=6]=0;B(s,r,++i);s.utf8Write(t,i+=4,r);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, signal: ${t})`);R(this,this._packetRW.write.finalize(s))}env(e,t,n,r){if(this._server)throw new Error("Client-only method called in server mode");const i=Buffer.byteLength(t);const s=Buffer.isBuffer(n);const o=s?n.length:Buffer.byteLength(n);let f=this._packetRW.write.allocStart;const u=this._packetRW.write.alloc(1+4+4+3+1+4+i+4+o);u[f]=l.CHANNEL_REQUEST;B(u,e,++f);B(u,3,f+=4);u.utf8Write("env",f+=4,3);u[f+=3]=r===undefined||r===true?1:0;B(u,i,++f);u.utf8Write(t,f+=4,i);B(u,o,f+=i);if(s)u.set(n,f+=4);else u.utf8Write(n,f+=4,o);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, env: ${t}=${n})`);R(this,this._packetRW.write.finalize(u))}x11Forward(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const r=t.protocol;const i=t.cookie;const s=Buffer.isBuffer(r);const o=s?r.length:Buffer.byteLength(r);const f=Buffer.isBuffer(i);const u=f?i.length:Buffer.byteLength(i);let h=this._packetRW.write.allocStart;const p=this._packetRW.write.alloc(1+4+4+7+1+1+4+o+4+u+4);p[h]=l.CHANNEL_REQUEST;B(p,e,++h);B(p,7,h+=4);p.utf8Write("x11-req",h+=4,7);p[h+=7]=n===undefined||n===true?1:0;p[++h]=t.single?1:0;B(p,o,++h);if(s)p.set(r,h+=4);else p.utf8Write(r,h+=4,o);B(p,u,h+=o);if(f)p.set(i,h+=4);else p.latin1Write(i,h+=4,u);B(p,t.screen||0,h+=u);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, x11-req)`);R(this,this._packetRW.write.finalize(p))}subsystem(e,t,n){if(this._server)throw new Error("Client-only method called in server mode");const r=Buffer.byteLength(t);let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+4+9+1+4+r);s[i]=l.CHANNEL_REQUEST;B(s,e,++i);B(s,9,i+=4);s.utf8Write("subsystem",i+=4,9);s[i+=9]=n===undefined||n===true?1:0;B(s,r,++i);s.utf8Write(t,i+=4,r);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, subsystem: ${t})`);R(this,this._packetRW.write.finalize(s))}openssh_agentForward(e,t){if(this._server)throw new Error("Client-only method called in server mode");let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+4+26+1);r[n]=l.CHANNEL_REQUEST;B(r,e,++n);B(r,26,n+=4);r.utf8Write("auth-agent-req@openssh.com",n+=4,26);r[n+=26]=t===undefined||t===true?1:0;if(this._debug){this._debug("Outbound: Sending CHANNEL_REQUEST "+`(r:${e}, auth-agent-req@openssh.com)`)}R(this,this._packetRW.write.finalize(r))}openssh_hostKeysProve(e){if(this._server)throw new Error("Client-only method called in server mode");let t=0;const n=[];for(const r of e){const e=r.getPublicSSH();t+=4+e.length;n.push(e)}let r=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+29+1+t);i[r]=l.GLOBAL_REQUEST;B(i,29,++r);i.utf8Write("hostkeys-prove-00@openssh.com",r+=4,29);i[r+=29]=1;++r;for(const e of n){B(i,e.length,r);b(e,i,0,e.length,r+=4);r+=e.length}if(this._debug){this._debug("Outbound: Sending GLOBAL_REQUEST (hostkeys-prove-00@openssh.com)")}R(this,this._packetRW.write.finalize(i))}serviceAccept(e){if(!this._server)throw new Error("Server-only method called in client mode");const t=Buffer.byteLength(e);let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+t);r[n]=l.SERVICE_ACCEPT;B(r,t,++n);r.utf8Write(e,n+=4,t);this._debug&&this._debug(`Outbound: Sending SERVICE_ACCEPT (${e})`);R(this,this._packetRW.write.finalize(r));if(this._server&&this._banner&&e==="ssh-userauth"){const e=this._banner;this._banner=undefined;const t=Buffer.byteLength(e);n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+t+4);r[n]=l.USERAUTH_BANNER;B(r,t,++n);r.utf8Write(e,n+=4,t);B(r,0,n+=t);this._debug&&this._debug("Outbound: Sending USERAUTH_BANNER");R(this,this._packetRW.write.finalize(r))}}forwardedTcpip(e,t,n,r){if(!this._server)throw new Error("Server-only method called in client mode");const i=Buffer.byteLength(r.boundAddr);const s=Buffer.byteLength(r.remoteAddr);let o=this._packetRW.write.allocStart;const f=this._packetRW.write.alloc(1+4+15+4+4+4+4+i+4+4+s+4);f[o]=l.CHANNEL_OPEN;B(f,15,++o);f.utf8Write("forwarded-tcpip",o+=4,15);B(f,e,o+=15);B(f,t,o+=4);B(f,n,o+=4);B(f,i,o+=4);f.utf8Write(r.boundAddr,o+=4,i);B(f,r.boundPort,o+=i);B(f,s,o+=4);f.utf8Write(r.remoteAddr,o+=4,s);B(f,r.remotePort,o+=s);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, forwarded-tcpip)`);R(this,this._packetRW.write.finalize(f))}x11(e,t,n,r){if(!this._server)throw new Error("Server-only method called in client mode");const i=Buffer.byteLength(r.originAddr);let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+3+4+4+4+4+i+4);o[s]=l.CHANNEL_OPEN;B(o,3,++s);o.utf8Write("x11",s+=4,3);B(o,e,s+=3);B(o,t,s+=4);B(o,n,s+=4);B(o,i,s+=4);o.utf8Write(r.originAddr,s+=4,i);B(o,r.originPort,s+=i);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, x11)`);R(this,this._packetRW.write.finalize(o))}openssh_authAgent(e,t,n){if(!this._server)throw new Error("Server-only method called in client mode");let r=this._packetRW.write.allocStart;const i=this._packetRW.write.alloc(1+4+22+4+4+4);i[r]=l.CHANNEL_OPEN;B(i,22,++r);i.utf8Write("auth-agent@openssh.com",r+=4,22);B(i,e,r+=22);B(i,t,r+=4);B(i,n,r+=4);this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${e}, auth-agent@openssh.com)`);R(this,this._packetRW.write.finalize(i))}openssh_forwardedStreamLocal(e,t,n,r){if(!this._server)throw new Error("Server-only method called in client mode");const i=Buffer.byteLength(r.socketPath);let s=this._packetRW.write.allocStart;const o=this._packetRW.write.alloc(1+4+33+4+4+4+4+i+4);o[s]=l.CHANNEL_OPEN;B(o,33,++s);o.utf8Write("forwarded-streamlocal@openssh.com",s+=4,33);B(o,e,s+=33);B(o,t,s+=4);B(o,n,s+=4);B(o,i,s+=4);o.utf8Write(r.socketPath,s+=4,i);B(o,0,s+=i);if(this._debug){this._debug("Outbound: Sending CHANNEL_OPEN "+`(r:${e}, forwarded-streamlocal@openssh.com)`)}R(this,this._packetRW.write.finalize(o))}exitStatus(e,t){if(!this._server)throw new Error("Server-only method called in client mode");let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+4+11+1+4);r[n]=l.CHANNEL_REQUEST;B(r,e,++n);B(r,11,n+=4);r.utf8Write("exit-status",n+=4,11);r[n+=11]=0;B(r,t,++n);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, exit-status: ${t})`);R(this,this._packetRW.write.finalize(r))}exitSignal(e,t,n,r){if(!this._server)throw new Error("Server-only method called in client mode");const i=t;if(typeof i!=="string"||!i)throw new Error(`Invalid signal: ${i}`);let s=t.toUpperCase();if(s.slice(0,3)==="SIG")s=s.slice(3);if(h[s]!==1)throw new Error(`Invalid signal: ${i}`);const o=Buffer.byteLength(s);const f=r?Buffer.byteLength(r):0;let u=this._packetRW.write.allocStart;const p=this._packetRW.write.alloc(1+4+4+11+1+4+o+1+4+f+4);p[u]=l.CHANNEL_REQUEST;B(p,e,++u);B(p,11,u+=4);p.utf8Write("exit-signal",u+=4,11);p[u+=11]=0;B(p,o,++u);p.utf8Write(s,u+=4,o);p[u+=o]=n?1:0;B(p,f,++u);u+=4;if(f){p.utf8Write(r,u,f);u+=f}B(p,0,u);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${e}, exit-signal: ${t})`);R(this,this._packetRW.write.finalize(p))}authFailure(e,t){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0)throw new Error("No auth in progress");let n;if(typeof e==="boolean"){t=e;e=undefined}if(e){n=[];for(let t=0;t<e.length;++t){if(e[t].toLowerCase()==="none")continue;n.push(e[t])}n=n.join(",")}else{n=""}const r=n.length;let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+r+1);s[i]=l.USERAUTH_FAILURE;B(s,r,++i);s.utf8Write(n,i+=4,r);s[i+=r]=t===true?1:0;this._authsQueue.shift();this._debug&&this._debug("Outbound: Sending USERAUTH_FAILURE");R(this,this._packetRW.write.finalize(s))}authSuccess(){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0)throw new Error("No auth in progress");const e=this._packetRW.write.allocStart;const t=this._packetRW.write.alloc(1);t[e]=l.USERAUTH_SUCCESS;this._authsQueue.shift();this._authenticated=true;this._debug&&this._debug("Outbound: Sending USERAUTH_SUCCESS");R(this,this._packetRW.write.finalize(t));if(this._kex.negotiated.cs.compress==="zlib@openssh.com")this._packetRW.read=new T;if(this._kex.negotiated.sc.compress==="zlib@openssh.com")this._packetRW.write=new P(this)}authPKOK(e,t){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0||this._authsQueue[0]!=="publickey")throw new Error('"publickey" auth not in progress');const n=Buffer.byteLength(e);const r=t.length;let i=this._packetRW.write.allocStart;const s=this._packetRW.write.alloc(1+4+n+4+r);s[i]=l.USERAUTH_PK_OK;B(s,n,++i);s.utf8Write(e,i+=4,n);B(s,r,i+=n);s.set(t,i+=4);this._authsQueue.shift();this._debug&&this._debug("Outbound: Sending USERAUTH_PK_OK");R(this,this._packetRW.write.finalize(s))}authPasswdChg(e){if(!this._server)throw new Error("Server-only method called in client mode");const t=Buffer.byteLength(e);let n=this._packetRW.write.allocStart;const r=this._packetRW.write.alloc(1+4+t+4);r[n]=l.USERAUTH_PASSWD_CHANGEREQ;B(r,t,++n);r.utf8Write(e,n+=4,t);B(r,0,n+=t);this._debug&&this._debug("Outbound: Sending USERAUTH_PASSWD_CHANGEREQ");R(this,this._packetRW.write.finalize(r))}authInfoReq(e,t,n){if(!this._server)throw new Error("Server-only method called in client mode");let r=0;const i=e?Buffer.byteLength(e):0;const s=t?Buffer.byteLength(t):0;for(let e=0;e<n.length;++e)r+=4+Buffer.byteLength(n[e].prompt)+1;let o=this._packetRW.write.allocStart;const f=this._packetRW.write.alloc(1+4+i+4+s+4+4+r);f[o]=l.USERAUTH_INFO_REQUEST;B(f,i,++o);o+=4;if(e){f.utf8Write(e,o,i);o+=i}B(f,s,o);o+=4;if(t){f.utf8Write(t,o,s);o+=s}B(f,0,o);B(f,n.length,o+=4);o+=4;for(let e=0;e<n.length;++e){const t=n[e];const r=Buffer.byteLength(t.prompt);B(f,r,o);o+=4;if(r){f.utf8Write(t.prompt,o,r);o+=r}f[o++]=t.echo?1:0}this._debug&&this._debug("Outbound: Sending USERAUTH_INFO_REQUEST");R(this,this._packetRW.write.finalize(f))}}const $=/^SSH-(2\.0|1\.99)-([^ ]+)(?: (.*))?$/;function parseHeader(e,t,n){let i;let s;if(this._buffer){i=Buffer.allocUnsafe(this._buffer.length+(n-t));i.set(this._buffer,0);if(t===0){i.set(e,this._buffer.length)}else{i.set(new Uint8Array(e.buffer,e.byteOffset+t,n-t),this._buffer.length)}s=this._buffer.length;t=0}else{i=e;s=0}const f=t;let u=t;let l=t;let h=false;let p=0;let g=0;for(;t<i.length;++t){const e=i[t];if(e===13){h=true;continue}if(e===10){if(l>u&&l-u>4&&i[u]===83&&i[u+1]===83&&i[u+2]===72&&i[u+3]===45){const e=i.latin1Slice(f,l+1);const h=u===f?e:e.slice(u-f);const p=$.exec(h);if(!p)throw new Error("Invalid identification string");const g={greeting:u===f?"":e.slice(0,u-f),identRaw:h,versions:{protocol:p[1],software:p[2]},comments:p[3]};this._remoteIdentRaw=Buffer.from(h);this._debug&&this._debug(`Remote ident: ${r(h)}`);this._compatFlags=getCompatFlags(g);this._buffer=undefined;this._decipher=new o(0,y.bind(this,{firstPacket:true}));this._parse=parsePacket;this._onHeader(g);if(!this._destruct){return n}E(this);return t+1-s}if(this._server)throw new Error("Greetings from clients not permitted");if(++g>W)throw new Error("Max greeting lines exceeded");h=false;u=t+1;p=0}else if(h){throw new Error("Invalid header: expected newline")}else if(++p>=x){throw new Error("Header line too long")}l=t}if(!this._buffer)this._buffer=C(i,f);return t-s}function parsePacket(e,t,n){return this._decipher.decrypt(e,t,n)}function onPayload(e){this._onPacket();if(e.length===0){this._debug&&this._debug("Inbound: Skipping empty packet payload");return}e=this._packetRW.read.read(e);const t=e[0];if(t===l.USERAUTH_SUCCESS&&!this._server&&!this._authenticated){this._authenticated=true;if(this._kex.negotiated.cs.compress==="zlib@openssh.com")this._packetRW.write=new P(this);if(this._kex.negotiated.sc.compress==="zlib@openssh.com")this._packetRW.read=new T}const n=I[t];if(n===undefined){this._debug&&this._debug(`Inbound: Unsupported message type: ${t}`);return}return n(this,e)}function getCompatFlags(e){const t=e.versions.software;let n=0;for(const e of f){if(typeof e[0]==="string"){if(t===e[0])n|=e[1]}else if(e[0].test(t)){n|=e[1]}}return n}function modesToBytes(e){const t=Object.keys(e);const n=Buffer.allocUnsafe(5*t.length+1);let r=0;for(let i=0;i<t.length;++i){const s=t[i];if(s==="TTY_OP_END")continue;const o=p[s];if(o===undefined)continue;const f=e[s];if(typeof f==="number"&&isFinite(f)){n[r++]=o;n[r++]=f>>>24;n[r++]=f>>>16;n[r++]=f>>>8;n[r++]=f}}n[r++]=p.TTY_OP_END;if(r<n.length)return C(n,0,r);return n}e.exports=Protocol},2026:(e,t,n)=>{"use strict";const r=n(2361);const i=n(7147);const{constants:s}=i;const{Readable:o,Writable:f}=n(2781);const{inherits:u,isDate:l}=n(3837);const h=Buffer[Symbol.species];const{bufferCopy:p,bufferSlice:g,makeBufferParser:_,writeUInt32BE:E}=n(9475);const y={SIZE:1,UIDGID:2,PERMISSIONS:4,ACMODTIME:8,EXTENDED:2147483648};const m=Buffer.alloc(28);const I={OK:0,EOF:1,NO_SUCH_FILE:2,PERMISSION_DENIED:3,FAILURE:4,BAD_MESSAGE:5,NO_CONNECTION:6,CONNECTION_LOST:7,OP_UNSUPPORTED:8};const b=new Map(Object.values(I).map((e=>[e,1])));const w={[I.OK]:"No error",[I.EOF]:"End of file",[I.NO_SUCH_FILE]:"No such file or directory",[I.PERMISSION_DENIED]:"Permission denied",[I.FAILURE]:"Failure",[I.BAD_MESSAGE]:"Bad message",[I.NO_CONNECTION]:"No connection",[I.CONNECTION_LOST]:"Connection lost",[I.OP_UNSUPPORTED]:"Operation unsupported"};const C={INIT:1,OPEN:3,CLOSE:4,READ:5,WRITE:6,LSTAT:7,FSTAT:8,SETSTAT:9,FSETSTAT:10,OPENDIR:11,READDIR:12,REMOVE:13,MKDIR:14,RMDIR:15,REALPATH:16,STAT:17,RENAME:18,READLINK:19,SYMLINK:20,EXTENDED:200};const k={VERSION:2,STATUS:101,HANDLE:102,DATA:103,NAME:104,ATTRS:105,EXTENDED:201};const R={READ:1,WRITE:2,APPEND:4,CREAT:8,TRUNC:16,EXCL:32};const B=2*1024;const v=2**32-1;const O=Buffer.from([0,0,0,5,C.INIT,0,0,0,3]);const T=Buffer.from([0,0,0,5,k.VERSION,0,0,0,3]);const P=/^SSH-2.0-(?:OpenSSH|dropbear)/;const L=256*1024;const U=_();const D={readable:false,writable:false,push:e=>{},once:()=>{},on:()=>{},emit:()=>{},end:()=>{}};function noop(){}class SFTP extends r{constructor(e,t,n){super();if(typeof n!=="object"||!n)n={};const r=e._protocol._remoteIdentRaw;this.server=!!n.server;this._debug=typeof n.debug==="function"?n.debug:undefined;this._isOpenSSH=r&&P.test(r);this._version=-1;this._extensions={};this._biOpt=n.biOpt;this._pktLenBytes=0;this._pktLen=0;this._pktPos=0;this._pktType=0;this._pktData=undefined;this._writeReqid=-1;this._requests={};this._maxInPktLen=L;this._maxOutPktLen=34e3;this._maxReadLen=(this._isOpenSSH?L:34e3)-B;this._maxWriteLen=(this._isOpenSSH?L:34e3)-B;this.maxOpenHandles=undefined;this._client=e;this._protocol=e._protocol;this._callbacks=[];this._hasX11=false;this._exit={code:undefined,signal:undefined,dump:undefined,desc:undefined};this._waitWindow=false;this._chunkcb=undefined;this._buffer=[];this.type=t.type;this.subtype=undefined;this.incoming=t.incoming;this.outgoing=t.outgoing;this.stderr=D;this.readable=true}push(e){if(e===null){cleanupRequests(this);if(!this.readable)return;this.readable=false;this.emit("end");return}let t=0;while(t<e.length){if(this._pktLenBytes<4){let n=Math.min(4-this._pktLenBytes,e.length-t);this._pktLenBytes+=n;while(n--)this._pktLen=(this._pktLen<<8)+e[t++];if(this._pktLenBytes<4)return;if(this._pktLen===0)return doFatalSFTPError(this,"Invalid packet length");if(this._pktLen>this._maxInPktLen){const e=this._maxInPktLen;return doFatalSFTPError(this,`Packet length ${this._pktLen} exceeds max length of ${e}`)}if(t>=e.length)return}if(this._pktPos<this._pktLen){const n=Math.min(this._pktLen-this._pktPos,e.length-t);if(t!==0||n!==e.length){if(n===this._pktLen){this._pkt=new h(e.buffer,e.byteOffset+t,n)}else{if(!this._pkt)this._pkt=Buffer.allocUnsafe(this._pktLen);this._pkt.set(new Uint8Array(e.buffer,e.byteOffset+t,n),this._pktPos)}}else if(n===this._pktLen){this._pkt=e}else{if(!this._pkt)this._pkt=Buffer.allocUnsafe(this._pktLen);this._pkt.set(e,this._pktPos)}t+=n;this._pktPos+=n;if(this._pktPos<this._pktLen)return}const n=this._pkt[0];const r=this._pkt;this._pktLen=0;this._pktLenBytes=0;this._pkt=undefined;this._pktPos=0;const i=this.server?q[n]:W[n];if(!i)return doFatalSFTPError(this,`Unknown packet type ${n}`);if(this._version===-1){if(this.server){if(n!==C.INIT)return doFatalSFTPError(this,`Expected INIT packet, got ${n}`)}else if(n!==k.VERSION){return doFatalSFTPError(this,`Expected VERSION packet, got ${n}`)}}if(i(this,r)===false)return}}end(){this.destroy()}destroy(){if(this.outgoing.state==="open"||this.outgoing.state==="eof"){this.outgoing.state="closing";this._protocol.channelClose(this.outgoing.id)}}_init(){this._init=noop;if(!this.server)sendOrBuffer(this,O)}createReadStream(e,t){if(this.server)throw new Error("Client-only method called in server mode");return new ReadStream(this,e,t)}createWriteStream(e,t){if(this.server)throw new Error("Client-only method called in server mode");return new WriteStream(this,e,t)}open(e,t,n,r){if(this.server)throw new Error("Client-only method called in server mode");if(typeof n==="function"){r=n;n=undefined}const i=typeof t==="number"?t:stringToFlags(t);if(i===null)throw new Error(`Unknown flags string: ${t}`);let s=0;let o=0;if(typeof n==="string"||typeof n==="number")n={mode:n};if(typeof n==="object"&&n!==null){n=attrsToBytes(n);s=n.flags;o=n.nb}const f=Buffer.byteLength(e);let u=9;const l=Buffer.allocUnsafe(4+1+4+4+f+4+4+o);E(l,l.length-4,0);l[4]=C.OPEN;const h=this._writeReqid=this._writeReqid+1&v;E(l,h,5);E(l,f,u);l.utf8Write(e,u+=4,f);E(l,i,u+=f);E(l,s,u+=4);if(o){u+=4;if(o===m.length)l.set(m,u);else p(m,l,0,o,u);u+=o}this._requests[h]={cb:r};const g=sendOrBuffer(this,l);this._debug&&this._debug(`SFTP: Outbound: ${g?"Buffered":"Sending"} OPEN`)}close(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");const n=e.length;let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.CLOSE;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.set(e,r+=4);this._requests[s]={cb:t};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} CLOSE`)}read(e,t,n,r,i,s){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(t))throw new Error("buffer is not a Buffer");if(n>=t.length)throw new Error("offset is out of bounds");if(n+r>t.length)throw new Error("length extends beyond buffer");if(i===null)throw new Error("null position currently unsupported");read_(this,e,t,n,r,i,s)}readData(e,t,n,r,i,s){this.read(e,t,n,r,i,s)}write(e,t,n,r,i,s){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(t))throw new Error("buffer is not a Buffer");if(n>t.length)throw new Error("offset is out of bounds");if(n+r>t.length)throw new Error("length extends beyond buffer");if(i===null)throw new Error("null position currently unsupported");if(!r){s&&process.nextTick(s,undefined,0);return}const o=this._maxWriteLen;const f=Math.max(r-o,0);const u=i;if(f)r=o;const l=e.length;let h=9;const g=Buffer.allocUnsafe(4+1+4+4+l+8+4+r);E(g,g.length-4,0);g[4]=C.WRITE;const _=this._writeReqid=this._writeReqid+1&v;E(g,_,5);E(g,l,h);g.set(e,h+=4);h+=l;for(let e=7;e>=0;--e){g[h+e]=i&255;i/=256}E(g,r,h+=8);p(t,g,n,n+r,h+=4);this._requests[_]={cb:i=>{if(i){if(typeof s==="function")s(i)}else if(f){this.write(e,t,n+r,f,u+r,s)}else if(typeof s==="function"){s(undefined,n+r)}}};const y=sendOrBuffer(this,g);if(this._debug){const e=y?"Sent":"Buffered";this._debug(`SFTP: Outbound: ${e} WRITE (id:${_})`)}}writeData(e,t,n,r,i,s){this.write(e,t,n,r,i,s)}fastGet(e,t,n,r){if(this.server)throw new Error("Client-only method called in server mode");fastXfer(this,i,e,t,n,r)}fastPut(e,t,n,r){if(this.server)throw new Error("Client-only method called in server mode");fastXfer(i,this,e,t,n,r)}readFile(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");let r;if(typeof n==="function"){r=n}else if(typeof t==="function"){r=t;t=undefined}if(typeof t==="string")t={encoding:t,flag:"r"};else if(!t)t={encoding:null,flag:"r"};else if(typeof t!=="object")throw new TypeError("Bad arguments");const i=t.encoding;if(i&&!Buffer.isEncoding(i))throw new Error(`Unknown encoding: ${i}`);let s;let o;let f;let u=0;let l;let h=0;const p=t.flag||"r";const read=()=>{if(s===0){o=Buffer.allocUnsafe(8192);this.read(l,o,0,8192,h,afterRead)}else{this.read(l,o,u,s-u,h,afterRead)}};const afterRead=(e,t)=>{let n;if(e){n=e.code===I.EOF;if(!n){return this.close(l,(()=>r&&r(e)))}}else{n=false}if(n||s===0&&t===0)return close();h+=t;u+=t;if(s!==0){if(u===s)close();else read()}else{f.push(g(o,0,t));read()}};afterRead._wantEOFError=true;const close=()=>{this.close(l,(e=>{if(s===0){o=Buffer.concat(f,u)}else if(u<s){o=g(o,0,u)}if(i)o=o.toString(i);return r&&r(e,o)}))};this.open(e,p,438,((t,n)=>{if(t)return r&&r(t);l=n;const tryStat=(t,n)=>{if(t){this.stat(e,((e,n)=>{if(e){return this.close(l,(()=>{r&&r(t)}))}tryStat(null,n)}));return}s=n.size||0;if(s===0){f=[];return read()}o=Buffer.allocUnsafe(s);read()};this.fstat(l,tryStat)}))}writeFile(e,t,n,r){if(this.server)throw new Error("Client-only method called in server mode");let i;if(typeof r==="function"){i=r}else if(typeof n==="function"){i=n;n=undefined}if(typeof n==="string")n={encoding:n,mode:438,flag:"w"};else if(!n)n={encoding:"utf8",mode:438,flag:"w"};else if(typeof n!=="object")throw new TypeError("Bad arguments");if(n.encoding&&!Buffer.isEncoding(n.encoding))throw new Error(`Unknown encoding: ${n.encoding}`);const s=n.flag||"w";this.open(e,s,n.mode,((r,o)=>{if(r){i&&i(r)}else{const r=Buffer.isBuffer(t)?t:Buffer.from(""+t,n.encoding||"utf8");const f=/a/.test(s)?null:0;if(f===null){const tryStat=(t,n)=>{if(t){this.stat(e,((e,n)=>{if(e){return this.close(o,(()=>{i&&i(t)}))}tryStat(null,n)}));return}writeAll(this,o,r,0,r.length,n.size,i)};this.fstat(o,tryStat);return}writeAll(this,o,r,0,r.length,f,i)}}))}appendFile(e,t,n,r){if(this.server)throw new Error("Client-only method called in server mode");let i;if(typeof r==="function"){i=r}else if(typeof n==="function"){i=n;n=undefined}if(typeof n==="string")n={encoding:n,mode:438,flag:"a"};else if(!n)n={encoding:"utf8",mode:438,flag:"a"};else if(typeof n!=="object")throw new TypeError("Bad arguments");if(!n.flag)n=Object.assign({flag:"a"},n);this.writeFile(e,t,n,i)}exists(e,t){if(this.server)throw new Error("Client-only method called in server mode");this.stat(e,(e=>{t&&t(e?false:true)}))}unlink(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.REMOVE;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.utf8Write(e,r+=4,n);this._requests[s]={cb:t};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} REMOVE`)}rename(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");const r=Buffer.byteLength(e);const i=Buffer.byteLength(t);let s=9;const o=Buffer.allocUnsafe(4+1+4+4+r+4+i);E(o,o.length-4,0);o[4]=C.RENAME;const f=this._writeReqid=this._writeReqid+1&v;E(o,f,5);E(o,r,s);o.utf8Write(e,s+=4,r);E(o,i,s+=r);o.utf8Write(t,s+=4,i);this._requests[f]={cb:n};const u=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} RENAME`)}mkdir(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");let r=0;let i=0;if(typeof t==="function"){n=t;t=undefined}if(typeof t==="object"&&t!==null){t=attrsToBytes(t);r=t.flags;i=t.nb}const s=Buffer.byteLength(e);let o=9;const f=Buffer.allocUnsafe(4+1+4+4+s+4+i);E(f,f.length-4,0);f[4]=C.MKDIR;const u=this._writeReqid=this._writeReqid+1&v;E(f,u,5);E(f,s,o);f.utf8Write(e,o+=4,s);E(f,r,o+=s);if(i){o+=4;if(i===m.length)f.set(m,o);else p(m,f,0,i,o);o+=i}this._requests[u]={cb:n};const l=sendOrBuffer(this,f);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} MKDIR`)}rmdir(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.RMDIR;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.utf8Write(e,r+=4,n);this._requests[s]={cb:t};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} RMDIR`)}readdir(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");if(typeof t==="function"){n=t;t={}}if(typeof t!=="object"||t===null)t={};const r=t&&t.full?false:true;if(!Buffer.isBuffer(e)&&typeof e!=="string")throw new Error("missing directory handle or path");if(typeof e==="string"){const r=[];let i=0;const reread=(e,s)=>{if(e)return n(e);this.readdir(s,t,((e,t)=>{const o=e&&e.code===I.EOF;if(e&&!o)return this.close(s,(()=>n(e)));if(o){return this.close(s,(e=>{if(e)return n(e);n(undefined,r)}))}for(let e=0;e<t.length;++e,++i)r[i]=t[e];reread(undefined,s)}))};return this.opendir(e,reread)}const i=e.length;let s=9;const o=Buffer.allocUnsafe(4+1+4+4+i);E(o,o.length-4,0);o[4]=C.READDIR;const f=this._writeReqid=this._writeReqid+1&v;E(o,f,5);E(o,i,s);o.set(e,s+=4);this._requests[f]={cb:r?(e,t)=>{if(typeof n!=="function")return;if(e)return n(e);for(let e=t.length-1;e>=0;--e){if(t[e].filename==="."||t[e].filename==="..")t.splice(e,1)}n(undefined,t)}:n};const u=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} READDIR`)}fstat(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");const n=e.length;let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.FSTAT;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.set(e,r+=4);this._requests[s]={cb:t};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} FSTAT`)}stat(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.STAT;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.utf8Write(e,r+=4,n);this._requests[s]={cb:t};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} STAT`)}lstat(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.LSTAT;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.utf8Write(e,r+=4,n);this._requests[s]={cb:t};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} LSTAT`)}opendir(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.OPENDIR;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.utf8Write(e,r+=4,n);this._requests[s]={cb:t};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} OPENDIR`)}setstat(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");let r=0;let i=0;if(typeof t==="object"&&t!==null){t=attrsToBytes(t);r=t.flags;i=t.nb}else if(typeof t==="function"){n=t}const s=Buffer.byteLength(e);let o=9;const f=Buffer.allocUnsafe(4+1+4+4+s+4+i);E(f,f.length-4,0);f[4]=C.SETSTAT;const u=this._writeReqid=this._writeReqid+1&v;E(f,u,5);E(f,s,o);f.utf8Write(e,o+=4,s);E(f,r,o+=s);if(i){o+=4;if(i===m.length)f.set(m,o);else p(m,f,0,i,o);o+=i}this._requests[u]={cb:n};const l=sendOrBuffer(this,f);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} SETSTAT`)}fsetstat(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");let r=0;let i=0;if(typeof t==="object"&&t!==null){t=attrsToBytes(t);r=t.flags;i=t.nb}else if(typeof t==="function"){n=t}const s=e.length;let o=9;const f=Buffer.allocUnsafe(4+1+4+4+s+4+i);E(f,f.length-4,0);f[4]=C.FSETSTAT;const u=this._writeReqid=this._writeReqid+1&v;E(f,u,5);E(f,s,o);f.set(e,o+=4);E(f,r,o+=s);if(i){o+=4;if(i===m.length)f.set(m,o);else p(m,f,0,i,o);o+=i}this._requests[u]={cb:n};const l=sendOrBuffer(this,f);this._debug&&this._debug(`SFTP: Outbound: ${l?"Buffered":"Sending"} FSETSTAT`)}futimes(e,t,n,r){return this.fsetstat(e,{atime:toUnixTimestamp(t),mtime:toUnixTimestamp(n)},r)}utimes(e,t,n,r){return this.setstat(e,{atime:toUnixTimestamp(t),mtime:toUnixTimestamp(n)},r)}fchown(e,t,n,r){return this.fsetstat(e,{uid:t,gid:n},r)}chown(e,t,n,r){return this.setstat(e,{uid:t,gid:n},r)}fchmod(e,t,n){return this.fsetstat(e,{mode:t},n)}chmod(e,t,n){return this.setstat(e,{mode:t},n)}readlink(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.READLINK;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.utf8Write(e,r+=4,n);this._requests[s]={cb:(e,n)=>{if(typeof t!=="function")return;if(e)return t(e);if(!n||!n.length)return t(new Error("Response missing link info"));t(undefined,n[0].filename)}};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} READLINK`)}symlink(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");const r=Buffer.byteLength(t);const i=Buffer.byteLength(e);let s=9;const o=Buffer.allocUnsafe(4+1+4+4+r+4+i);E(o,o.length-4,0);o[4]=C.SYMLINK;const f=this._writeReqid=this._writeReqid+1&v;E(o,f,5);if(this._isOpenSSH){E(o,i,s);o.utf8Write(e,s+=4,i);E(o,r,s+=i);o.utf8Write(t,s+=4,r)}else{E(o,r,s);o.utf8Write(t,s+=4,r);E(o,i,s+=r);o.utf8Write(e,s+=4,i)}this._requests[f]={cb:n};const u=sendOrBuffer(this,o);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} SYMLINK`)}realpath(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=Buffer.byteLength(e);let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=C.REALPATH;const s=this._writeReqid=this._writeReqid+1&v;E(i,s,5);E(i,n,r);i.utf8Write(e,r+=4,n);this._requests[s]={cb:(e,n)=>{if(typeof t!=="function")return;if(e)return t(e);if(!n||!n.length)return t(new Error("Response missing path info"));t(undefined,n[0].filename)}};const o=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} REALPATH`)}ext_openssh_rename(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");const r=this._extensions["posix-rename@openssh.com"];if(!r||r!=="1")throw new Error("Server does not support this extended request");const i=Buffer.byteLength(e);const s=Buffer.byteLength(t);let o=9;const f=Buffer.allocUnsafe(4+1+4+4+24+4+i+4+s);E(f,f.length-4,0);f[4]=C.EXTENDED;const u=this._writeReqid=this._writeReqid+1&v;E(f,u,5);E(f,24,o);f.utf8Write("posix-rename@openssh.com",o+=4,24);E(f,i,o+=24);f.utf8Write(e,o+=4,i);E(f,s,o+=i);f.utf8Write(t,o+=4,s);this._requests[u]={cb:n};const l=sendOrBuffer(this,f);if(this._debug){const e=l?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} posix-rename@openssh.com`)}}ext_openssh_statvfs(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["statvfs@openssh.com"];if(!n||n!=="2")throw new Error("Server does not support this extended request");const r=Buffer.byteLength(e);let i=9;const s=Buffer.allocUnsafe(4+1+4+4+19+4+r);E(s,s.length-4,0);s[4]=C.EXTENDED;const o=this._writeReqid=this._writeReqid+1&v;E(s,o,5);E(s,19,i);s.utf8Write("statvfs@openssh.com",i+=4,19);E(s,r,i+=19);s.utf8Write(e,i+=4,r);this._requests[o]={extended:"statvfs@openssh.com",cb:t};const f=sendOrBuffer(this,s);if(this._debug){const e=f?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} statvfs@openssh.com`)}}ext_openssh_fstatvfs(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["fstatvfs@openssh.com"];if(!n||n!=="2")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");const r=e.length;let i=9;const s=Buffer.allocUnsafe(4+1+4+4+20+4+r);E(s,s.length-4,0);s[4]=C.EXTENDED;const o=this._writeReqid=this._writeReqid+1&v;E(s,o,5);E(s,20,i);s.utf8Write("fstatvfs@openssh.com",i+=4,20);E(s,r,i+=20);s.set(e,i+=4);this._requests[o]={extended:"fstatvfs@openssh.com",cb:t};const f=sendOrBuffer(this,s);if(this._debug){const e=f?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} fstatvfs@openssh.com`)}}ext_openssh_hardlink(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");const r=this._extensions["hardlink@openssh.com"];if(r!=="1")throw new Error("Server does not support this extended request");const i=Buffer.byteLength(e);const s=Buffer.byteLength(t);let o=9;const f=Buffer.allocUnsafe(4+1+4+4+20+4+i+4+s);E(f,f.length-4,0);f[4]=C.EXTENDED;const u=this._writeReqid=this._writeReqid+1&v;E(f,u,5);E(f,20,o);f.utf8Write("hardlink@openssh.com",o+=4,20);E(f,i,o+=20);f.utf8Write(e,o+=4,i);E(f,s,o+=i);f.utf8Write(t,o+=4,s);this._requests[u]={cb:n};const l=sendOrBuffer(this,f);if(this._debug){const e=l?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} hardlink@openssh.com`)}}ext_openssh_fsync(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["fsync@openssh.com"];if(n!=="1")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");const r=e.length;let i=9;const s=Buffer.allocUnsafe(4+1+4+4+17+4+r);E(s,s.length-4,0);s[4]=C.EXTENDED;const o=this._writeReqid=this._writeReqid+1&v;E(s,o,5);E(s,17,i);s.utf8Write("fsync@openssh.com",i+=4,17);E(s,r,i+=17);s.set(e,i+=4);this._requests[o]={cb:t};const f=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} fsync@openssh.com`)}ext_openssh_lsetstat(e,t,n){if(this.server)throw new Error("Client-only method called in server mode");const r=this._extensions["lsetstat@openssh.com"];if(r!=="1")throw new Error("Server does not support this extended request");let i=0;let s=0;if(typeof t==="object"&&t!==null){t=attrsToBytes(t);i=t.flags;s=t.nb}else if(typeof t==="function"){n=t}const o=Buffer.byteLength(e);let f=9;const u=Buffer.allocUnsafe(4+1+4+4+20+4+o+4+s);E(u,u.length-4,0);u[4]=C.EXTENDED;const l=this._writeReqid=this._writeReqid+1&v;E(u,l,5);E(u,20,f);u.utf8Write("lsetstat@openssh.com",f+=4,20);E(u,o,f+=20);u.utf8Write(e,f+=4,o);E(u,i,f+=o);if(s){f+=4;if(s===m.length)u.set(m,f);else p(m,u,0,s,f);f+=s}this._requests[l]={cb:n};const h=sendOrBuffer(this,u);if(this._debug){const e=h?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} lsetstat@openssh.com`)}}ext_openssh_expandPath(e,t){if(this.server)throw new Error("Client-only method called in server mode");const n=this._extensions["expand-path@openssh.com"];if(n!=="1")throw new Error("Server does not support this extended request");const r=Buffer.byteLength(e);let i=9;const s=Buffer.allocUnsafe(4+1+4+4+23+4+r);E(s,s.length-4,0);s[4]=C.EXTENDED;const o=this._writeReqid=this._writeReqid+1&v;E(s,o,5);E(s,23,i);s.utf8Write("expand-path@openssh.com",i+=4,23);E(s,r,i+=20);s.utf8Write(e,i+=4,r);this._requests[o]={cb:t};const f=sendOrBuffer(this,s);if(this._debug){const e=f?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} expand-path@openssh.com`)}}ext_copy_data(e,t,n,r,i,s){if(this.server)throw new Error("Client-only method called in server mode");const o=this._extensions["copy-data"];if(o!=="1")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("Source handle is not a Buffer");if(!Buffer.isBuffer(r))throw new Error("Destination handle is not a Buffer");let f=0;const u=Buffer.allocUnsafe(4+1+4+4+9+4+e.length+8+8+4+r.length+8);E(u,u.length-4,f);f+=4;u[f]=C.EXTENDED;++f;const l=this._writeReqid=this._writeReqid+1&v;E(u,l,f);f+=4;E(u,9,f);f+=4;u.utf8Write("copy-data",f,9);f+=9;E(u,e.length,f);f+=4;u.set(e,f);f+=e.length;for(let e=7;e>=0;--e){u[f+e]=t&255;t/=256}f+=8;for(let e=7;e>=0;--e){u[f+e]=n&255;n/=256}f+=8;E(u,r.length,f);f+=4;u.set(r,f);f+=r.length;for(let e=7;e>=0;--e){u[f+e]=i&255;i/=256}this._requests[l]={cb:s};const h=sendOrBuffer(this,u);if(this._debug){const e=h?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${e} copy-data`)}}handle(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");const n=t.length;if(n>256)throw new Error("handle too large (> 256 bytes)");let r=9;const i=Buffer.allocUnsafe(4+1+4+4+n);E(i,i.length-4,0);i[4]=k.HANDLE;E(i,e,5);E(i,n,r);if(n)i.set(t,r+=4);const s=sendOrBuffer(this,i);this._debug&&this._debug(`SFTP: Outbound: ${s?"Buffered":"Sending"} HANDLE`)}status(e,t,n){if(!this.server)throw new Error("Server-only method called in client mode");if(!b.has(t))throw new Error(`Bad status code: ${t}`);n||(n="");const r=Buffer.byteLength(n);let i=9;const s=Buffer.allocUnsafe(4+1+4+4+4+r+4);E(s,s.length-4,0);s[4]=k.STATUS;E(s,e,5);E(s,t,i);E(s,r,i+=4);i+=4;if(r){s.utf8Write(n,i,r);i+=r}E(s,0,i);const o=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} STATUS`)}data(e,t,n){if(!this.server)throw new Error("Server-only method called in client mode");const r=Buffer.isBuffer(t);if(!r&&typeof t!=="string")throw new Error("data is not a Buffer or string");let i;if(!r&&!n){n=undefined;i=true}const s=r?t.length:Buffer.byteLength(t,n);let o=9;const f=Buffer.allocUnsafe(4+1+4+4+s);E(f,f.length-4,0);f[4]=k.DATA;E(f,e,5);E(f,s,o);if(s){if(r)f.set(t,o+=4);else if(i)f.utf8Write(t,o+=4,s);else f.write(t,o+=4,s,n)}const u=sendOrBuffer(this,f);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} DATA`)}name(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(!Array.isArray(t)){if(typeof t!=="object"||t===null)throw new Error("names is not an object or array");t=[t]}const n=t.length;let r=0;let i;const s=[];for(let e=0;e<n;++e){const n=t[e];const o=!n||!n.filename||typeof n.filename!=="string"?"":n.filename;r+=4+Buffer.byteLength(o);const f=!n||!n.longname||typeof n.longname!=="string"?"":n.longname;r+=4+Buffer.byteLength(f);if(typeof n.attrs==="object"&&n.attrs!==null){i=attrsToBytes(n.attrs);r+=4+i.nb;if(i.nb){let e;if(i.nb===m.length){e=new Uint8Array(m)}else{e=new Uint8Array(i.nb);p(m,e,0,i.nb,0)}i.bytes=e}s.push(i)}else{r+=4;s.push(null)}}let o=9;const f=Buffer.allocUnsafe(4+1+4+4+r);E(f,f.length-4,0);f[4]=k.NAME;E(f,e,5);E(f,n,o);o+=4;for(let e=0;e<n;++e){const n=t[e];{const e=!n||!n.filename||typeof n.filename!=="string"?"":n.filename;const t=Buffer.byteLength(e);E(f,t,o);o+=4;if(t){f.utf8Write(e,o,t);o+=t}}{const e=!n||!n.longname||typeof n.longname!=="string"?"":n.longname;const t=Buffer.byteLength(e);E(f,t,o);o+=4;if(t){f.utf8Write(e,o,t);o+=t}}const r=s[e];if(r){E(f,r.flags,o);o+=4;if(r.flags&&r.bytes){f.set(r.bytes,o);o+=r.nb}}else{E(f,0,o);o+=4}}const u=sendOrBuffer(this,f);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} NAME`)}attrs(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(typeof t!=="object"||t===null)throw new Error("attrs is not an object");t=attrsToBytes(t);const n=t.flags;const r=t.nb;let i=9;const s=Buffer.allocUnsafe(4+1+4+4+r);E(s,s.length-4,0);s[4]=k.ATTRS;E(s,e,5);E(s,n,i);if(r){i+=4;if(r===m.length)s.set(m,i);else p(m,s,0,r,i);i+=r}const o=sendOrBuffer(this,s);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} ATTRS`)}}function tryCreateBuffer(e){try{return Buffer.allocUnsafe(e)}catch(e){return e}}function read_(e,t,n,r,i,s,o,f){const u=e._maxReadLen;const l=Math.max(i-u,0);if(l)i=u;const h=t.length;let p=9;let _=s;const y=Buffer.allocUnsafe(4+1+4+4+h+8+4);E(y,y.length-4,0);y[4]=C.READ;const m=e._writeReqid=e._writeReqid+1&v;E(y,m,5);E(y,h,p);y.set(t,p+=4);p+=h;for(let e=7;e>=0;--e){y[p+e]=_&255;_/=256}E(y,i,p+=8);if(typeof o!=="function")o=noop;const b=f||{nb:0,position:s,off:r,origOff:r,len:undefined,overflow:undefined,cb:(r,i,s)=>{const f=b.len;const u=b.overflow;if(r){if(o._wantEOFError||r.code!==I.EOF)return o(r)}else if(s>f){return o(new Error("Received more data than requested"))}else if(s===f&&u){b.nb+=s;b.position+=s;b.off+=s;read_(e,t,n,b.off,u,b.position,o,b);return}s=s||0;if(b.origOff===0&&n.length===b.nb)i=n;else i=g(n,b.origOff,b.origOff+b.nb+s);o(undefined,b.nb+s,i,b.position)},buffer:undefined};b.len=i;b.overflow=l;b.buffer=g(n,r,r+i);e._requests[m]=b;const w=sendOrBuffer(e,y);e._debug&&e._debug(`SFTP: Outbound: ${w?"Buffered":"Sending"} READ`)}function fastXfer(e,t,n,r,s,o){let f=64;let u=32768;let l;let h;let p;if(typeof s==="function"){o=s}else if(typeof s==="object"&&s!==null){if(typeof s.concurrency==="number"&&s.concurrency>0&&!isNaN(s.concurrency)){f=s.concurrency}if(typeof s.chunkSize==="number"&&s.chunkSize>0&&!isNaN(s.chunkSize)){u=s.chunkSize}if(typeof s.fileSize==="number"&&s.fileSize>0&&!isNaN(s.fileSize)){p=s.fileSize}if(typeof s.step==="function")l=s.step;if(typeof s.mode==="string"||typeof s.mode==="number")h=modeNum(s.mode)}let g;let _=0;let E=0;let y=false;let m;let I;let b;let w=u*f;function onerror(n){if(y)return;y=true;let r=0;let s;if(m||I){s=()=>{if(--r===0)o(n)};if(m&&(e===i||e.outgoing.state==="open"))++r;if(I&&(t===i||t.outgoing.state==="open"))++r;if(m&&(e===i||e.outgoing.state==="open"))e.close(m,s);if(I&&(t===i||t.outgoing.state==="open"))t.close(I,s)}else{o(n)}}e.open(n,"r",((s,y)=>{if(s)return onerror(s);m=y;if(p===undefined)e.fstat(m,tryStat);else tryStat(null,{size:p});function tryStat(s,p){if(s){if(e!==i){e.stat(n,((e,t)=>{if(e)return onerror(s);tryStat(null,t)}));return}return onerror(s)}g=p.size;t.open(r,"w",((n,i)=>{if(n)return onerror(n);I=i;if(g<=0)return onerror();while(w>g){if(f===1){w=g;break}w-=u;--f}b=tryCreateBuffer(w);if(b instanceof Error)return onerror(b);if(h!==undefined){t.fchmod(I,h,(function tryAgain(e){if(e){t.chmod(r,h,(e=>tryAgain()));return}startReads()}))}else{startReads()}function onread(n,r,i,s,f,h){if(n)return onerror(n);f=f||0;t.write(I,b,f,r,s,writeCb);function writeCb(n){if(n)return onerror(n);E+=r;l&&l(E,r,g);if(r<h)return singleRead(f,s+r,h-r);if(E===g){t.close(I,(t=>{I=undefined;if(t)return onerror(t);e.close(m,(e=>{m=undefined;if(e)return onerror(e);o()}))}));return}if(_>=g)return;const i=_+u>g?g-_:u;singleRead(f,_,i);_+=i}}function makeCb(e,t,n){return(r,i,s)=>{onread(r,i,s,t,e,n)}}function singleRead(t,n,r){e.read(m,b,t,r,n,makeCb(t,n,r))}function startReads(){let e=0;let t=0;while(_<g&&e<f){const n=_+u>g?g-_:u;singleRead(t,_,n);t+=n;_+=n;++e}}}))}}))}function writeAll(e,t,n,r,i,s,o){const f=typeof o==="function"?o:undefined;e.write(t,n,r,i,s,((o,u)=>{if(o){return e.close(t,(()=>{f&&f(o)}))}if(u===i){e.close(t,f)}else{r+=u;i-=u;s+=u;writeAll(e,t,n,r,i,s,f)}}))}class Stats{constructor(e){this.mode=e&&e.mode;this.uid=e&&e.uid;this.gid=e&&e.gid;this.size=e&&e.size;this.atime=e&&e.atime;this.mtime=e&&e.mtime;this.extended=e&&e.extended}isDirectory(){return(this.mode&s.S_IFMT)===s.S_IFDIR}isFile(){return(this.mode&s.S_IFMT)===s.S_IFREG}isBlockDevice(){return(this.mode&s.S_IFMT)===s.S_IFBLK}isCharacterDevice(){return(this.mode&s.S_IFMT)===s.S_IFCHR}isSymbolicLink(){return(this.mode&s.S_IFMT)===s.S_IFLNK}isFIFO(){return(this.mode&s.S_IFMT)===s.S_IFIFO}isSocket(){return(this.mode&s.S_IFMT)===s.S_IFSOCK}}function attrsToBytes(e){let t=0;let n=0;if(typeof e==="object"&&e!==null){if(typeof e.size==="number"){t|=y.SIZE;const r=e.size;m[n++]=r/72057594037927940;m[n++]=r/281474976710656;m[n++]=r/1099511627776;m[n++]=r/4294967296;m[n++]=r/16777216;m[n++]=r/65536;m[n++]=r/256;m[n++]=r}if(typeof e.uid==="number"&&typeof e.gid==="number"){t|=y.UIDGID;const r=e.uid;const i=e.gid;m[n++]=r>>>24;m[n++]=r>>>16;m[n++]=r>>>8;m[n++]=r;m[n++]=i>>>24;m[n++]=i>>>16;m[n++]=i>>>8;m[n++]=i}if(typeof e.mode==="number"||typeof e.mode==="string"){const r=modeNum(e.mode);t|=y.PERMISSIONS;m[n++]=r>>>24;m[n++]=r>>>16;m[n++]=r>>>8;m[n++]=r}if((typeof e.atime==="number"||l(e.atime))&&(typeof e.mtime==="number"||l(e.mtime))){const r=toUnixTimestamp(e.atime);const i=toUnixTimestamp(e.mtime);t|=y.ACMODTIME;m[n++]=r>>>24;m[n++]=r>>>16;m[n++]=r>>>8;m[n++]=r;m[n++]=i>>>24;m[n++]=i>>>16;m[n++]=i>>>8;m[n++]=i}}return{flags:t,nb:n}}function toUnixTimestamp(e){if(typeof e==="number"&&e===e)return e;if(l(e))return parseInt(e.getTime()/1e3,10);throw new Error(`Cannot parse time: ${e}`)}function modeNum(e){if(typeof e==="number"&&e===e)return e;if(typeof e==="string")return modeNum(parseInt(e,8));throw new Error(`Cannot parse mode: ${e}`)}const Q={r:R.READ,"r+":R.READ|R.WRITE,w:R.TRUNC|R.CREAT|R.WRITE,wx:R.TRUNC|R.CREAT|R.WRITE|R.EXCL,xw:R.TRUNC|R.CREAT|R.WRITE|R.EXCL,"w+":R.TRUNC|R.CREAT|R.READ|R.WRITE,"wx+":R.TRUNC|R.CREAT|R.READ|R.WRITE|R.EXCL,"xw+":R.TRUNC|R.CREAT|R.READ|R.WRITE|R.EXCL,a:R.APPEND|R.CREAT|R.WRITE,ax:R.APPEND|R.CREAT|R.WRITE|R.EXCL,xa:R.APPEND|R.CREAT|R.WRITE|R.EXCL,"a+":R.APPEND|R.CREAT|R.READ|R.WRITE,"ax+":R.APPEND|R.CREAT|R.READ|R.WRITE|R.EXCL,"xa+":R.APPEND|R.CREAT|R.READ|R.WRITE|R.EXCL};function stringToFlags(e){const t=Q[e];return t!==undefined?t:null}const x=(()=>{const e=Object.keys(Q);return t=>{for(let n=0;n<e.length;++n){const r=e[n];if(Q[r]===t)return r}return null}})();function readAttrs(e){const t=U.readUInt32BE();if(t===undefined)return;const n=new Stats;if(t&y.SIZE){const t=U.readUInt64BE(e);if(t===undefined)return;n.size=t}if(t&y.UIDGID){const e=U.readUInt32BE();const t=U.readUInt32BE();if(t===undefined)return;n.uid=e;n.gid=t}if(t&y.PERMISSIONS){const e=U.readUInt32BE();if(e===undefined)return;n.mode=e}if(t&y.ACMODTIME){const e=U.readUInt32BE();const t=U.readUInt32BE();if(t===undefined)return;n.atime=e;n.mtime=t}if(t&y.EXTENDED){const e=U.readUInt32BE();if(e===undefined)return;const t={};for(let n=0;n<e;++n){const e=U.readString(true);const n=U.readString();if(n===undefined)return;t[e]=n}n.extended=t}return n}function sendOrBuffer(e,t){const n=tryWritePayload(e,t);if(n!==undefined){e._buffer.push(n);return false}return true}function tryWritePayload(e,t){const n=e.outgoing;if(n.state!=="open")return;if(n.window===0){e._waitWindow=true;e._chunkcb=drainBuffer;return t}let r;const i=t.length;let s=0;while(i-s>0&&n.window>0){const r=Math.min(i-s,n.window,n.packetSize);n.window-=r;if(n.window===0){e._waitWindow=true;e._chunkcb=drainBuffer}if(s===0&&r===i){e._protocol.channelData(e.outgoing.id,t)}else{e._protocol.channelData(e.outgoing.id,g(t,s,s+r))}s+=r}if(i-s>0){if(s>0)r=g(t,s,i);else r=t}return r}function drainBuffer(){this._chunkcb=undefined;const e=this._buffer;let t=0;while(t<e.length){const n=e[t];const r=tryWritePayload(this,n);if(r!==undefined){if(r!==n)e[t]=r;if(t>0)this._buffer=e.slice(t);return}++t}if(t>0)this._buffer=[]}function doFatalSFTPError(e,t,n){const r=new Error(t);r.level="sftp-protocol";if(!n&&e._debug)e._debug(`SFTP: Inbound: ${t}`);e.emit("error",r);e.destroy();cleanupRequests(e);return false}function cleanupRequests(e){const t=Object.keys(e._requests);if(t.length===0)return;const n=e._requests;e._requests={};const r=new Error("No response from server");for(let e=0;e<t.length;++e){const i=n[t[e]];if(typeof i.cb==="function")i.cb(r)}}function requestLimits(e,t){let n=9;const r=Buffer.allocUnsafe(4+1+4+4+18);E(r,r.length-4,0);r[4]=C.EXTENDED;const i=e._writeReqid=e._writeReqid+1&v;E(r,i,5);E(r,18,n);r.utf8Write("limits@openssh.com",n+=4,18);e._requests[i]={extended:"limits@openssh.com",cb:t};const s=sendOrBuffer(e,r);if(e._debug){const t=s?"Buffered":"Sending";e._debug(`SFTP: Outbound: ${t} limits@openssh.com`)}}const W={[k.VERSION]:(e,t)=>{if(e._version!==-1)return doFatalSFTPError(e,"Duplicate VERSION packet");const n={};U.init(t,1);let r=U.readUInt32BE();while(U.avail()){const e=U.readString(true);const t=U.readString(true);if(t===undefined){r=undefined;break}n[e]=t}U.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed VERSION packet");if(e._debug){const t=Object.keys(n);if(t.length){e._debug(`SFTP: Inbound: Received VERSION (v${r}, exts:${t})`)}else{e._debug(`SFTP: Inbound: Received VERSION (v${r})`)}}e._version=r;e._extensions=n;if(n["limits@openssh.com"]==="1"){return requestLimits(e,((t,n)=>{if(!t){if(n.maxPktLen>0)e._maxOutPktLen=n.maxPktLen;if(n.maxReadLen>0)e._maxReadLen=n.maxReadLen;if(n.maxWriteLen>0)e._maxWriteLen=n.maxWriteLen;e.maxOpenHandles=n.maxOpenHandles>0?n.maxOpenHandles:Infinity}e.emit("ready")}))}e.emit("ready")},[k.STATUS]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readUInt32BE();const i=U.readString(true);U.clear();if(e._debug){const t=JSON.stringify(i);e._debug(`SFTP: Inbound: Received STATUS (id:${n}, ${r}, ${t})`)}const s=e._requests[n];delete e._requests[n];if(s&&typeof s.cb==="function"){if(r===I.OK){s.cb();return}const e=new Error(i||w[r]||"Unknown status");e.code=r;s.cb(e)}},[k.HANDLE]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString();U.clear();if(r===undefined){if(n!==undefined)delete e._requests[n];return doFatalSFTPError(e,"Malformed HANDLE packet")}e._debug&&e._debug(`SFTP: Inbound: Received HANDLE (id:${n})`);const i=e._requests[n];delete e._requests[n];if(i&&typeof i.cb==="function")i.cb(undefined,r)},[k.DATA]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();let r;if(n!==undefined){r=e._requests[n];delete e._requests[n]}if(r&&typeof r.cb==="function"){if(r.buffer){const t=U.readString(r.buffer);U.clear();if(t!==undefined){e._debug&&e._debug(`SFTP: Inbound: Received DATA (id:${n}, ${t})`);r.cb(undefined,r.buffer,t);return}}else{const t=U.readString();U.clear();if(t!==undefined){e._debug&&e._debug(`SFTP: Inbound: Received DATA (id:${n}, ${t.length})`);r.cb(undefined,t);return}}}else{const t=U.skipString();U.clear();if(t!==undefined){e._debug&&e._debug(`SFTP: Inbound: Received DATA (id:${n}, ${t})`);return}}return doFatalSFTPError(e,"Malformed DATA packet")},[k.NAME]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();let r;if(n!==undefined){r=e._requests[n];delete e._requests[n]}const i=U.readUInt32BE();if(i!==undefined){let t=[];for(let n=0;n<i;++n){const n=U.readString(true);const r=U.readString(true);const i=readAttrs(e._biOpt);if(i===undefined){t=undefined;break}t.push({filename:n,longname:r,attrs:i})}if(t!==undefined){e._debug&&e._debug(`SFTP: Inbound: Received NAME (id:${n}, ${t.length})`);U.clear();if(r&&typeof r.cb==="function")r.cb(undefined,t);return}}U.clear();return doFatalSFTPError(e,"Malformed NAME packet")},[k.ATTRS]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();let r;if(n!==undefined){r=e._requests[n];delete e._requests[n]}const i=readAttrs(e._biOpt);U.clear();if(i!==undefined){e._debug&&e._debug(`SFTP: Inbound: Received ATTRS (id:${n})`);if(r&&typeof r.cb==="function")r.cb(undefined,i);return}return doFatalSFTPError(e,"Malformed ATTRS packet")},[k.EXTENDED]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();if(n!==undefined){const t=e._requests[n];if(t){delete e._requests[n];switch(t.extended){case"statvfs@openssh.com":case"fstatvfs@openssh.com":{const r=e._biOpt;const i={f_bsize:U.readUInt64BE(r),f_frsize:U.readUInt64BE(r),f_blocks:U.readUInt64BE(r),f_bfree:U.readUInt64BE(r),f_bavail:U.readUInt64BE(r),f_files:U.readUInt64BE(r),f_ffree:U.readUInt64BE(r),f_favail:U.readUInt64BE(r),f_sid:U.readUInt64BE(r),f_flag:U.readUInt64BE(r),f_namemax:U.readUInt64BE(r)};if(i.f_namemax===undefined)break;if(e._debug){e._debug("SFTP: Inbound: Received EXTENDED_REPLY "+`(id:${n}, ${t.extended})`)}U.clear();if(typeof t.cb==="function")t.cb(undefined,i);return}case"limits@openssh.com":{const r={maxPktLen:U.readUInt64BE(),maxReadLen:U.readUInt64BE(),maxWriteLen:U.readUInt64BE(),maxOpenHandles:U.readUInt64BE()};if(r.maxOpenHandles===undefined)break;if(e._debug){e._debug("SFTP: Inbound: Received EXTENDED_REPLY "+`(id:${n}, ${t.extended})`)}U.clear();if(typeof t.cb==="function")t.cb(undefined,r);return}default:e._debug&&e._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${n}, ???)`);U.clear();if(typeof t.cb==="function")t.cb();return}}else{e._debug&&e._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${n}, ???)`);U.clear();return}}U.clear();return doFatalSFTPError(e,"Malformed EXTENDED_REPLY packet")}};const q={[C.INIT]:(e,t)=>{if(e._version!==-1)return doFatalSFTPError(e,"Duplicate INIT packet");const n={};U.init(t,1);let r=U.readUInt32BE();while(U.avail()){const e=U.readString(true);const t=U.readString(true);if(t===undefined){r=undefined;break}n[e]=t}U.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed INIT packet");if(e._debug){const t=Object.keys(n);if(t.length){e._debug(`SFTP: Inbound: Received INIT (v${r}, exts:${t})`)}else{e._debug(`SFTP: Inbound: Received INIT (v${r})`)}}sendOrBuffer(e,T);e._version=r;e._extensions=n;e.emit("ready")},[C.OPEN]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString(true);const i=U.readUInt32BE();const s=readAttrs(e._biOpt);U.clear();if(s===undefined)return doFatalSFTPError(e,"Malformed OPEN packet");e._debug&&e._debug(`SFTP: Inbound: Received OPEN (id:${n})`);if(!e.emit("OPEN",n,r,i,s)){e.status(n,I.OP_UNSUPPORTED)}},[C.CLOSE]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString();U.clear();if(r===undefined||r.length>256)return doFatalSFTPError(e,"Malformed CLOSE packet");e._debug&&e._debug(`SFTP: Inbound: Received CLOSE (id:${n})`);if(!e.emit("CLOSE",n,r)){e.status(n,I.OP_UNSUPPORTED)}},[C.READ]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString();const i=U.readUInt64BE(e._biOpt);const s=U.readUInt32BE();U.clear();if(s===undefined||r.length>256)return doFatalSFTPError(e,"Malformed READ packet");e._debug&&e._debug(`SFTP: Inbound: Received READ (id:${n})`);if(!e.emit("READ",n,r,i,s)){e.status(n,I.OP_UNSUPPORTED)}},[C.WRITE]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString();const i=U.readUInt64BE(e._biOpt);const s=U.readString();U.clear();if(s===undefined||r.length>256)return doFatalSFTPError(e,"Malformed WRITE packet");e._debug&&e._debug(`SFTP: Inbound: Received WRITE (id:${n})`);if(!e.emit("WRITE",n,r,i,s)){e.status(n,I.OP_UNSUPPORTED)}},[C.LSTAT]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString(true);U.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed LSTAT packet");e._debug&&e._debug(`SFTP: Inbound: Received LSTAT (id:${n})`);if(!e.emit("LSTAT",n,r)){e.status(n,I.OP_UNSUPPORTED)}},[C.FSTAT]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString();U.clear();if(r===undefined||r.length>256)return doFatalSFTPError(e,"Malformed FSTAT packet");e._debug&&e._debug(`SFTP: Inbound: Received FSTAT (id:${n})`);if(!e.emit("FSTAT",n,r)){e.status(n,I.OP_UNSUPPORTED)}},[C.SETSTAT]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString(true);const i=readAttrs(e._biOpt);U.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed SETSTAT packet");e._debug&&e._debug(`SFTP: Inbound: Received SETSTAT (id:${n})`);if(!e.emit("SETSTAT",n,r,i)){e.status(n,I.OP_UNSUPPORTED)}},[C.FSETSTAT]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString();const i=readAttrs(e._biOpt);U.clear();if(i===undefined||r.length>256)return doFatalSFTPError(e,"Malformed FSETSTAT packet");e._debug&&e._debug(`SFTP: Inbound: Received FSETSTAT (id:${n})`);if(!e.emit("FSETSTAT",n,r,i)){e.status(n,I.OP_UNSUPPORTED)}},[C.OPENDIR]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString(true);U.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed OPENDIR packet");e._debug&&e._debug(`SFTP: Inbound: Received OPENDIR (id:${n})`);if(!e.emit("OPENDIR",n,r)){e.status(n,I.OP_UNSUPPORTED)}},[C.READDIR]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString();U.clear();if(r===undefined||r.length>256)return doFatalSFTPError(e,"Malformed READDIR packet");e._debug&&e._debug(`SFTP: Inbound: Received READDIR (id:${n})`);if(!e.emit("READDIR",n,r)){e.status(n,I.OP_UNSUPPORTED)}},[C.REMOVE]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString(true);U.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed REMOVE packet");e._debug&&e._debug(`SFTP: Inbound: Received REMOVE (id:${n})`);if(!e.emit("REMOVE",n,r)){e.status(n,I.OP_UNSUPPORTED)}},[C.MKDIR]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString(true);const i=readAttrs(e._biOpt);U.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed MKDIR packet");e._debug&&e._debug(`SFTP: Inbound: Received MKDIR (id:${n})`);if(!e.emit("MKDIR",n,r,i)){e.status(n,I.OP_UNSUPPORTED)}},[C.RMDIR]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString(true);U.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed RMDIR packet");e._debug&&e._debug(`SFTP: Inbound: Received RMDIR (id:${n})`);if(!e.emit("RMDIR",n,r)){e.status(n,I.OP_UNSUPPORTED)}},[C.REALPATH]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString(true);U.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed REALPATH packet");e._debug&&e._debug(`SFTP: Inbound: Received REALPATH (id:${n})`);if(!e.emit("REALPATH",n,r)){e.status(n,I.OP_UNSUPPORTED)}},[C.STAT]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString(true);U.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed STAT packet");e._debug&&e._debug(`SFTP: Inbound: Received STAT (id:${n})`);if(!e.emit("STAT",n,r)){e.status(n,I.OP_UNSUPPORTED)}},[C.RENAME]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString(true);const i=U.readString(true);U.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed RENAME packet");e._debug&&e._debug(`SFTP: Inbound: Received RENAME (id:${n})`);if(!e.emit("RENAME",n,r,i)){e.status(n,I.OP_UNSUPPORTED)}},[C.READLINK]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString(true);U.clear();if(r===undefined)return doFatalSFTPError(e,"Malformed READLINK packet");e._debug&&e._debug(`SFTP: Inbound: Received READLINK (id:${n})`);if(!e.emit("READLINK",n,r)){e.status(n,I.OP_UNSUPPORTED)}},[C.SYMLINK]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString(true);const i=U.readString(true);U.clear();if(i===undefined)return doFatalSFTPError(e,"Malformed SYMLINK packet");e._debug&&e._debug(`SFTP: Inbound: Received SYMLINK (id:${n})`);let s;if(e._isOpenSSH){s=e.emit("SYMLINK",n,i,r)}else{s=e.emit("SYMLINK",n,r,i)}if(!s){e.status(n,I.OP_UNSUPPORTED)}},[C.EXTENDED]:(e,t)=>{U.init(t,1);const n=U.readUInt32BE();const r=U.readString(true);if(r===undefined){U.clear();return doFatalSFTPError(e,"Malformed EXTENDED packet")}let i;if(U.avail())i=U.readRaw();U.clear();e._debug&&e._debug(`SFTP: Inbound: Received EXTENDED (id:${n})`);if(!e.emit("EXTENDED",n,r,i)){e.status(n,I.OP_UNSUPPORTED)}}};const{ERR_INVALID_ARG_TYPE:G,ERR_OUT_OF_RANGE:$,validateNumber:Y}=n(7609);const j=128;let V;const z=[];function allocNewPool(e){if(z.length>0)V=z.pop();else V=Buffer.allocUnsafe(e);V.used=0}function checkPosition(e,t){if(!Number.isSafeInteger(e)){Y(e,t);if(!Number.isInteger(e))throw new $(t,"an integer",e);throw new $(t,">= 0 and <= 2 ** 53 - 1",e)}if(e<0)throw new $(t,">= 0 and <= 2 ** 53 - 1",e)}function roundUpToMultipleOf8(e){return e+7&~7}function ReadStream(e,t,n){if(n===undefined)n={};else if(typeof n==="string")n={encoding:n};else if(n===null||typeof n!=="object")throw new TypeError('"options" argument must be a string or an object');else n=Object.create(n);if(n.highWaterMark===undefined)n.highWaterMark=64*1024;n.emitClose=false;n.autoDestroy=false;o.call(this,n);this.path=t;this.flags=n.flags===undefined?"r":n.flags;this.mode=n.mode===undefined?438:n.mode;this.start=n.start;this.end=n.end;this.autoClose=n.autoClose===undefined?true:n.autoClose;this.pos=0;this.bytesRead=0;this.isClosed=false;this.handle=n.handle===undefined?null:n.handle;this.sftp=e;this._opening=false;if(this.start!==undefined){checkPosition(this.start,"start");this.pos=this.start}if(this.end===undefined){this.end=Infinity}else if(this.end!==Infinity){checkPosition(this.end,"end");if(this.start!==undefined&&this.start>this.end){throw new $("start",`<= "end" (here: ${this.end})`,this.start)}}this.on("end",(function(){if(this.autoClose)this.destroy()}));if(!Buffer.isBuffer(this.handle))this.open()}u(ReadStream,o);ReadStream.prototype.open=function(){if(this._opening)return;this._opening=true;this.sftp.open(this.path,this.flags,this.mode,((e,t)=>{this._opening=false;if(e){this.emit("error",e);if(this.autoClose)this.destroy();return}this.handle=t;this.emit("open",t);this.emit("ready");this.read()}))};ReadStream.prototype._read=function(e){if(!Buffer.isBuffer(this.handle))return this.once("open",(()=>this._read(e)));if(this.destroyed)return;if(!V||V.length-V.used<j){allocNewPool(this.readableHighWaterMark||this._readableState.highWaterMark)}const t=V;let n=Math.min(V.length-V.used,e);const r=V.used;if(this.end!==undefined)n=Math.min(this.end-this.pos+1,n);if(n<=0)return this.push(null);this.sftp.read(this.handle,V,V.used,n,this.pos,((e,i)=>{if(e){this.emit("error",e);if(this.autoClose)this.destroy();return}let s=null;if(r+n===t.used&&t===V){t.used=roundUpToMultipleOf8(t.used+i-n)}else{const e=r+n&~7;const s=roundUpToMultipleOf8(r+i);if(e-s>=j)z.push(t.slice(s,e))}if(i>0){this.bytesRead+=i;s=t.slice(r,r+i)}this.pos+=i;this.push(s)}));V.used=roundUpToMultipleOf8(V.used+n)};ReadStream.prototype._destroy=function(e,t){if(this._opening&&!Buffer.isBuffer(this.handle)){this.once("open",closeStream.bind(null,this,t,e));return}closeStream(this,t,e);this.handle=null;this._opening=false};function closeStream(e,t,n){if(!e.handle)return onclose();e.sftp.close(e.handle,onclose);function onclose(r){r=r||n;t(r);e.isClosed=true;if(!r)e.emit("close")}}ReadStream.prototype.close=function(e){this.destroy(null,e)};Object.defineProperty(ReadStream.prototype,"pending",{get(){return this.handle===null},configurable:true});function WriteStream(e,t,n){if(n===undefined)n={};else if(typeof n==="string")n={encoding:n};else if(n===null||typeof n!=="object")throw new TypeError('"options" argument must be a string or an object');else n=Object.create(n);n.emitClose=false;n.autoDestroy=false;f.call(this,n);this.path=t;this.flags=n.flags===undefined?"w":n.flags;this.mode=n.mode===undefined?438:n.mode;this.start=n.start;this.autoClose=n.autoClose===undefined?true:n.autoClose;this.pos=0;this.bytesWritten=0;this.isClosed=false;this.handle=n.handle===undefined?null:n.handle;this.sftp=e;this._opening=false;if(this.start!==undefined){checkPosition(this.start,"start");this.pos=this.start}if(n.encoding)this.setDefaultEncoding(n.encoding);this.on("finish",(function(){if(this._writableState.finalCalled)return;if(this.autoClose)this.destroy()}));if(!Buffer.isBuffer(this.handle))this.open()}u(WriteStream,f);WriteStream.prototype._final=function(e){if(this.autoClose)this.destroy();e()};WriteStream.prototype.open=function(){if(this._opening)return;this._opening=true;this.sftp.open(this.path,this.flags,this.mode,((e,t)=>{this._opening=false;if(e){this.emit("error",e);if(this.autoClose)this.destroy();return}this.handle=t;const tryAgain=e=>{if(e){this.sftp.chmod(this.path,this.mode,(e=>tryAgain()));return}if(this.flags[0]==="a"){const tryStat=(e,n)=>{if(e){this.sftp.stat(this.path,((t,n)=>{if(t){this.destroy();this.emit("error",e);return}tryStat(null,n)}));return}this.pos=n.size;this.emit("open",t);this.emit("ready")};this.sftp.fstat(t,tryStat);return}this.emit("open",t);this.emit("ready")};this.sftp.fchmod(t,this.mode,tryAgain)}))};WriteStream.prototype._write=function(e,t,n){if(!Buffer.isBuffer(e)){const t=new G("data","Buffer",e);return this.emit("error",t)}if(!Buffer.isBuffer(this.handle)){return this.once("open",(function(){this._write(e,t,n)}))}this.sftp.write(this.handle,e,0,e.length,this.pos,((e,t)=>{if(e){if(this.autoClose)this.destroy();return n(e)}this.bytesWritten+=t;n()}));this.pos+=e.length};WriteStream.prototype._writev=function(e,t){if(!Buffer.isBuffer(this.handle)){return this.once("open",(function(){this._writev(e,t)}))}const n=this.sftp;const r=this.handle;let i=e.length;const onwrite=(e,n)=>{if(e){this.destroy();return t(e)}this.bytesWritten+=n;if(--i===0)t()};for(let t=0;t<e.length;++t){const i=e[t].chunk;n.write(r,i,0,i.length,this.pos,onwrite);this.pos+=i.length}};if(typeof f.prototype.destroy!=="function")WriteStream.prototype.destroy=ReadStream.prototype.destroy;WriteStream.prototype._destroy=ReadStream.prototype._destroy;WriteStream.prototype.close=function(e){if(e){if(this.isClosed){process.nextTick(e);return}this.on("close",e)}if(!this.autoClose)this.on("finish",this.destroy.bind(this));this.end()};WriteStream.prototype.destroySoon=WriteStream.prototype.end;Object.defineProperty(WriteStream.prototype,"pending",{get(){return this.handle===null},configurable:true});e.exports={flagsToString:x,OPEN_MODE:R,SFTP:SFTP,Stats:Stats,STATUS_CODE:I,stringToFlags:stringToFlags}},6832:(e,t,n)=>{"use strict";const r=n(6113);let i;try{i=n(4137)()}catch{}const{bindingAvailable:s,CIPHER_INFO:o,MAC_INFO:f}=n(5708);const u=(()=>{if(typeof r.sign==="function"&&typeof r.verify==="function"){const e="-----BEGIN PRIVATE KEY-----\r\nMC4CAQAwBQYDK2VwBCIEIHKj+sVa9WcD"+"/q2DJUJaf43Kptc8xYuUQA4bOFj9vC8T\r\n-----END PRIVATE KEY-----";const t=Buffer.from("a");let n;let i;try{n=r.sign(null,t,e);i=r.verify(null,t,e,n)}catch{}return Buffer.isBuffer(n)&&n.length===64&&i===true}return false})();const l=typeof r.diffieHellman==="function"&&typeof r.generateKeyPairSync==="function"&&typeof r.createPublicKey==="function";const h=["ecdh-sha2-nistp256","ecdh-sha2-nistp384","ecdh-sha2-nistp521","diffie-hellman-group-exchange-sha256","diffie-hellman-group14-sha256","diffie-hellman-group15-sha512","diffie-hellman-group16-sha512","diffie-hellman-group17-sha512","diffie-hellman-group18-sha512"];if(l){h.unshift("curve25519-sha256");h.unshift("curve25519-sha256@libssh.org")}const p=h.concat(["diffie-hellman-group-exchange-sha1","diffie-hellman-group14-sha1","diffie-hellman-group1-sha1"]);const g=["ecdsa-sha2-nistp256","ecdsa-sha2-nistp384","ecdsa-sha2-nistp521","rsa-sha2-512","rsa-sha2-256","ssh-rsa"];if(u)g.unshift("ssh-ed25519");const _=g.concat(["ssh-dss"]);const E=(()=>{const e=r.getCiphers();return t=>e.includes(o[t].sslName)})();let y=["aes128-gcm@openssh.com","aes256-gcm@openssh.com","aes128-ctr","aes192-ctr","aes256-ctr"];if(i&&i.flags&&!i.flags.aes){if(s)y.unshift("chacha20-poly1305@openssh.com");else y.push("chacha20-poly1305@openssh.com")}else if(s&&i&&i.arch==="x86"){y.splice(4,0,"chacha20-poly1305@openssh.com")}else{y.push("chacha20-poly1305@openssh.com")}y=y.filter(E);const m=y.concat(["aes256-cbc","aes192-cbc","aes128-cbc","blowfish-cbc","3des-cbc","aes128-gcm","aes256-gcm","arcfour256","arcfour128","cast128-cbc","arcfour"].filter(E));const I=(()=>{const e=r.getHashes();return t=>e.includes(f[t].sslName)})();const b=["hmac-sha2-256-etm@openssh.com","hmac-sha2-512-etm@openssh.com","hmac-sha1-etm@openssh.com","hmac-sha2-256","hmac-sha2-512","hmac-sha1"].filter(I);const w=b.concat(["hmac-md5","hmac-sha2-256-96","hmac-sha2-512-96","hmac-ripemd160","hmac-sha1-96","hmac-md5-96"].filter(I));const C=["none","zlib@openssh.com","zlib"];const k=C.concat([]);const R={BAD_DHGEX:1<<0,OLD_EXIT:1<<1,DYN_RPORT_BUG:1<<2,BUG_DHGEX_LARGE:1<<3};e.exports={MESSAGE:{DISCONNECT:1,IGNORE:2,UNIMPLEMENTED:3,DEBUG:4,SERVICE_REQUEST:5,SERVICE_ACCEPT:6,KEXINIT:20,NEWKEYS:21,KEXDH_INIT:30,KEXDH_REPLY:31,KEXDH_GEX_GROUP:31,KEXDH_GEX_INIT:32,KEXDH_GEX_REPLY:33,KEXDH_GEX_REQUEST:34,KEXECDH_INIT:30,KEXECDH_REPLY:31,USERAUTH_REQUEST:50,USERAUTH_FAILURE:51,USERAUTH_SUCCESS:52,USERAUTH_BANNER:53,USERAUTH_PASSWD_CHANGEREQ:60,USERAUTH_PK_OK:60,USERAUTH_INFO_REQUEST:60,USERAUTH_INFO_RESPONSE:61,GLOBAL_REQUEST:80,REQUEST_SUCCESS:81,REQUEST_FAILURE:82,CHANNEL_OPEN:90,CHANNEL_OPEN_CONFIRMATION:91,CHANNEL_OPEN_FAILURE:92,CHANNEL_WINDOW_ADJUST:93,CHANNEL_DATA:94,CHANNEL_EXTENDED_DATA:95,CHANNEL_EOF:96,CHANNEL_CLOSE:97,CHANNEL_REQUEST:98,CHANNEL_SUCCESS:99,CHANNEL_FAILURE:100},DISCONNECT_REASON:{HOST_NOT_ALLOWED_TO_CONNECT:1,PROTOCOL_ERROR:2,KEY_EXCHANGE_FAILED:3,RESERVED:4,MAC_ERROR:5,COMPRESSION_ERROR:6,SERVICE_NOT_AVAILABLE:7,PROTOCOL_VERSION_NOT_SUPPORTED:8,HOST_KEY_NOT_VERIFIABLE:9,CONNECTION_LOST:10,BY_APPLICATION:11,TOO_MANY_CONNECTIONS:12,AUTH_CANCELED_BY_USER:13,NO_MORE_AUTH_METHODS_AVAILABLE:14,ILLEGAL_USER_NAME:15},DISCONNECT_REASON_STR:undefined,CHANNEL_OPEN_FAILURE:{ADMINISTRATIVELY_PROHIBITED:1,CONNECT_FAILED:2,UNKNOWN_CHANNEL_TYPE:3,RESOURCE_SHORTAGE:4},TERMINAL_MODE:{TTY_OP_END:0,VINTR:1,VQUIT:2,VERASE:3,VKILL:4,VEOF:5,VEOL:6,VEOL2:7,VSTART:8,VSTOP:9,VSUSP:10,VDSUSP:11,VREPRINT:12,VWERASE:13,VLNEXT:14,VFLUSH:15,VSWTCH:16,VSTATUS:17,VDISCARD:18,IGNPAR:30,PARMRK:31,INPCK:32,ISTRIP:33,INLCR:34,IGNCR:35,ICRNL:36,IUCLC:37,IXON:38,IXANY:39,IXOFF:40,IMAXBEL:41,ISIG:50,ICANON:51,XCASE:52,ECHO:53,ECHOE:54,ECHOK:55,ECHONL:56,NOFLSH:57,TOSTOP:58,IEXTEN:59,ECHOCTL:60,ECHOKE:61,PENDIN:62,OPOST:70,OLCUC:71,ONLCR:72,OCRNL:73,ONOCR:74,ONLRET:75,CS7:90,CS8:91,PARENB:92,PARODD:93,TTY_OP_ISPEED:128,TTY_OP_OSPEED:129},CHANNEL_EXTENDED_DATATYPE:{STDERR:1},SIGNALS:["ABRT","ALRM","FPE","HUP","ILL","INT","QUIT","SEGV","TERM","USR1","USR2","KILL","PIPE"].reduce(((e,t)=>({...e,[t]:1})),{}),COMPAT:R,COMPAT_CHECKS:[["Cisco-1.25",R.BAD_DHGEX],[/^Cisco-1\./,R.BUG_DHGEX_LARGE],[/^[0-9.]+$/,R.OLD_EXIT],[/^OpenSSH_5\.\d+/,R.DYN_RPORT_BUG]],DEFAULT_KEX:h,SUPPORTED_KEX:p,DEFAULT_SERVER_HOST_KEY:g,SUPPORTED_SERVER_HOST_KEY:_,DEFAULT_CIPHER:y,SUPPORTED_CIPHER:m,DEFAULT_MAC:b,SUPPORTED_MAC:w,DEFAULT_COMPRESSION:C,SUPPORTED_COMPRESSION:k,curve25519Supported:l,eddsaSupported:u};e.exports.DISCONNECT_REASON_BY_VALUE=Array.from(Object.entries(e.exports.DISCONNECT_REASON)).reduce(((e,[t,n])=>({...e,[n]:t})),{})},5708:(e,t,n)=>{"use strict";const{createCipheriv:r,createDecipheriv:i,createHmac:s,randomFillSync:o,timingSafeEqual:f}=n(6113);const{readUInt32BE:u,writeUInt32BE:l}=n(9475);const h=Buffer[Symbol.species];const p=2**32-1;const g=Buffer.alloc(0);const _=Buffer.alloc(4);const E=new Map;const y=35e3;let m;let I;let b;let w;let C;let k;let R;try{m=n(9041);({AESGCMCipher:I,ChaChaPolyCipher:b,GenericCipher:w,AESGCMDecipher:C,ChaChaPolyDecipher:k,GenericDecipher:R}=m)}catch{}const B=1<<0;const v=(()=>{function info(e,t,n,r,i,s,o){return{sslName:e,blockLen:t,keyLen:n,ivLen:r!==0||o&B?r:t,authLen:i,discardLen:s,stream:!!(o&B)}}return{"chacha20-poly1305@openssh.com":info("chacha20",8,64,0,16,0,B),"aes128-gcm":info("aes-128-gcm",16,16,12,16,0,B),"aes256-gcm":info("aes-256-gcm",16,32,12,16,0,B),"aes128-gcm@openssh.com":info("aes-128-gcm",16,16,12,16,0,B),"aes256-gcm@openssh.com":info("aes-256-gcm",16,32,12,16,0,B),"aes128-cbc":info("aes-128-cbc",16,16,0,0,0,0),"aes192-cbc":info("aes-192-cbc",16,24,0,0,0,0),"aes256-cbc":info("aes-256-cbc",16,32,0,0,0,0),"rijndael-cbc@lysator.liu.se":info("aes-256-cbc",16,32,0,0,0,0),"3des-cbc":info("des-ede3-cbc",8,24,0,0,0,0),"blowfish-cbc":info("bf-cbc",8,16,0,0,0,0),"idea-cbc":info("idea-cbc",8,16,0,0,0,0),"cast128-cbc":info("cast-cbc",8,16,0,0,0,0),"aes128-ctr":info("aes-128-ctr",16,16,16,0,0,B),"aes192-ctr":info("aes-192-ctr",16,24,16,0,0,B),"aes256-ctr":info("aes-256-ctr",16,32,16,0,0,B),"3des-ctr":info("des-ede3",8,24,8,0,0,B),"blowfish-ctr":info("bf-ecb",8,16,8,0,0,B),"cast128-ctr":info("cast5-ecb",8,16,8,0,0,B),arcfour:info("rc4",8,16,0,0,1536,B),arcfour128:info("rc4",8,16,0,0,1536,B),arcfour256:info("rc4",8,32,0,0,1536,B),arcfour512:info("rc4",8,64,0,0,1536,B)}})();const O=(()=>{function info(e,t,n,r){return{sslName:e,len:t,actualLen:n,isETM:r}}return{"hmac-md5":info("md5",16,16,false),"hmac-md5-96":info("md5",16,12,false),"hmac-ripemd160":info("ripemd160",20,20,false),"hmac-sha1":info("sha1",20,20,false),"hmac-sha1-etm@openssh.com":info("sha1",20,20,true),"hmac-sha1-96":info("sha1",20,12,false),"hmac-sha2-256":info("sha256",32,32,false),"hmac-sha2-256-etm@openssh.com":info("sha256",32,32,true),"hmac-sha2-256-96":info("sha256",32,12,false),"hmac-sha2-512":info("sha512",64,64,false),"hmac-sha2-512-etm@openssh.com":info("sha512",64,64,true),"hmac-sha2-512-96":info("sha512",64,12,false)}})();class NullCipher{constructor(e,t){this.outSeqno=e;this._onWrite=t;this._dead=false}free(){this._dead=true}allocPacket(e){let t=4+1+e;let n=8-(t&8-1);if(n<4)n+=8;t+=n;const r=Buffer.allocUnsafe(t);l(r,t-4,0);r[4]=n;o(r,5+e,n);return r}encrypt(e){if(this._dead)return;this._onWrite(e);this.outSeqno=this.outSeqno+1>>>0}}const T=Buffer.alloc(32);const P=Buffer.alloc(16);let L;let U;let D;class ChaChaPolyCipherNative{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._encKeyMain=t.cipherKey.slice(0,32);this._encKeyPktLen=t.cipherKey.slice(32);this._dead=false}free(){this._dead=true}allocPacket(e){let t=4+1+e;let n=8-(t-4&8-1);if(n<4)n+=8;t+=n;const r=Buffer.allocUnsafe(t);l(r,t-4,0);r[4]=n;o(r,5+e,n);return r}encrypt(e){if(this._dead)return;P[0]=0;l(P,this.outSeqno,12);const t=r("chacha20",this._encKeyMain,P).update(T);const n=r("chacha20",this._encKeyPktLen,P).update(e.slice(0,4));this._onWrite(n);P[0]=1;const i=r("chacha20",this._encKeyMain,P).update(e.slice(4));this._onWrite(i);D(U,n,n.length,i,i.length,t);const s=Buffer.allocUnsafe(16);s.set(new Uint8Array(L.HEAPU8.buffer,U,16),0);this._onWrite(s);this.outSeqno=this.outSeqno+1>>>0}}class ChaChaPolyCipherBinding{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._instance=new b(t.cipherKey);this._dead=false}free(){this._dead=true;this._instance.free()}allocPacket(e){let t=4+1+e;let n=8-(t-4&8-1);if(n<4)n+=8;t+=n;const r=Buffer.allocUnsafe(t+16);l(r,t-4,0);r[4]=n;o(r,5+e,n);return r}encrypt(e){if(this._dead)return;this._instance.encrypt(e,this.outSeqno);this._onWrite(e);this.outSeqno=this.outSeqno+1>>>0}}class AESGCMCipherNative{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._encSSLName=t.cipherInfo.sslName;this._encKey=t.cipherKey;this._encIV=t.cipherIV;this._dead=false}free(){this._dead=true}allocPacket(e){let t=4+1+e;let n=16-(t-4&16-1);if(n<4)n+=16;t+=n;const r=Buffer.allocUnsafe(t);l(r,t-4,0);r[4]=n;o(r,5+e,n);return r}encrypt(e){if(this._dead)return;const t=r(this._encSSLName,this._encKey,this._encIV);t.setAutoPadding(false);const n=e.slice(0,4);t.setAAD(n);this._onWrite(n);const i=t.update(e.slice(4));this._onWrite(i);const s=t.final();if(s.length)this._onWrite(s);const o=t.getAuthTag();this._onWrite(o);ivIncrement(this._encIV);this.outSeqno=this.outSeqno+1>>>0}}class AESGCMCipherBinding{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._instance=new I(t.cipherInfo.sslName,t.cipherKey,t.cipherIV);this._dead=false}free(){this._dead=true;this._instance.free()}allocPacket(e){let t=4+1+e;let n=16-(t-4&16-1);if(n<4)n+=16;t+=n;const r=Buffer.allocUnsafe(t+16);l(r,t-4,0);r[4]=n;o(r,5+e,n);return r}encrypt(e){if(this._dead)return;this._instance.encrypt(e);this._onWrite(e);this.outSeqno=this.outSeqno+1>>>0}}class GenericCipherNative{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._encBlockLen=t.cipherInfo.blockLen;this._cipherInstance=r(t.cipherInfo.sslName,t.cipherKey,t.cipherIV);this._macSSLName=t.macInfo.sslName;this._macKey=t.macKey;this._macActualLen=t.macInfo.actualLen;this._macETM=t.macInfo.isETM;this._aadLen=this._macETM?4:0;this._dead=false;const n=t.cipherInfo.discardLen;if(n){let e=E.get(n);if(e===undefined){e=Buffer.alloc(n);E.set(n,e)}this._cipherInstance.update(e)}}free(){this._dead=true}allocPacket(e){const t=this._encBlockLen;let n=4+1+e;let r=t-(n-this._aadLen&t-1);if(r<4)r+=t;n+=r;const i=Buffer.allocUnsafe(n);l(i,n-4,0);i[4]=r;o(i,5+e,r);return i}encrypt(e){if(this._dead)return;let t;if(this._macETM){const n=new Uint8Array(e.buffer,e.byteOffset,4);const r=this._cipherInstance.update(new Uint8Array(e.buffer,e.byteOffset+4,e.length-4));this._onWrite(n);this._onWrite(r);t=s(this._macSSLName,this._macKey);l(_,this.outSeqno,0);t.update(_);t.update(n);t.update(r)}else{const n=this._cipherInstance.update(e);this._onWrite(n);t=s(this._macSSLName,this._macKey);l(_,this.outSeqno,0);t.update(_);t.update(e)}let n=t.digest();if(n.length>this._macActualLen)n=n.slice(0,this._macActualLen);this._onWrite(n);this.outSeqno=this.outSeqno+1>>>0}}class GenericCipherBinding{constructor(e){const t=e.outbound;this.outSeqno=t.seqno;this._onWrite=t.onWrite;this._encBlockLen=t.cipherInfo.blockLen;this._macLen=t.macInfo.len;this._macActualLen=t.macInfo.actualLen;this._aadLen=t.macInfo.isETM?4:0;this._instance=new w(t.cipherInfo.sslName,t.cipherKey,t.cipherIV,t.macInfo.sslName,t.macKey,t.macInfo.isETM);this._dead=false}free(){this._dead=true;this._instance.free()}allocPacket(e){const t=this._encBlockLen;let n=4+1+e;let r=t-(n-this._aadLen&t-1);if(r<4)r+=t;n+=r;const i=Buffer.allocUnsafe(n+this._macLen);l(i,n-4,0);i[4]=r;o(i,5+e,r);return i}encrypt(e){if(this._dead)return;this._instance.encrypt(e,this.outSeqno);if(this._macActualLen<this._macLen){e=new h(e.buffer,e.byteOffset,e.length-(this._macLen-this._macActualLen))}this._onWrite(e);this.outSeqno=this.outSeqno+1>>>0}}class NullDecipher{constructor(e,t){this.inSeqno=e;this._onPayload=t;this._len=0;this._lenBytes=0;this._packet=null;this._packetPos=0}free(){}decrypt(e,t,n){while(t<n){if(this._lenBytes<4){let r=Math.min(4-this._lenBytes,n-t);this._lenBytes+=r;while(r--)this._len=(this._len<<8)+e[t++];if(this._lenBytes<4)return;if(this._len>y||this._len<8||(4+this._len&7)!==0){throw new Error("Bad packet length")}if(t>=n)return}if(this._packetPos<this._len){const r=Math.min(this._len-this._packetPos,n-t);let i;if(t!==0||r!==n)i=new Uint8Array(e.buffer,e.byteOffset+t,r);else i=e;if(r===this._len){this._packet=i}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(i,this._packetPos)}t+=r;this._packetPos+=r;if(this._packetPos<this._len)return}const r=!this._packet?g:new h(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._len=0;this._lenBytes=0;this._packet=null;this._packetPos=0;{const e=this._onPayload(r);if(e!==undefined)return e===false?t:e}}}}class ChaChaPolyDecipherNative{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._decKeyMain=t.decipherKey.slice(0,32);this._decKeyPktLen=t.decipherKey.slice(32);this._len=0;this._lenBuf=Buffer.alloc(4);this._lenPos=0;this._packet=null;this._pktLen=0;this._mac=Buffer.allocUnsafe(16);this._calcMac=Buffer.allocUnsafe(16);this._macPos=0}free(){}decrypt(e,t,n){while(t<n){if(this._lenPos<4){let r=Math.min(4-this._lenPos,n-t);while(r--)this._lenBuf[this._lenPos++]=e[t++];if(this._lenPos<4)return;P[0]=0;l(P,this.inSeqno,12);const s=i("chacha20",this._decKeyPktLen,P).update(this._lenBuf);this._len=u(s,0);if(this._len>y||this._len<8||(this._len&7)!==0){throw new Error("Bad packet length")}}if(this._pktLen<this._len){if(t>=n)return;const r=Math.min(this._len-this._pktLen,n-t);let i;if(t!==0||r!==n)i=new Uint8Array(e.buffer,e.byteOffset+t,r);else i=e;if(r===this._len){this._packet=i}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(i,this._pktLen)}t+=r;this._pktLen+=r;if(this._pktLen<this._len||t>=n)return}{const r=Math.min(16-this._macPos,n-t);if(t!==0||r!==n){this._mac.set(new Uint8Array(e.buffer,e.byteOffset+t,r),this._macPos)}else{this._mac.set(e,this._macPos)}t+=r;this._macPos+=r;if(this._macPos<16)return}P[0]=0;l(P,this.inSeqno,12);const s=r("chacha20",this._decKeyMain,P).update(T);D(U,this._lenBuf,4,this._packet,this._packet.length,s);this._calcMac.set(new Uint8Array(L.HEAPU8.buffer,U,16),0);if(!f(this._calcMac,this._mac))throw new Error("Invalid MAC");P[0]=1;const o=i("chacha20",this._decKeyMain,P).update(this._packet);const p=new h(o.buffer,o.byteOffset+1,o.length-o[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._len=0;this._lenPos=0;this._packet=null;this._pktLen=0;this._macPos=0;{const e=this._onPayload(p);if(e!==undefined)return e===false?t:e}}}}class ChaChaPolyDecipherBinding{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._instance=new k(t.decipherKey);this._len=0;this._lenBuf=Buffer.alloc(4);this._lenPos=0;this._packet=null;this._pktLen=0;this._mac=Buffer.allocUnsafe(16);this._macPos=0}free(){this._instance.free()}decrypt(e,t,n){while(t<n){if(this._lenPos<4){let r=Math.min(4-this._lenPos,n-t);while(r--)this._lenBuf[this._lenPos++]=e[t++];if(this._lenPos<4)return;this._len=this._instance.decryptLen(this._lenBuf,this.inSeqno);if(this._len>y||this._len<8||(this._len&7)!==0){throw new Error("Bad packet length")}if(t>=n)return}if(this._pktLen<this._len){const r=Math.min(this._len-this._pktLen,n-t);let i;if(t!==0||r!==n)i=new Uint8Array(e.buffer,e.byteOffset+t,r);else i=e;if(r===this._len){this._packet=i}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(i,this._pktLen)}t+=r;this._pktLen+=r;if(this._pktLen<this._len||t>=n)return}{const r=Math.min(16-this._macPos,n-t);if(t!==0||r!==n){this._mac.set(new Uint8Array(e.buffer,e.byteOffset+t,r),this._macPos)}else{this._mac.set(e,this._macPos)}t+=r;this._macPos+=r;if(this._macPos<16)return}this._instance.decrypt(this._packet,this._mac,this.inSeqno);const r=new h(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._len=0;this._lenPos=0;this._packet=null;this._pktLen=0;this._macPos=0;{const e=this._onPayload(r);if(e!==undefined)return e===false?t:e}}}}class AESGCMDecipherNative{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._decipherInstance=null;this._decipherSSLName=t.decipherInfo.sslName;this._decipherKey=t.decipherKey;this._decipherIV=t.decipherIV;this._len=0;this._lenBytes=0;this._packet=null;this._packetPos=0;this._pktLen=0;this._tag=Buffer.allocUnsafe(16);this._tagPos=0}free(){}decrypt(e,t,n){while(t<n){if(this._lenBytes<4){let r=Math.min(4-this._lenBytes,n-t);this._lenBytes+=r;while(r--)this._len=(this._len<<8)+e[t++];if(this._lenBytes<4)return;if(this._len+20>y||this._len<16||(this._len&15)!==0){throw new Error("Bad packet length")}this._decipherInstance=i(this._decipherSSLName,this._decipherKey,this._decipherIV);this._decipherInstance.setAutoPadding(false);this._decipherInstance.setAAD(Q(this._len))}if(this._pktLen<this._len){if(t>=n)return;const r=Math.min(this._len-this._pktLen,n-t);let i;if(t!==0||r!==n){i=this._decipherInstance.update(new Uint8Array(e.buffer,e.byteOffset+t,r))}else{i=this._decipherInstance.update(e)}if(i.length){if(r===this._len){this._packet=i}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(i,this._packetPos)}this._packetPos+=i.length}t+=r;this._pktLen+=r;if(this._pktLen<this._len||t>=n)return}{const r=Math.min(16-this._tagPos,n-t);if(t!==0||r!==n){this._tag.set(new Uint8Array(e.buffer,e.byteOffset+t,r),this._tagPos)}else{this._tag.set(e,this._tagPos)}t+=r;this._tagPos+=r;if(this._tagPos<16)return}{this._decipherInstance.setAuthTag(this._tag);const e=this._decipherInstance.final();if(e.length){if(this._packet)this._packet.set(e,this._packetPos);else this._packet=e}}const r=!this._packet?g:new h(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;ivIncrement(this._decipherIV);this._len=0;this._lenBytes=0;this._packet=null;this._packetPos=0;this._pktLen=0;this._tagPos=0;{const e=this._onPayload(r);if(e!==undefined)return e===false?t:e}}}}class AESGCMDecipherBinding{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._instance=new C(t.decipherInfo.sslName,t.decipherKey,t.decipherIV);this._len=0;this._lenBytes=0;this._packet=null;this._pktLen=0;this._tag=Buffer.allocUnsafe(16);this._tagPos=0}free(){}decrypt(e,t,n){while(t<n){if(this._lenBytes<4){let r=Math.min(4-this._lenBytes,n-t);this._lenBytes+=r;while(r--)this._len=(this._len<<8)+e[t++];if(this._lenBytes<4)return;if(this._len+20>y||this._len<16||(this._len&15)!==0){throw new Error(`Bad packet length: ${this._len}`)}}if(this._pktLen<this._len){if(t>=n)return;const r=Math.min(this._len-this._pktLen,n-t);let i;if(t!==0||r!==n)i=new Uint8Array(e.buffer,e.byteOffset+t,r);else i=e;if(r===this._len){this._packet=i}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(i,this._pktLen)}t+=r;this._pktLen+=r;if(this._pktLen<this._len||t>=n)return}{const r=Math.min(16-this._tagPos,n-t);if(t!==0||r!==n){this._tag.set(new Uint8Array(e.buffer,e.byteOffset+t,r),this._tagPos)}else{this._tag.set(e,this._tagPos)}t+=r;this._tagPos+=r;if(this._tagPos<16)return}this._instance.decrypt(this._packet,this._len,this._tag);const r=new h(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._len=0;this._lenBytes=0;this._packet=null;this._pktLen=0;this._tagPos=0;{const e=this._onPayload(r);if(e!==undefined)return e===false?t:e}}}}class GenericDecipherNative{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._decipherInstance=i(t.decipherInfo.sslName,t.decipherKey,t.decipherIV);this._decipherInstance.setAutoPadding(false);this._block=Buffer.allocUnsafe(t.macInfo.isETM?4:t.decipherInfo.blockLen);this._blockSize=t.decipherInfo.blockLen;this._blockPos=0;this._len=0;this._packet=null;this._packetPos=0;this._pktLen=0;this._mac=Buffer.allocUnsafe(t.macInfo.actualLen);this._macPos=0;this._macSSLName=t.macInfo.sslName;this._macKey=t.macKey;this._macActualLen=t.macInfo.actualLen;this._macETM=t.macInfo.isETM;this._macInstance=null;const n=t.decipherInfo.discardLen;if(n){let e=E.get(n);if(e===undefined){e=Buffer.alloc(n);E.set(n,e)}this._decipherInstance.update(e)}}free(){}decrypt(e,t,n){while(t<n){if(this._blockPos<this._block.length){const r=Math.min(this._block.length-this._blockPos,n-t);if(t!==0||r!==n||r<e.length){this._block.set(new Uint8Array(e.buffer,e.byteOffset+t,r),this._blockPos)}else{this._block.set(e,this._blockPos)}t+=r;this._blockPos+=r;if(this._blockPos<this._block.length)return;let i;let o;if(this._macETM){this._len=o=u(this._block,0)}else{i=this._decipherInstance.update(this._block);this._len=u(i,0);o=4+this._len-this._blockSize}if(this._len>y||this._len<5||(o&this._blockSize-1)!==0){throw new Error("Bad packet length")}this._macInstance=s(this._macSSLName,this._macKey);l(_,this.inSeqno,0);this._macInstance.update(_);if(this._macETM){this._macInstance.update(this._block)}else{this._macInstance.update(new Uint8Array(i.buffer,i.byteOffset,4));this._pktLen=i.length-4;this._packetPos=this._pktLen;this._packet=Buffer.allocUnsafe(this._len);this._packet.set(new Uint8Array(i.buffer,i.byteOffset+4,this._packetPos),0)}if(t>=n)return}if(this._pktLen<this._len){const r=Math.min(this._len-this._pktLen,n-t);let i;if(t!==0||r!==n)i=new Uint8Array(e.buffer,e.byteOffset+t,r);else i=e;if(this._macETM)this._macInstance.update(i);const s=this._decipherInstance.update(i);if(s.length){if(r===this._len){this._packet=s}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(s,this._packetPos)}this._packetPos+=s.length}t+=r;this._pktLen+=r;if(this._pktLen<this._len||t>=n)return}{const r=Math.min(this._macActualLen-this._macPos,n-t);if(t!==0||r!==n){this._mac.set(new Uint8Array(e.buffer,e.byteOffset+t,r),this._macPos)}else{this._mac.set(e,this._macPos)}t+=r;this._macPos+=r;if(this._macPos<this._macActualLen)return}if(!this._macETM)this._macInstance.update(this._packet);let r=this._macInstance.digest();if(this._macActualLen<r.length){r=new Uint8Array(r.buffer,r.byteOffset,this._macActualLen)}if(!timingSafeEquals(r,this._mac))throw new Error("Invalid MAC");const i=new h(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._blockPos=0;this._len=0;this._packet=null;this._packetPos=0;this._pktLen=0;this._macPos=0;this._macInstance=null;{const e=this._onPayload(i);if(e!==undefined)return e===false?t:e}}}}class GenericDecipherBinding{constructor(e){const t=e.inbound;this.inSeqno=t.seqno;this._onPayload=t.onPayload;this._instance=new R(t.decipherInfo.sslName,t.decipherKey,t.decipherIV,t.macInfo.sslName,t.macKey,t.macInfo.isETM,t.macInfo.actualLen);this._block=Buffer.allocUnsafe(t.macInfo.isETM||t.decipherInfo.stream?4:t.decipherInfo.blockLen);this._blockPos=0;this._len=0;this._packet=null;this._pktLen=0;this._mac=Buffer.allocUnsafe(t.macInfo.actualLen);this._macPos=0;this._macActualLen=t.macInfo.actualLen;this._macETM=t.macInfo.isETM}free(){this._instance.free()}decrypt(e,t,n){while(t<n){if(this._blockPos<this._block.length){const r=Math.min(this._block.length-this._blockPos,n-t);if(t!==0||r!==n||r<e.length){this._block.set(new Uint8Array(e.buffer,e.byteOffset+t,r),this._blockPos)}else{this._block.set(e,this._blockPos)}t+=r;this._blockPos+=r;if(this._blockPos<this._block.length)return;let i;if(this._macETM){this._len=i=u(this._block,0)}else{this._instance.decryptBlock(this._block);this._len=u(this._block,0);i=4+this._len-this._block.length}if(this._len>y||this._len<5||(i&this._block.length-1)!==0){throw new Error("Bad packet length")}if(!this._macETM){this._pktLen=this._block.length-4;if(this._pktLen){this._packet=Buffer.allocUnsafe(this._len);this._packet.set(new Uint8Array(this._block.buffer,this._block.byteOffset+4,this._pktLen),0)}}if(t>=n)return}if(this._pktLen<this._len){const r=Math.min(this._len-this._pktLen,n-t);let i;if(t!==0||r!==n)i=new Uint8Array(e.buffer,e.byteOffset+t,r);else i=e;if(r===this._len){this._packet=i}else{if(!this._packet)this._packet=Buffer.allocUnsafe(this._len);this._packet.set(i,this._pktLen)}t+=r;this._pktLen+=r;if(this._pktLen<this._len||t>=n)return}{const r=Math.min(this._macActualLen-this._macPos,n-t);if(t!==0||r!==n){this._mac.set(new Uint8Array(e.buffer,e.byteOffset+t,r),this._macPos)}else{this._mac.set(e,this._macPos)}t+=r;this._macPos+=r;if(this._macPos<this._macActualLen)return}this._instance.decrypt(this._packet,this.inSeqno,this._block,this._mac);const r=new h(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0;this._blockPos=0;this._len=0;this._packet=null;this._pktLen=0;this._macPos=0;this._macInstance=null;{const e=this._onPayload(r);if(e!==undefined)return e===false?t:e}}}}function ivIncrement(e){++e[11]>>>8&&++e[10]>>>8&&++e[9]>>>8&&++e[8]>>>8&&++e[7]>>>8&&++e[6]>>>8&&++e[5]>>>8&&++e[4]>>>8}const Q=(()=>{const e=Buffer.alloc(4);return t=>{e[0]=t>>>24;e[1]=t>>>16;e[2]=t>>>8;e[3]=t;return e}})();function timingSafeEquals(e,t){if(e.length!==t.length){f(e,e);return false}return f(e,t)}function createCipher(e){if(typeof e!=="object"||e===null)throw new Error("Invalid config");if(typeof e.outbound!=="object"||e.outbound===null)throw new Error("Invalid outbound");const t=e.outbound;if(typeof t.onWrite!=="function")throw new Error("Invalid outbound.onWrite");if(typeof t.cipherInfo!=="object"||t.cipherInfo===null)throw new Error("Invalid outbound.cipherInfo");if(!Buffer.isBuffer(t.cipherKey)||t.cipherKey.length!==t.cipherInfo.keyLen){throw new Error("Invalid outbound.cipherKey")}if(t.cipherInfo.ivLen&&(!Buffer.isBuffer(t.cipherIV)||t.cipherIV.length!==t.cipherInfo.ivLen)){throw new Error("Invalid outbound.cipherIV")}if(typeof t.seqno!=="number"||t.seqno<0||t.seqno>p){throw new Error("Invalid outbound.seqno")}const n=!!t.forceNative;switch(t.cipherInfo.sslName){case"aes-128-gcm":case"aes-256-gcm":return I&&!n?new AESGCMCipherBinding(e):new AESGCMCipherNative(e);case"chacha20":return b&&!n?new ChaChaPolyCipherBinding(e):new ChaChaPolyCipherNative(e);default:{if(typeof t.macInfo!=="object"||t.macInfo===null)throw new Error("Invalid outbound.macInfo");if(!Buffer.isBuffer(t.macKey)||t.macKey.length!==t.macInfo.len){throw new Error("Invalid outbound.macKey")}return w&&!n?new GenericCipherBinding(e):new GenericCipherNative(e)}}}function createDecipher(e){if(typeof e!=="object"||e===null)throw new Error("Invalid config");if(typeof e.inbound!=="object"||e.inbound===null)throw new Error("Invalid inbound");const t=e.inbound;if(typeof t.onPayload!=="function")throw new Error("Invalid inbound.onPayload");if(typeof t.decipherInfo!=="object"||t.decipherInfo===null){throw new Error("Invalid inbound.decipherInfo")}if(!Buffer.isBuffer(t.decipherKey)||t.decipherKey.length!==t.decipherInfo.keyLen){throw new Error("Invalid inbound.decipherKey")}if(t.decipherInfo.ivLen&&(!Buffer.isBuffer(t.decipherIV)||t.decipherIV.length!==t.decipherInfo.ivLen)){throw new Error("Invalid inbound.decipherIV")}if(typeof t.seqno!=="number"||t.seqno<0||t.seqno>p){throw new Error("Invalid inbound.seqno")}const n=!!t.forceNative;switch(t.decipherInfo.sslName){case"aes-128-gcm":case"aes-256-gcm":return C&&!n?new AESGCMDecipherBinding(e):new AESGCMDecipherNative(e);case"chacha20":return k&&!n?new ChaChaPolyDecipherBinding(e):new ChaChaPolyDecipherNative(e);default:{if(typeof t.macInfo!=="object"||t.macInfo===null)throw new Error("Invalid inbound.macInfo");if(!Buffer.isBuffer(t.macKey)||t.macKey.length!==t.macInfo.len){throw new Error("Invalid inbound.macKey")}return R&&!n?new GenericDecipherBinding(e):new GenericDecipherNative(e)}}}e.exports={CIPHER_INFO:v,MAC_INFO:O,bindingAvailable:!!m,init:(()=>new Promise((async(e,t)=>{try{L=await n(4989)();U=L._malloc(16);D=L.cwrap("poly1305_auth",null,["number","array","number","array","number","array"])}catch(e){return t(e)}e()})))(),NullCipher:NullCipher,createCipher:createCipher,NullDecipher:NullDecipher,createDecipher:createDecipher}},4989:(e,t,n)=>{var r=function(){var e=typeof document!=="undefined"&&document.currentScript?document.currentScript.src:undefined;if(typeof __filename!=="undefined")e=e||__filename;return function(t){t=t||{};var r;r||(r=typeof t!=="undefined"?t:{});var i,s;r.ready=new Promise((function(e,t){i=e;s=t}));var o={},f;for(f in r)r.hasOwnProperty(f)&&(o[f]=r[f]);var u="object"===typeof window,l="function"===typeof importScripts,h="object"===typeof process&&"object"===typeof process.versions&&"string"===typeof process.versions.node,p="",g,_,E,y,m;if(h)p=l?n(1017).dirname(p)+"/":__dirname+"/",g=function(e,t){var r=H(e);if(r)return t?r:r.toString();y||(y=n(7147));m||(m=n(1017));e=m.normalize(e);return y.readFileSync(e,t?null:"utf8")},E=function(e){e=g(e,!0);e.buffer||(e=new Uint8Array(e));assert(e.buffer);return e},_=function(e,t,r){var i=H(e);i&&t(i);y||(y=n(7147));m||(m=n(1017));e=m.normalize(e);y.readFile(e,(function(e,n){e?r(e):t(n.buffer)}))},1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),r.inspect=function(){return"[Emscripten Module object]"};else if(u||l)l?p=self.location.href:"undefined"!==typeof document&&document.currentScript&&(p=document.currentScript.src),e&&(p=e),0!==p.indexOf("blob:")?p=p.substr(0,p.lastIndexOf("/")+1):p="",g=function(e){try{var t=new XMLHttpRequest;t.open("GET",e,!1);t.send(null);return t.responseText}catch(i){if(e=H(e)){t=[];for(var n=0;n<e.length;n++){var r=e[n];255<r&&($&&assert(!1,"Character code "+r+" ("+String.fromCharCode(r)+")  at offset "+n+" not in 0x00-0xFF."),r&=255);t.push(String.fromCharCode(r))}return t.join("")}throw i}},l&&(E=function(e){try{var t=new XMLHttpRequest;t.open("GET",e,!1);t.responseType="arraybuffer";t.send(null);return new Uint8Array(t.response)}catch(t){if(e=H(e))return e;throw t}}),_=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0);r.responseType="arraybuffer";r.onload=function(){if(200==r.status||0==r.status&&r.response)t(r.response);else{var i=H(e);i?t(i.buffer):n()}};r.onerror=n;r.send(null)};r.print||console.log.bind(console);var I=r.printErr||console.warn.bind(console);for(f in o)o.hasOwnProperty(f)&&(r[f]=o[f]);o=null;var b;r.wasmBinary&&(b=r.wasmBinary);var w=r.noExitRuntime||!0;"object"!==typeof WebAssembly&&K("no native wasm support detected");var C,k=!1;function assert(e,t){e||K("Assertion failed: "+t)}function N(e){var t=r["_"+e];assert(t,"Cannot call unknown function "+e+", make sure it is exported");return t}function ca(e,t,n,r){var i={string:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var n=(e.length<<2)+1;t=J(n);var r=t,i=O;if(0<n){n=r+n-1;for(var s=0;s<e.length;++s){var o=e.charCodeAt(s);if(55296<=o&&57343>=o){var f=e.charCodeAt(++s);o=65536+((o&1023)<<10)|f&1023}if(127>=o){if(r>=n)break;i[r++]=o}else{if(2047>=o){if(r+1>=n)break;i[r++]=192|o>>6}else{if(65535>=o){if(r+2>=n)break;i[r++]=224|o>>12}else{if(r+3>=n)break;i[r++]=240|o>>18;i[r++]=128|o>>12&63}i[r++]=128|o>>6&63}i[r++]=128|o&63}}i[r]=0}}return t},array:function(e){var t=J(e.length);v.set(e,t);return t}},s=N(e),o=[];e=0;if(r)for(var f=0;f<r.length;f++){var u=i[n[f]];u?(0===e&&(e=V()),o[f]=u(r[f])):o[f]=r[f]}n=s.apply(null,o);n=function(e){if("string"===t)if(e){for(var n=O,r=e+NaN,i=e;n[i]&&!(i>=r);)++i;if(16<i-e&&n.subarray&&R)e=R.decode(n.subarray(e,i));else{for(r="";e<i;){var s=n[e++];if(s&128){var o=n[e++]&63;if(192==(s&224))r+=String.fromCharCode((s&31)<<6|o);else{var f=n[e++]&63;s=224==(s&240)?(s&15)<<12|o<<6|f:(s&7)<<18|o<<12|f<<6|n[e++]&63;65536>s?r+=String.fromCharCode(s):(s-=65536,r+=String.fromCharCode(55296|s>>10,56320|s&1023))}}else r+=String.fromCharCode(s)}e=r}}else e="";else e="boolean"===t?!!e:e;return e}(n);0!==e&&z(e);return n}var R="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0,B,v,O;function ia(){var e=C.buffer;B=e;r.HEAP8=v=new Int8Array(e);r.HEAP16=new Int16Array(e);r.HEAP32=new Int32Array(e);r.HEAPU8=O=new Uint8Array(e);r.HEAPU16=new Uint16Array(e);r.HEAPU32=new Uint32Array(e);r.HEAPF32=new Float32Array(e);r.HEAPF64=new Float64Array(e)}var T,P=[],L=[],U=[];function ma(){var e=r.preRun.shift();P.unshift(e)}var D=0,Q=null,x=null;r.preloadedImages={};r.preloadedAudios={};function K(e){if(r.onAbort)r.onAbort(e);I(e);k=!0;e=new WebAssembly.RuntimeError("abort("+e+"). Build with -s ASSERTIONS=1 for more info.");s(e);throw e}var W="data:application/octet-stream;base64,",q;q="data:application/octet-stream;base64,AGFzbQEAAAABIAZgAX8Bf2ADf39/AGABfwBgAABgAAF/YAZ/f39/f38AAgcBAWEBYQAAAwsKAAEDAQAAAgQFAgQFAXABAQEFBwEBgAKAgAIGCQF/AUGAjMACCwclCQFiAgABYwADAWQACQFlAAgBZgAHAWcABgFoAAUBaQAKAWoBAAqGTQpPAQJ/QYAIKAIAIgEgAEEDakF8cSICaiEAAkAgAkEAIAAgAU0bDQAgAD8AQRB0SwRAIAAQAEUNAQtBgAggADYCACABDwtBhAhBMDYCAEF/C4wFAg5+Cn8gACgCJCEUIAAoAiAhFSAAKAIcIREgACgCGCESIAAoAhQhEyACQRBPBEAgAC0ATEVBGHQhFyAAKAIEIhZBBWytIQ8gACgCCCIYQQVsrSENIAAoAgwiGUEFbK0hCyAAKAIQIhpBBWytIQkgADUCACEIIBqtIRAgGa0hDiAYrSEMIBatIQoDQCASIAEtAAMiEiABLQAEQQh0ciABLQAFQRB0ciABLQAGIhZBGHRyQQJ2Qf///x9xaq0iAyAOfiABLwAAIAEtAAJBEHRyIBNqIBJBGHRBgICAGHFqrSIEIBB+fCARIAEtAAdBCHQgFnIgAS0ACEEQdHIgAS0ACSIRQRh0ckEEdkH///8fcWqtIgUgDH58IAEtAApBCHQgEXIgAS0AC0EQdHIgAS0ADEEYdHJBBnYgFWqtIgYgCn58IBQgF2ogAS8ADSABLQAPQRB0cmqtIgcgCH58IAMgDH4gBCAOfnwgBSAKfnwgBiAIfnwgByAJfnwgAyAKfiAEIAx+fCAFIAh+fCAGIAl+fCAHIAt+fCADIAh+IAQgCn58IAUgCX58IAYgC358IAcgDX58IAMgCX4gBCAIfnwgBSALfnwgBiANfnwgByAPfnwiA0IaiEL/////D4N8IgRCGohC/////w+DfCIFQhqIQv////8Pg3wiBkIaiEL/////D4N8IgdCGoinQQVsIAOnQf///x9xaiITQRp2IASnQf///x9xaiESIAWnQf///x9xIREgBqdB////H3EhFSAHp0H///8fcSEUIBNB////H3EhEyABQRBqIQEgAkEQayICQQ9LDQALCyAAIBQ2AiQgACAVNgIgIAAgETYCHCAAIBI2AhggACATNgIUCwMAAQu2BAEGfwJAIAAoAjgiBARAIABBPGohBQJAIAJBECAEayIDIAIgA0kbIgZFDQAgBkEDcSEHAkAgBkEBa0EDSQRAQQAhAwwBCyAGQXxxIQhBACEDA0AgBSADIARqaiABIANqLQAAOgAAIAUgA0EBciIEIAAoAjhqaiABIARqLQAAOgAAIAUgA0ECciIEIAAoAjhqaiABIARqLQAAOgAAIAUgA0EDciIEIAAoAjhqaiABIARqLQAAOgAAIANBBGohAyAAKAI4IQQgCEEEayIIDQALCyAHRQ0AA0AgBSADIARqaiABIANqLQAAOgAAIANBAWohAyAAKAI4IQQgB0EBayIHDQALCyAAIAQgBmoiAzYCOCADQRBJDQEgACAFQRAQAiAAQQA2AjggAiAGayECIAEgBmohAQsgAkEQTwRAIAAgASACQXBxIgMQAiACQQ9xIQIgASADaiEBCyACRQ0AIAJBA3EhBCAAQTxqIQVBACEDIAJBAWtBA08EQCACQXxxIQcDQCAFIAAoAjggA2pqIAEgA2otAAA6AAAgBSADQQFyIgYgACgCOGpqIAEgBmotAAA6AAAgBSADQQJyIgYgACgCOGpqIAEgBmotAAA6AAAgBSADQQNyIgYgACgCOGpqIAEgBmotAAA6AAAgA0EEaiEDIAdBBGsiBw0ACwsgBARAA0AgBSAAKAI4IANqaiABIANqLQAAOgAAIANBAWohAyAEQQFrIgQNAAsLIAAgACgCOCACajYCOAsLoS0BDH8jAEEQayIMJAACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgAEH0AU0EQEGICCgCACIFQRAgAEELakF4cSAAQQtJGyIIQQN2IgJ2IgFBA3EEQCABQX9zQQFxIAJqIgNBA3QiAUG4CGooAgAiBEEIaiEAAkAgBCgCCCICIAFBsAhqIgFGBEBBiAggBUF+IAN3cTYCAAwBCyACIAE2AgwgASACNgIICyAEIANBA3QiAUEDcjYCBCABIARqIgEgASgCBEEBcjYCBAwNCyAIQZAIKAIAIgpNDQEgAQRAAkBBAiACdCIAQQAgAGtyIAEgAnRxIgBBACAAa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2aiIDQQN0IgBBuAhqKAIAIgQoAggiASAAQbAIaiIARgRAQYgIIAVBfiADd3EiBTYCAAwBCyABIAA2AgwgACABNgIICyAEQQhqIQAgBCAIQQNyNgIEIAQgCGoiAiADQQN0IgEgCGsiA0EBcjYCBCABIARqIAM2AgAgCgRAIApBA3YiAUEDdEGwCGohB0GcCCgCACEEAn8gBUEBIAF0IgFxRQRAQYgIIAEgBXI2AgAgBwwBCyAHKAIICyEBIAcgBDYCCCABIAQ2AgwgBCAHNgIMIAQgATYCCAtBnAggAjYCAEGQCCADNgIADA0LQYwIKAIAIgZFDQEgBkEAIAZrcUEBayIAIABBDHZBEHEiAnYiAUEFdkEIcSIAIAJyIAEgAHYiAUECdkEEcSIAciABIAB2IgFBAXZBAnEiAHIgASAAdiIBQQF2QQFxIgByIAEgAHZqQQJ0QbgKaigCACIBKAIEQXhxIAhrIQMgASECA0ACQCACKAIQIgBFBEAgAigCFCIARQ0BCyAAKAIEQXhxIAhrIgIgAyACIANJIgIbIQMgACABIAIbIQEgACECDAELCyABIAhqIgkgAU0NAiABKAIYIQsgASABKAIMIgRHBEAgASgCCCIAQZgIKAIASRogACAENgIMIAQgADYCCAwMCyABQRRqIgIoAgAiAEUEQCABKAIQIgBFDQQgAUEQaiECCwNAIAIhByAAIgRBFGoiAigCACIADQAgBEEQaiECIAQoAhAiAA0ACyAHQQA2AgAMCwtBfyEIIABBv39LDQAgAEELaiIAQXhxIQhBjAgoAgAiCUUNAEEAIAhrIQMCQAJAAkACf0EAIAhBgAJJDQAaQR8gCEH///8HSw0AGiAAQQh2IgAgAEGA/j9qQRB2QQhxIgJ0IgAgAEGA4B9qQRB2QQRxIgF0IgAgAEGAgA9qQRB2QQJxIgB0QQ92IAEgAnIgAHJrIgBBAXQgCCAAQRVqdkEBcXJBHGoLIgVBAnRBuApqKAIAIgJFBEBBACEADAELQQAhACAIQQBBGSAFQQF2ayAFQR9GG3QhAQNAAkAgAigCBEF4cSAIayIHIANPDQAgAiEEIAciAw0AQQAhAyACIQAMAwsgACACKAIUIgcgByACIAFBHXZBBHFqKAIQIgJGGyAAIAcbIQAgAUEBdCEBIAINAAsLIAAgBHJFBEBBACEEQQIgBXQiAEEAIABrciAJcSIARQ0DIABBACAAa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2akECdEG4CmooAgAhAAsgAEUNAQsDQCAAKAIEQXhxIAhrIgEgA0khAiABIAMgAhshAyAAIAQgAhshBCAAKAIQIgEEfyABBSAAKAIUCyIADQALCyAERQ0AIANBkAgoAgAgCGtPDQAgBCAIaiIGIARNDQEgBCgCGCEFIAQgBCgCDCIBRwRAIAQoAggiAEGYCCgCAEkaIAAgATYCDCABIAA2AggMCgsgBEEUaiICKAIAIgBFBEAgBCgCECIARQ0EIARBEGohAgsDQCACIQcgACIBQRRqIgIoAgAiAA0AIAFBEGohAiABKAIQIgANAAsgB0EANgIADAkLIAhBkAgoAgAiAk0EQEGcCCgCACEDAkAgAiAIayIBQRBPBEBBkAggATYCAEGcCCADIAhqIgA2AgAgACABQQFyNgIEIAIgA2ogATYCACADIAhBA3I2AgQMAQtBnAhBADYCAEGQCEEANgIAIAMgAkEDcjYCBCACIANqIgAgACgCBEEBcjYCBAsgA0EIaiEADAsLIAhBlAgoAgAiBkkEQEGUCCAGIAhrIgE2AgBBoAhBoAgoAgAiAiAIaiIANgIAIAAgAUEBcjYCBCACIAhBA3I2AgQgAkEIaiEADAsLQQAhACAIQS9qIgkCf0HgCygCAARAQegLKAIADAELQewLQn83AgBB5AtCgKCAgICABDcCAEHgCyAMQQxqQXBxQdiq1aoFczYCAEH0C0EANgIAQcQLQQA2AgBBgCALIgFqIgVBACABayIHcSICIAhNDQpBwAsoAgAiBARAQbgLKAIAIgMgAmoiASADTQ0LIAEgBEsNCwtBxAstAABBBHENBQJAAkBBoAgoAgAiAwRAQcgLIQADQCADIAAoAgAiAU8EQCABIAAoAgRqIANLDQMLIAAoAggiAA0ACwtBABABIgFBf0YNBiACIQVB5AsoAgAiA0EBayIAIAFxBEAgAiABayAAIAFqQQAgA2txaiEFCyAFIAhNDQYgBUH+////B0sNBkHACygCACIEBEBBuAsoAgAiAyAFaiIAIANNDQcgACAESw0HCyAFEAEiACABRw0BDAgLIAUgBmsgB3EiBUH+////B0sNBSAFEAEiASAAKAIAIAAoAgRqRg0EIAEhAAsCQCAAQX9GDQAgCEEwaiAFTQ0AQegLKAIAIgEgCSAFa2pBACABa3EiAUH+////B0sEQCAAIQEMCAsgARABQX9HBEAgASAFaiEFIAAhAQwIC0EAIAVrEAEaDAULIAAiAUF/Rw0GDAQLAAtBACEEDAcLQQAhAQwFCyABQX9HDQILQcQLQcQLKAIAQQRyNgIACyACQf7///8HSw0BIAIQASEBQQAQASEAIAFBf0YNASAAQX9GDQEgACABTQ0BIAAgAWsiBSAIQShqTQ0BC0G4C0G4CygCACAFaiIANgIAQbwLKAIAIABJBEBBvAsgADYCAAsCQAJAAkBBoAgoAgAiBwRAQcgLIQADQCABIAAoAgAiAyAAKAIEIgJqRg0CIAAoAggiAA0ACwwCC0GYCCgCACIAQQAgACABTRtFBEBBmAggATYCAAtBACEAQcwLIAU2AgBByAsgATYCAEGoCEF/NgIAQawIQeALKAIANgIAQdQLQQA2AgADQCAAQQN0IgNBuAhqIANBsAhqIgI2AgAgA0G8CGogAjYCACAAQQFqIgBBIEcNAAtBlAggBUEoayIDQXggAWtBB3FBACABQQhqQQdxGyIAayICNgIAQaAIIAAgAWoiADYCACAAIAJBAXI2AgQgASADakEoNgIEQaQIQfALKAIANgIADAILIAAtAAxBCHENACADIAdLDQAgASAHTQ0AIAAgAiAFajYCBEGgCCAHQXggB2tBB3FBACAHQQhqQQdxGyIAaiICNgIAQZQIQZQIKAIAIAVqIgEgAGsiADYCACACIABBAXI2AgQgASAHakEoNgIEQaQIQfALKAIANgIADAELQZgIKAIAIAFLBEBBmAggATYCAAsgASAFaiECQcgLIQACQAJAAkACQAJAAkADQCACIAAoAgBHBEAgACgCCCIADQEMAgsLIAAtAAxBCHFFDQELQcgLIQADQCAHIAAoAgAiAk8EQCACIAAoAgRqIgQgB0sNAwsgACgCCCEADAALAAsgACABNgIAIAAgACgCBCAFajYCBCABQXggAWtBB3FBACABQQhqQQdxG2oiCSAIQQNyNgIEIAJBeCACa0EHcUEAIAJBCGpBB3EbaiIFIAggCWoiBmshAiAFIAdGBEBBoAggBjYCAEGUCEGUCCgCACACaiIANgIAIAYgAEEBcjYCBAwDCyAFQZwIKAIARgRAQZwIIAY2AgBBkAhBkAgoAgAgAmoiADYCACAGIABBAXI2AgQgACAGaiAANgIADAMLIAUoAgQiAEEDcUEBRgRAIABBeHEhBwJAIABB/wFNBEAgBSgCCCIDIABBA3YiAEEDdEGwCGpGGiADIAUoAgwiAUYEQEGICEGICCgCAEF+IAB3cTYCAAwCCyADIAE2AgwgASADNgIIDAELIAUoAhghCAJAIAUgBSgCDCIBRwRAIAUoAggiACABNgIMIAEgADYCCAwBCwJAIAVBFGoiACgCACIDDQAgBUEQaiIAKAIAIgMNAEEAIQEMAQsDQCAAIQQgAyIBQRRqIgAoAgAiAw0AIAFBEGohACABKAIQIgMNAAsgBEEANgIACyAIRQ0AAkAgBSAFKAIcIgNBAnRBuApqIgAoAgBGBEAgACABNgIAIAENAUGMCEGMCCgCAEF+IAN3cTYCAAwCCyAIQRBBFCAIKAIQIAVGG2ogATYCACABRQ0BCyABIAg2AhggBSgCECIABEAgASAANgIQIAAgATYCGAsgBSgCFCIARQ0AIAEgADYCFCAAIAE2AhgLIAUgB2ohBSACIAdqIQILIAUgBSgCBEF+cTYCBCAGIAJBAXI2AgQgAiAGaiACNgIAIAJB/wFNBEAgAkEDdiIAQQN0QbAIaiECAn9BiAgoAgAiAUEBIAB0IgBxRQRAQYgIIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBjYCCCAAIAY2AgwgBiACNgIMIAYgADYCCAwDC0EfIQAgAkH///8HTQRAIAJBCHYiACAAQYD+P2pBEHZBCHEiA3QiACAAQYDgH2pBEHZBBHEiAXQiACAAQYCAD2pBEHZBAnEiAHRBD3YgASADciAAcmsiAEEBdCACIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRBuApqIQQCQEGMCCgCACIDQQEgAHQiAXFFBEBBjAggASADcjYCACAEIAY2AgAgBiAENgIYDAELIAJBAEEZIABBAXZrIABBH0YbdCEAIAQoAgAhAQNAIAEiAygCBEF4cSACRg0DIABBHXYhASAAQQF0IQAgAyABQQRxaiIEKAIQIgENAAsgBCAGNgIQIAYgAzYCGAsgBiAGNgIMIAYgBjYCCAwCC0GUCCAFQShrIgNBeCABa0EHcUEAIAFBCGpBB3EbIgBrIgI2AgBBoAggACABaiIANgIAIAAgAkEBcjYCBCABIANqQSg2AgRBpAhB8AsoAgA2AgAgByAEQScgBGtBB3FBACAEQSdrQQdxG2pBL2siACAAIAdBEGpJGyICQRs2AgQgAkHQCykCADcCECACQcgLKQIANwIIQdALIAJBCGo2AgBBzAsgBTYCAEHICyABNgIAQdQLQQA2AgAgAkEYaiEAA0AgAEEHNgIEIABBCGohASAAQQRqIQAgASAESQ0ACyACIAdGDQMgAiACKAIEQX5xNgIEIAcgAiAHayIEQQFyNgIEIAIgBDYCACAEQf8BTQRAIARBA3YiAEEDdEGwCGohAgJ/QYgIKAIAIgFBASAAdCIAcUUEQEGICCAAIAFyNgIAIAIMAQsgAigCCAshACACIAc2AgggACAHNgIMIAcgAjYCDCAHIAA2AggMBAtBHyEAIAdCADcCECAEQf///wdNBEAgBEEIdiIAIABBgP4/akEQdkEIcSICdCIAIABBgOAfakEQdkEEcSIBdCIAIABBgIAPakEQdkECcSIAdEEPdiABIAJyIAByayIAQQF0IAQgAEEVanZBAXFyQRxqIQALIAcgADYCHCAAQQJ0QbgKaiEDAkBBjAgoAgAiAkEBIAB0IgFxRQRAQYwIIAEgAnI2AgAgAyAHNgIAIAcgAzYCGAwBCyAEQQBBGSAAQQF2ayAAQR9GG3QhACADKAIAIQEDQCABIgIoAgRBeHEgBEYNBCAAQR12IQEgAEEBdCEAIAIgAUEEcWoiAygCECIBDQALIAMgBzYCECAHIAI2AhgLIAcgBzYCDCAHIAc2AggMAwsgAygCCCIAIAY2AgwgAyAGNgIIIAZBADYCGCAGIAM2AgwgBiAANgIICyAJQQhqIQAMBQsgAigCCCIAIAc2AgwgAiAHNgIIIAdBADYCGCAHIAI2AgwgByAANgIIC0GUCCgCACIAIAhNDQBBlAggACAIayIBNgIAQaAIQaAIKAIAIgIgCGoiADYCACAAIAFBAXI2AgQgAiAIQQNyNgIEIAJBCGohAAwDC0GECEEwNgIAQQAhAAwCCwJAIAVFDQACQCAEKAIcIgJBAnRBuApqIgAoAgAgBEYEQCAAIAE2AgAgAQ0BQYwIIAlBfiACd3EiCTYCAAwCCyAFQRBBFCAFKAIQIARGG2ogATYCACABRQ0BCyABIAU2AhggBCgCECIABEAgASAANgIQIAAgATYCGAsgBCgCFCIARQ0AIAEgADYCFCAAIAE2AhgLAkAgA0EPTQRAIAQgAyAIaiIAQQNyNgIEIAAgBGoiACAAKAIEQQFyNgIEDAELIAQgCEEDcjYCBCAGIANBAXI2AgQgAyAGaiADNgIAIANB/wFNBEAgA0EDdiIAQQN0QbAIaiECAn9BiAgoAgAiAUEBIAB0IgBxRQRAQYgIIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBjYCCCAAIAY2AgwgBiACNgIMIAYgADYCCAwBC0EfIQAgA0H///8HTQRAIANBCHYiACAAQYD+P2pBEHZBCHEiAnQiACAAQYDgH2pBEHZBBHEiAXQiACAAQYCAD2pBEHZBAnEiAHRBD3YgASACciAAcmsiAEEBdCADIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRBuApqIQICQAJAIAlBASAAdCIBcUUEQEGMCCABIAlyNgIAIAIgBjYCACAGIAI2AhgMAQsgA0EAQRkgAEEBdmsgAEEfRht0IQAgAigCACEIA0AgCCIBKAIEQXhxIANGDQIgAEEddiECIABBAXQhACABIAJBBHFqIgIoAhAiCA0ACyACIAY2AhAgBiABNgIYCyAGIAY2AgwgBiAGNgIIDAELIAEoAggiACAGNgIMIAEgBjYCCCAGQQA2AhggBiABNgIMIAYgADYCCAsgBEEIaiEADAELAkAgC0UNAAJAIAEoAhwiAkECdEG4CmoiACgCACABRgRAIAAgBDYCACAEDQFBjAggBkF+IAJ3cTYCAAwCCyALQRBBFCALKAIQIAFGG2ogBDYCACAERQ0BCyAEIAs2AhggASgCECIABEAgBCAANgIQIAAgBDYCGAsgASgCFCIARQ0AIAQgADYCFCAAIAQ2AhgLAkAgA0EPTQRAIAEgAyAIaiIAQQNyNgIEIAAgAWoiACAAKAIEQQFyNgIEDAELIAEgCEEDcjYCBCAJIANBAXI2AgQgAyAJaiADNgIAIAoEQCAKQQN2IgBBA3RBsAhqIQRBnAgoAgAhAgJ/QQEgAHQiACAFcUUEQEGICCAAIAVyNgIAIAQMAQsgBCgCCAshACAEIAI2AgggACACNgIMIAIgBDYCDCACIAA2AggLQZwIIAk2AgBBkAggAzYCAAsgAUEIaiEACyAMQRBqJAAgAAsQACMAIABrQXBxIgAkACAACwYAIAAkAAsEACMAC4AJAgh/BH4jAEGQAWsiBiQAIAYgBS0AA0EYdEGAgIAYcSAFLwAAIAUtAAJBEHRycjYCACAGIAUoAANBAnZBg/7/H3E2AgQgBiAFKAAGQQR2Qf+B/x9xNgIIIAYgBSgACUEGdkH//8AfcTYCDCAFLwANIQggBS0ADyEJIAZCADcCFCAGQgA3AhwgBkEANgIkIAYgCCAJQRB0QYCAPHFyNgIQIAYgBSgAEDYCKCAGIAUoABQ2AiwgBiAFKAAYNgIwIAUoABwhBSAGQQA6AEwgBkEANgI4IAYgBTYCNCAGIAEgAhAEIAQEQCAGIAMgBBAECyAGKAI4IgEEQCAGQTxqIgIgAWpBAToAACABQQFqQQ9NBEAgASAGakE9aiEEAkBBDyABayIDRQ0AIAMgBGoiAUEBa0EAOgAAIARBADoAACADQQNJDQAgAUECa0EAOgAAIARBADoAASABQQNrQQA6AAAgBEEAOgACIANBB0kNACABQQRrQQA6AAAgBEEAOgADIANBCUkNACAEQQAgBGtBA3EiAWoiBEEANgIAIAQgAyABa0F8cSIBaiIDQQRrQQA2AgAgAUEJSQ0AIARBADYCCCAEQQA2AgQgA0EIa0EANgIAIANBDGtBADYCACABQRlJDQAgBEEANgIYIARBADYCFCAEQQA2AhAgBEEANgIMIANBEGtBADYCACADQRRrQQA2AgAgA0EYa0EANgIAIANBHGtBADYCACABIARBBHFBGHIiAWsiA0EgSQ0AIAEgBGohAQNAIAFCADcDGCABQgA3AxAgAUIANwMIIAFCADcDACABQSBqIQEgA0EgayIDQR9LDQALCwsgBkEBOgBMIAYgAkEQEAILIAY1AjQhECAGNQIwIREgBjUCLCEOIAAgBjUCKCAGKAIkIAYoAiAgBigCHCAGKAIYIgNBGnZqIgJBGnZqIgFBGnZqIgtBgICAYHIgAUH///8fcSINIAJB////H3EiCCAGKAIUIAtBGnZBBWxqIgFB////H3EiCUEFaiIFQRp2IANB////H3EgAUEadmoiA2oiAUEadmoiAkEadmoiBEEadmoiDEEfdSIHIANxIAEgDEEfdkEBayIDQf///x9xIgpxciIBQRp0IAUgCnEgByAJcXJyrXwiDzwAACAAIA9CGIg8AAMgACAPQhCIPAACIAAgD0IIiDwAASAAIA4gByAIcSACIApxciICQRR0IAFBBnZyrXwgD0IgiHwiDjwABCAAIA5CGIg8AAcgACAOQhCIPAAGIAAgDkIIiDwABSAAIBEgByANcSAEIApxciIBQQ50IAJBDHZyrXwgDkIgiHwiDjwACCAAIA5CGIg8AAsgACAOQhCIPAAKIAAgDkIIiDwACSAAIBAgAyAMcSAHIAtxckEIdCABQRJ2cq18IA5CIIh8Ig48AAwgACAOQhiIPAAPIAAgDkIQiDwADiAAIA5CCIg8AA0gBkIANwIwIAZCADcCKCAGQgA3AiAgBkIANwIYIAZCADcCECAGQgA3AgggBkIANwIAIAZBkAFqJAALpwwBB38CQCAARQ0AIABBCGsiAyAAQQRrKAIAIgFBeHEiAGohBQJAIAFBAXENACABQQNxRQ0BIAMgAygCACIBayIDQZgIKAIASQ0BIAAgAWohACADQZwIKAIARwRAIAFB/wFNBEAgAygCCCICIAFBA3YiBEEDdEGwCGpGGiACIAMoAgwiAUYEQEGICEGICCgCAEF+IAR3cTYCAAwDCyACIAE2AgwgASACNgIIDAILIAMoAhghBgJAIAMgAygCDCIBRwRAIAMoAggiAiABNgIMIAEgAjYCCAwBCwJAIANBFGoiAigCACIEDQAgA0EQaiICKAIAIgQNAEEAIQEMAQsDQCACIQcgBCIBQRRqIgIoAgAiBA0AIAFBEGohAiABKAIQIgQNAAsgB0EANgIACyAGRQ0BAkAgAyADKAIcIgJBAnRBuApqIgQoAgBGBEAgBCABNgIAIAENAUGMCEGMCCgCAEF+IAJ3cTYCAAwDCyAGQRBBFCAGKAIQIANGG2ogATYCACABRQ0CCyABIAY2AhggAygCECICBEAgASACNgIQIAIgATYCGAsgAygCFCICRQ0BIAEgAjYCFCACIAE2AhgMAQsgBSgCBCIBQQNxQQNHDQBBkAggADYCACAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAA8LIAMgBU8NACAFKAIEIgFBAXFFDQACQCABQQJxRQRAIAVBoAgoAgBGBEBBoAggAzYCAEGUCEGUCCgCACAAaiIANgIAIAMgAEEBcjYCBCADQZwIKAIARw0DQZAIQQA2AgBBnAhBADYCAA8LIAVBnAgoAgBGBEBBnAggAzYCAEGQCEGQCCgCACAAaiIANgIAIAMgAEEBcjYCBCAAIANqIAA2AgAPCyABQXhxIABqIQACQCABQf8BTQRAIAUoAggiAiABQQN2IgRBA3RBsAhqRhogAiAFKAIMIgFGBEBBiAhBiAgoAgBBfiAEd3E2AgAMAgsgAiABNgIMIAEgAjYCCAwBCyAFKAIYIQYCQCAFIAUoAgwiAUcEQCAFKAIIIgJBmAgoAgBJGiACIAE2AgwgASACNgIIDAELAkAgBUEUaiICKAIAIgQNACAFQRBqIgIoAgAiBA0AQQAhAQwBCwNAIAIhByAEIgFBFGoiAigCACIEDQAgAUEQaiECIAEoAhAiBA0ACyAHQQA2AgALIAZFDQACQCAFIAUoAhwiAkECdEG4CmoiBCgCAEYEQCAEIAE2AgAgAQ0BQYwIQYwIKAIAQX4gAndxNgIADAILIAZBEEEUIAYoAhAgBUYbaiABNgIAIAFFDQELIAEgBjYCGCAFKAIQIgIEQCABIAI2AhAgAiABNgIYCyAFKAIUIgJFDQAgASACNgIUIAIgATYCGAsgAyAAQQFyNgIEIAAgA2ogADYCACADQZwIKAIARw0BQZAIIAA2AgAPCyAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAAsgAEH/AU0EQCAAQQN2IgFBA3RBsAhqIQACf0GICCgCACICQQEgAXQiAXFFBEBBiAggASACcjYCACAADAELIAAoAggLIQIgACADNgIIIAIgAzYCDCADIAA2AgwgAyACNgIIDwtBHyECIANCADcCECAAQf///wdNBEAgAEEIdiIBIAFBgP4/akEQdkEIcSIBdCICIAJBgOAfakEQdkEEcSICdCIEIARBgIAPakEQdkECcSIEdEEPdiABIAJyIARyayIBQQF0IAAgAUEVanZBAXFyQRxqIQILIAMgAjYCHCACQQJ0QbgKaiEBAkACQAJAQYwIKAIAIgRBASACdCIHcUUEQEGMCCAEIAdyNgIAIAEgAzYCACADIAE2AhgMAQsgAEEAQRkgAkEBdmsgAkEfRht0IQIgASgCACEBA0AgASIEKAIEQXhxIABGDQIgAkEddiEBIAJBAXQhAiAEIAFBBHFqIgdBEGooAgAiAQ0ACyAHIAM2AhAgAyAENgIYCyADIAM2AgwgAyADNgIIDAELIAQoAggiACADNgIMIAQgAzYCCCADQQA2AhggAyAENgIMIAMgADYCCAtBqAhBqAgoAgBBAWsiAEF/IAAbNgIACwsLCQEAQYEICwIGUA==";if(!q.startsWith(W)){var G=q;q=r.locateFile?r.locateFile(G,p):p+G}function pa(){var e=q;try{if(e==q&&b)return new Uint8Array(b);var t=H(e);if(t)return t;if(E)return E(e);throw"both async and sync fetching of the wasm failed"}catch(e){K(e)}}function qa(){if(!b&&(u||l)){if("function"===typeof fetch&&!q.startsWith("file://"))return fetch(q,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+q+"'";return e.arrayBuffer()})).catch((function(){return pa()}));if(_)return new Promise((function(e,t){_(q,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return pa()}))}function X(e){for(;0<e.length;){var t=e.shift();if("function"==typeof t)t(r);else{var n=t.m;"number"===typeof n?void 0===t.l?T.get(n)():T.get(n)(t.l):n(void 0===t.l?null:t.l)}}}var $=!1,Y="function"===typeof atob?atob:function(e){var t="",n=0;e=e.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++));var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++));var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++));var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(n++));r=r<<2|i>>4;i=(i&15)<<4|s>>2;var f=(s&3)<<6|o;t+=String.fromCharCode(r);64!==s&&(t+=String.fromCharCode(i));64!==o&&(t+=String.fromCharCode(f))}while(n<e.length);return t};function H(e){if(e.startsWith(W)){e=e.slice(W.length);if("boolean"===typeof h&&h){var t=Buffer.from(e,"base64");t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}else try{var n=Y(e),r=new Uint8Array(n.length);for(e=0;e<n.length;++e)r[e]=n.charCodeAt(e);t=r}catch(e){throw Error("Converting base64 string to bytes failed.")}return t}}var j={a:function(e){var t=O.length;e>>>=0;if(2147483648<e)return!1;for(var n=1;4>=n;n*=2){var r=t*(1+.2/n);r=Math.min(r,e+100663296);r=Math.max(e,r);0<r%65536&&(r+=65536-r%65536);e:{try{C.grow(Math.min(2147483648,r)-B.byteLength+65535>>>16);ia();var i=1;break e}catch(e){}i=void 0}if(i)return!0}return!1}};(function(){function a(e){r.asm=e.exports;C=r.asm.b;ia();T=r.asm.j;L.unshift(r.asm.c);D--;r.monitorRunDependencies&&r.monitorRunDependencies(D);0==D&&(null!==Q&&(clearInterval(Q),Q=null),x&&(e=x,x=null,e()))}function c(e){a(e.instance)}function d(t){return qa().then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){I("failed to asynchronously prepare wasm: "+e);K(e)}))}var e={a:j};D++;r.monitorRunDependencies&&r.monitorRunDependencies(D);if(r.instantiateWasm)try{return r.instantiateWasm(e,a)}catch(e){return I("Module.instantiateWasm callback failed with error: "+e),!1}(function(){return b||"function"!==typeof WebAssembly.instantiateStreaming||q.startsWith(W)||q.startsWith("file://")||"function"!==typeof fetch?d(c):fetch(q,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(c,(function(e){I("wasm streaming compile failed: "+e);I("falling back to ArrayBuffer instantiation");return d(c)}))}))})().catch(s);return{}})();r.___wasm_call_ctors=function(){return(r.___wasm_call_ctors=r.asm.c).apply(null,arguments)};r._poly1305_auth=function(){return(r._poly1305_auth=r.asm.d).apply(null,arguments)};var V=r.stackSave=function(){return(V=r.stackSave=r.asm.e).apply(null,arguments)},z=r.stackRestore=function(){return(z=r.stackRestore=r.asm.f).apply(null,arguments)},J=r.stackAlloc=function(){return(J=r.stackAlloc=r.asm.g).apply(null,arguments)};r._malloc=function(){return(r._malloc=r.asm.h).apply(null,arguments)};r._free=function(){return(r._free=r.asm.i).apply(null,arguments)};r.cwrap=function(e,t,n,r){n=n||[];var i=n.every((function(e){return"number"===e}));return"string"!==t&&i&&!r?N(e):function(){return ca(e,t,n,arguments)}};var ee;x=function ta(){ee||Z();ee||(x=ta)};function Z(){function a(){if(!ee&&(ee=!0,r.calledRun=!0,!k)){X(L);i(r);if(r.onRuntimeInitialized)r.onRuntimeInitialized();if(r.postRun)for("function"==typeof r.postRun&&(r.postRun=[r.postRun]);r.postRun.length;){var e=r.postRun.shift();U.unshift(e)}X(U)}}if(!(0<D)){if(r.preRun)for("function"==typeof r.preRun&&(r.preRun=[r.preRun]);r.preRun.length;)ma();X(P);0<D||(r.setStatus?(r.setStatus("Running..."),setTimeout((function(){setTimeout((function(){r.setStatus("")}),1);a()}),1)):a())}}r.run=Z;if(r.preInit)for("function"==typeof r.preInit&&(r.preInit=[r.preInit]);0<r.preInit.length;)r.preInit.pop()();Z();return t.ready}}();if(true)e.exports=r;else{}},172:(e,t,n)=>{"use strict";const r=new Array(256);[n(4126).HANDLERS,n(6475)].forEach((e=>{for(let[t,n]of Object.entries(e)){t=+t;if(isFinite(t)&&t>=0&&t<r.length)r[t]=n}}));e.exports=r},6475:(e,t,n)=>{"use strict";const{bufferSlice:r,bufferParser:i,doFatalError:s,sigSSHToASN1:o,writeUInt32BE:f}=n(9475);const{CHANNEL_OPEN_FAILURE:u,COMPAT:l,MESSAGE:h,TERMINAL_MODE:p}=n(6832);const{parseKey:g}=n(2218);const _=Array.from(Object.entries(p)).reduce(((e,[t,n])=>({...e,[t]:n})),{});e.exports={[h.DISCONNECT]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();const r=i.readString(true);const o=i.readString();i.clear();if(o===undefined){return s(e,"Inbound: Malformed DISCONNECT packet")}e._debug&&e._debug(`Inbound: Received DISCONNECT (${n}, "${r}")`);const f=e._handlers.DISCONNECT;f&&f(e,n,r)},[h.IGNORE]:(e,t)=>{e._debug&&e._debug("Inbound: Received IGNORE")},[h.UNIMPLEMENTED]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();i.clear();if(n===undefined){return s(e,"Inbound: Malformed UNIMPLEMENTED packet")}e._debug&&e._debug(`Inbound: Received UNIMPLEMENTED (seqno ${n})`)},[h.DEBUG]:(e,t)=>{i.init(t,1);const n=i.readBool();const r=i.readString(true);const o=i.readString();i.clear();if(o===undefined){return s(e,"Inbound: Malformed DEBUG packet")}e._debug&&e._debug("Inbound: Received DEBUG");const f=e._handlers.DEBUG;f&&f(e,n,r)},[h.SERVICE_REQUEST]:(e,t)=>{i.init(t,1);const n=i.readString(true);i.clear();if(n===undefined){return s(e,"Inbound: Malformed SERVICE_REQUEST packet")}e._debug&&e._debug(`Inbound: Received SERVICE_REQUEST (${n})`);const r=e._handlers.SERVICE_REQUEST;r&&r(e,n)},[h.SERVICE_ACCEPT]:(e,t)=>{i.init(t,1);const n=i.readString(true);i.clear();if(n===undefined){return s(e,"Inbound: Malformed SERVICE_ACCEPT packet")}e._debug&&e._debug(`Inbound: Received SERVICE_ACCEPT (${n})`);const r=e._handlers.SERVICE_ACCEPT;r&&r(e,n)},[h.USERAUTH_REQUEST]:(e,t)=>{i.init(t,1);const n=i.readString(true);const u=i.readString(true);const l=i.readString(true);let h;let p;switch(l){case"none":h=null;break;case"password":{const e=i.readBool();if(e!==undefined){h=i.readString(true);if(h!==undefined&&e){const e=i.readString(true);if(e!==undefined)h={oldPassword:h,newPassword:e};else h=undefined}}break}case"publickey":{const n=i.readBool();if(n!==undefined){const s=i.readString(true);const u=i.readString();if(n){const n=i.pos();let l=i.readString();if(l!==undefined){if(l.length>4+s.length+4&&l.utf8Slice(4,4+s.length)===s){l=r(l,4+s.length+4)}l=o(l,s);if(l){const r=e._kex.sessionID;const i=Buffer.allocUnsafe(4+r.length+n);f(i,r.length,0);i.set(r,4);i.set(new Uint8Array(t.buffer,t.byteOffset,n),4+r.length);h={keyAlgo:s,key:u,signature:l,blob:i}}}}else{h={keyAlgo:s,key:u};p="publickey -- check"}}break}case"hostbased":{const n=i.readString(true);const s=i.readString();const u=i.readString(true);const l=i.readString(true);const p=i.pos();let g=i.readString();if(g!==undefined){if(g.length>4+n.length+4&&g.utf8Slice(4,4+n.length)===n){g=r(g,4+n.length+4)}g=o(g,n);if(g!==undefined){const r=e._kex.sessionID;const i=Buffer.allocUnsafe(4+r.length+p);f(i,r.length,0);i.set(r,4);i.set(new Uint8Array(t.buffer,t.byteOffset,p),4+r.length);h={keyAlgo:n,key:s,signature:g,blob:i,localHostname:u,localUsername:l}}}break}case"keyboard-interactive":i.skipString();h=i.readList();break;default:if(l!==undefined)h=i.readRaw()}i.clear();if(h===undefined){return s(e,"Inbound: Malformed USERAUTH_REQUEST packet")}if(p===undefined)p=l;e._authsQueue.push(l);e._debug&&e._debug(`Inbound: Received USERAUTH_REQUEST (${p})`);const g=e._handlers.USERAUTH_REQUEST;g&&g(e,n,u,l,h)},[h.USERAUTH_FAILURE]:(e,t)=>{i.init(t,1);const n=i.readList();const r=i.readBool();i.clear();if(r===undefined){return s(e,"Inbound: Malformed USERAUTH_FAILURE packet")}e._debug&&e._debug(`Inbound: Received USERAUTH_FAILURE (${n})`);e._authsQueue.shift();const o=e._handlers.USERAUTH_FAILURE;o&&o(e,n,r)},[h.USERAUTH_SUCCESS]:(e,t)=>{e._debug&&e._debug("Inbound: Received USERAUTH_SUCCESS");e._authsQueue.shift();const n=e._handlers.USERAUTH_SUCCESS;n&&n(e)},[h.USERAUTH_BANNER]:(e,t)=>{i.init(t,1);const n=i.readString(true);const r=i.readString();i.clear();if(r===undefined){return s(e,"Inbound: Malformed USERAUTH_BANNER packet")}e._debug&&e._debug("Inbound: Received USERAUTH_BANNER");const o=e._handlers.USERAUTH_BANNER;o&&o(e,n)},60:(e,t)=>{if(!e._authsQueue.length){e._debug&&e._debug("Inbound: Received payload type 60 without auth");return}switch(e._authsQueue[0]){case"password":{i.init(t,1);const n=i.readString(true);const r=i.readString();i.clear();if(r===undefined){return s(e,"Inbound: Malformed USERAUTH_PASSWD_CHANGEREQ packet")}e._debug&&e._debug("Inbound: Received USERAUTH_PASSWD_CHANGEREQ");const o=e._handlers.USERAUTH_PASSWD_CHANGEREQ;o&&o(e,n);break}case"publickey":{i.init(t,1);const n=i.readString(true);const r=i.readString();i.clear();if(r===undefined){return s(e,"Inbound: Malformed USERAUTH_PK_OK packet")}e._debug&&e._debug("Inbound: Received USERAUTH_PK_OK");e._authsQueue.shift();const o=e._handlers.USERAUTH_PK_OK;o&&o(e,n,r);break}case"keyboard-interactive":{i.init(t,1);const n=i.readString(true);const r=i.readString(true);i.readString();const o=i.readUInt32BE();let f;if(o!==undefined){f=new Array(o);let e;for(e=0;e<o;++e){const t=i.readString(true);const n=i.readBool();if(n===undefined)break;f[e]={prompt:t,echo:n}}if(e!==o)f=undefined}i.clear();if(f===undefined){return s(e,"Inbound: Malformed USERAUTH_INFO_REQUEST packet")}e._debug&&e._debug("Inbound: Received USERAUTH_INFO_REQUEST");const u=e._handlers.USERAUTH_INFO_REQUEST;u&&u(e,n,r,f);break}default:e._debug&&e._debug("Inbound: Received unexpected payload type 60")}},61:(e,t)=>{if(!e._authsQueue.length){e._debug&&e._debug("Inbound: Received payload type 61 without auth");return}if(e._authsQueue[0]!=="keyboard-interactive"){return s(e,"Inbound: Received unexpected payload type 61")}i.init(t,1);const n=i.readUInt32BE();let r;if(n!==undefined){r=new Array(n);let e;for(e=0;e<n;++e){const t=i.readString(true);if(t===undefined)break;r[e]=t}if(e!==n)r=undefined}i.clear();if(r===undefined){return s(e,"Inbound: Malformed USERAUTH_INFO_RESPONSE packet")}e._debug&&e._debug("Inbound: Received USERAUTH_INFO_RESPONSE");const o=e._handlers.USERAUTH_INFO_RESPONSE;o&&o(e,r)},[h.GLOBAL_REQUEST]:(e,t)=>{i.init(t,1);const n=i.readString(true);const r=i.readBool();let o;if(r!==undefined){switch(n){case"tcpip-forward":case"cancel-tcpip-forward":{const e=i.readString(true);const t=i.readUInt32BE();if(t!==undefined)o={bindAddr:e,bindPort:t};break}case"streamlocal-forward@openssh.com":case"cancel-streamlocal-forward@openssh.com":{const e=i.readString(true);if(e!==undefined)o={socketPath:e};break}case"no-more-sessions@openssh.com":o=null;break;case"hostkeys-00@openssh.com":{o=[];while(i.avail()>0){const e=i.readString();if(e===undefined){o=undefined;break}const t=g(e);if(!(t instanceof Error))o.push(t)}break}default:o=i.readRaw()}}i.clear();if(o===undefined){return s(e,"Inbound: Malformed GLOBAL_REQUEST packet")}e._debug&&e._debug(`Inbound: GLOBAL_REQUEST (${n})`);const f=e._handlers.GLOBAL_REQUEST;if(f)f(e,n,r,o);else e.requestFailure()},[h.REQUEST_SUCCESS]:(e,t)=>{const n=t.length>1?r(t,1):null;e._debug&&e._debug("Inbound: REQUEST_SUCCESS");const i=e._handlers.REQUEST_SUCCESS;i&&i(e,n)},[h.REQUEST_FAILURE]:(e,t)=>{e._debug&&e._debug("Inbound: Received REQUEST_FAILURE");const n=e._handlers.REQUEST_FAILURE;n&&n(e)},[h.CHANNEL_OPEN]:(e,t)=>{i.init(t,1);const n=i.readString(true);const r=i.readUInt32BE();const o=i.readUInt32BE();const f=i.readUInt32BE();let l;switch(n){case"forwarded-tcpip":case"direct-tcpip":{const e=i.readString(true);const t=i.readUInt32BE();const s=i.readString(true);const u=i.readUInt32BE();if(u!==undefined){l={type:n,sender:r,window:o,packetSize:f,data:{destIP:e,destPort:t,srcIP:s,srcPort:u}}}break}case"forwarded-streamlocal@openssh.com":case"direct-streamlocal@openssh.com":{const e=i.readString(true);if(e!==undefined){l={type:n,sender:r,window:o,packetSize:f,data:{socketPath:e}}}break}case"x11":{const e=i.readString(true);const t=i.readUInt32BE();if(t!==undefined){l={type:n,sender:r,window:o,packetSize:f,data:{srcIP:e,srcPort:t}}}break}default:l={type:n,sender:r,window:o,packetSize:f,data:{}}}i.clear();if(l===undefined){return s(e,"Inbound: Malformed CHANNEL_OPEN packet")}e._debug&&e._debug(`Inbound: CHANNEL_OPEN (s:${r}, ${n})`);const h=e._handlers.CHANNEL_OPEN;if(h){h(e,l)}else{e.channelOpenFail(l.sender,u.ADMINISTRATIVELY_PROHIBITED,"","")}},[h.CHANNEL_OPEN_CONFIRMATION]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();const r=i.readUInt32BE();const o=i.readUInt32BE();const f=i.readUInt32BE();const u=i.avail()?i.readRaw():undefined;i.clear();if(f===undefined){return s(e,"Inbound: Malformed CHANNEL_OPEN_CONFIRMATION packet")}e._debug&&e._debug(`Inbound: CHANNEL_OPEN_CONFIRMATION (r:${n}, s:${r})`);const l=e._handlers.CHANNEL_OPEN_CONFIRMATION;if(l)l(e,{recipient:n,sender:r,window:o,packetSize:f,data:u})},[h.CHANNEL_OPEN_FAILURE]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();const r=i.readUInt32BE();const o=i.readString(true);const f=i.readString();i.clear();if(f===undefined){return s(e,"Inbound: Malformed CHANNEL_OPEN_FAILURE packet")}e._debug&&e._debug(`Inbound: CHANNEL_OPEN_FAILURE (r:${n})`);const u=e._handlers.CHANNEL_OPEN_FAILURE;u&&u(e,n,r,o)},[h.CHANNEL_WINDOW_ADJUST]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();const r=i.readUInt32BE();i.clear();if(r===undefined){return s(e,"Inbound: Malformed CHANNEL_WINDOW_ADJUST packet")}e._debug&&e._debug(`Inbound: CHANNEL_WINDOW_ADJUST (r:${n}, ${r})`);const o=e._handlers.CHANNEL_WINDOW_ADJUST;o&&o(e,n,r)},[h.CHANNEL_DATA]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();const r=i.readString();i.clear();if(r===undefined){return s(e,"Inbound: Malformed CHANNEL_DATA packet")}e._debug&&e._debug(`Inbound: CHANNEL_DATA (r:${n}, ${r.length})`);const o=e._handlers.CHANNEL_DATA;o&&o(e,n,r)},[h.CHANNEL_EXTENDED_DATA]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();const r=i.readUInt32BE();const o=i.readString();i.clear();if(o===undefined){return s(e,"Inbound: Malformed CHANNEL_EXTENDED_DATA packet")}e._debug&&e._debug(`Inbound: CHANNEL_EXTENDED_DATA (r:${n}, ${o.length})`);const f=e._handlers.CHANNEL_EXTENDED_DATA;f&&f(e,n,o,r)},[h.CHANNEL_EOF]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();i.clear();if(n===undefined){return s(e,"Inbound: Malformed CHANNEL_EOF packet")}e._debug&&e._debug(`Inbound: CHANNEL_EOF (r:${n})`);const r=e._handlers.CHANNEL_EOF;r&&r(e,n)},[h.CHANNEL_CLOSE]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();i.clear();if(n===undefined){return s(e,"Inbound: Malformed CHANNEL_CLOSE packet")}e._debug&&e._debug(`Inbound: CHANNEL_CLOSE (r:${n})`);const r=e._handlers.CHANNEL_CLOSE;r&&r(e,n)},[h.CHANNEL_REQUEST]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();const r=i.readString(true);const o=i.readBool();let f;if(o!==undefined){switch(r){case"exit-status":f=i.readUInt32BE();e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r}: ${f})`);break;case"exit-signal":{let t;let s;if(e._compatFlags&l.OLD_EXIT){const e=i.readUInt32BE();switch(e){case 1:t="HUP";break;case 2:t="INT";break;case 3:t="QUIT";break;case 6:t="ABRT";break;case 9:t="KILL";break;case 14:t="ALRM";break;case 15:t="TERM";break;default:if(e!==undefined){t=`UNKNOWN (${e})`}}s=false}else{t=i.readString(true);s=i.readBool();if(s===undefined)t=undefined}const o=i.readString(true);if(i.skipString()!==undefined)f={signal:t,coreDumped:s,errorMessage:o};e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r}: ${t})`);break}case"pty-req":{const t=i.readString(true);const s=i.readUInt32BE();const o=i.readUInt32BE();const u=i.readUInt32BE();const l=i.readUInt32BE();const h=i.readString();if(h!==undefined){i.init(h,1);let e={};while(i.avail()){const t=i.readByte();if(t===p.TTY_OP_END)break;const n=_[t];const r=i.readUInt32BE();if(t===undefined||n===undefined||r===undefined){e=undefined;break}e[n]=r}if(e!==undefined)f={term:t,cols:s,rows:o,width:u,height:l,modes:e}}e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r})`);break}case"window-change":{const t=i.readUInt32BE();const s=i.readUInt32BE();const o=i.readUInt32BE();const u=i.readUInt32BE();if(u!==undefined)f={cols:t,rows:s,width:o,height:u};e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r})`);break}case"x11-req":{const t=i.readBool();const s=i.readString(true);const o=i.readString();const u=i.readUInt32BE();if(u!==undefined)f={single:t,protocol:s,cookie:o,screen:u};e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r})`);break}case"env":{const t=i.readString(true);const s=i.readString(true);if(s!==undefined)f={name:t,value:s};if(e._debug){e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r}: `+`${t}=${s})`)}break}case"shell":f=null;e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r})`);break;case"exec":f=i.readString(true);e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r}: ${f})`);break;case"subsystem":f=i.readString(true);e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r}: ${f})`);break;case"signal":f=i.readString(true);e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r}: ${f})`);break;case"xon-xoff":f=i.readBool();e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r}: ${f})`);break;case"auth-agent-req@openssh.com":f=null;e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r})`);break;default:f=i.avail()?i.readRaw():null;e._debug&&e._debug(`Inbound: CHANNEL_REQUEST (r:${n}, ${r})`)}}i.clear();if(f===undefined){return s(e,"Inbound: Malformed CHANNEL_REQUEST packet")}const u=e._handlers.CHANNEL_REQUEST;u&&u(e,n,r,o,f)},[h.CHANNEL_SUCCESS]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();i.clear();if(n===undefined){return s(e,"Inbound: Malformed CHANNEL_SUCCESS packet")}e._debug&&e._debug(`Inbound: CHANNEL_SUCCESS (r:${n})`);const r=e._handlers.CHANNEL_SUCCESS;r&&r(e,n)},[h.CHANNEL_FAILURE]:(e,t)=>{i.init(t,1);const n=i.readUInt32BE();i.clear();if(n===undefined){return s(e,"Inbound: Malformed CHANNEL_FAILURE packet")}e._debug&&e._debug(`Inbound: CHANNEL_FAILURE (r:${n})`);const r=e._handlers.CHANNEL_FAILURE;r&&r(e,n)}}},4126:(e,t,n)=>{"use strict";const{createDiffieHellman:r,createDiffieHellmanGroup:i,createECDH:s,createHash:o,createPublicKey:f,diffieHellman:u,generateKeyPairSync:l,randomFillSync:h}=n(6113);const{Ber:p}=n(970);const{COMPAT:g,curve25519Supported:_,DEFAULT_KEX:E,DEFAULT_SERVER_HOST_KEY:y,DEFAULT_CIPHER:m,DEFAULT_MAC:I,DEFAULT_COMPRESSION:b,DISCONNECT_REASON:w,MESSAGE:C}=n(6832);const{CIPHER_INFO:k,createCipher:R,createDecipher:B,MAC_INFO:v}=n(5708);const{parseDERKey:O}=n(2218);const{bufferFill:T,bufferParser:P,convertSignature:L,doFatalError:U,FastBuffer:D,sigSSHToASN1:Q,writeUInt32BE:x}=n(9475);const{PacketReader:W,PacketWriter:q,ZlibPacketReader:G,ZlibPacketWriter:$}=n(6715);let Y;const j=2048;const V=8192;const z=Buffer.alloc(0);function kexinit(e){let t;if(e._compatFlags&g.BAD_DHGEX){const n=e._offer.lists.kex;let r=n.array;let i=false;for(let e=0;e<r.length;++e){if(r[e].includes("group-exchange")){if(!i){i=true;r=r.slice()}r.splice(e--,1)}}if(i){let i=1+16+e._offer.totalSize+1+4;const s=Buffer.from(r.join(","));i-=n.buffer.length-s.length;const o=e._offer.lists.all;const f=new Uint8Array(o.buffer,o.byteOffset+4+n.buffer.length,o.length-(4+n.buffer.length));t=Buffer.allocUnsafe(i);x(t,s.length,17);t.set(s,17+4);t.set(f,17+4+s.length)}}if(t===undefined){t=Buffer.allocUnsafe(1+16+e._offer.totalSize+1+4);e._offer.copyAllTo(t,17)}e._debug&&e._debug("Outbound: Sending KEXINIT");t[0]=C.KEXINIT;h(t,1,16);T(t,0,t.length-5);e._kexinit=t;e._packetRW.write.allocStart=0;{const n=e._packetRW.write.allocStartKEX;const r=e._packetRW.write.alloc(t.length,true);r.set(t,n);e._cipher.encrypt(e._packetRW.write.finalize(r,true))}}function handleKexInit(e,t){const n={kex:undefined,serverHostKey:undefined,cs:{cipher:undefined,mac:undefined,compress:undefined,lang:undefined},sc:{cipher:undefined,mac:undefined,compress:undefined,lang:undefined}};P.init(t,17);if((n.kex=P.readList())===undefined||(n.serverHostKey=P.readList())===undefined||(n.cs.cipher=P.readList())===undefined||(n.sc.cipher=P.readList())===undefined||(n.cs.mac=P.readList())===undefined||(n.sc.mac=P.readList())===undefined||(n.cs.compress=P.readList())===undefined||(n.sc.compress=P.readList())===undefined||(n.cs.lang=P.readList())===undefined||(n.sc.lang=P.readList())===undefined){P.clear();return U(e,"Received malformed KEXINIT","handshake",w.KEY_EXCHANGE_FAILED)}const r=P.pos();const i=r<t.length&&t[r]===1;P.clear();const s=e._offer;const o=n;let f=s.lists.kex.array;if(e._compatFlags&g.BAD_DHGEX){let e=false;for(let t=0;t<f.length;++t){if(f[t].indexOf("group-exchange")!==-1){if(!e){e=true;f=f.slice()}f.splice(t--,1)}}}let u;let l;let h;const p=e._debug;p&&p("Inbound: Handshake in progress");p&&p(`Handshake: (local) KEX method: ${f}`);p&&p(`Handshake: (remote) KEX method: ${o.kex}`);if(e._server){l=f;u=o.kex}else{l=o.kex;u=f}for(h=0;h<u.length&&l.indexOf(u[h])===-1;++h);if(h===u.length){p&&p("Handshake: No matching key exchange algorithm");return U(e,"Handshake failed: no matching key exchange algorithm","handshake",w.KEY_EXCHANGE_FAILED)}n.kex=u[h];p&&p(`Handshake: KEX algorithm: ${u[h]}`);if(i&&(!o.kex.length||u[h]!==o.kex[0])){e._skipNextInboundPacket=true}const _=s.lists.serverHostKey.array;p&&p(`Handshake: (local) Host key format: ${_}`);p&&p(`Handshake: (remote) Host key format: ${o.serverHostKey}`);if(e._server){l=_;u=o.serverHostKey}else{l=o.serverHostKey;u=_}for(h=0;h<u.length&&l.indexOf(u[h])===-1;++h);if(h===u.length){p&&p("Handshake: No matching host key format");return U(e,"Handshake failed: no matching host key format","handshake",w.KEY_EXCHANGE_FAILED)}n.serverHostKey=u[h];p&&p(`Handshake: Host key format: ${u[h]}`);const E=s.lists.cs.cipher.array;p&&p(`Handshake: (local) C->S cipher: ${E}`);p&&p(`Handshake: (remote) C->S cipher: ${o.cs.cipher}`);if(e._server){l=E;u=o.cs.cipher}else{l=o.cs.cipher;u=E}for(h=0;h<u.length&&l.indexOf(u[h])===-1;++h);if(h===u.length){p&&p("Handshake: No matching C->S cipher");return U(e,"Handshake failed: no matching C->S cipher","handshake",w.KEY_EXCHANGE_FAILED)}n.cs.cipher=u[h];p&&p(`Handshake: C->S Cipher: ${u[h]}`);const y=s.lists.sc.cipher.array;p&&p(`Handshake: (local) S->C cipher: ${y}`);p&&p(`Handshake: (remote) S->C cipher: ${o.sc.cipher}`);if(e._server){l=y;u=o.sc.cipher}else{l=o.sc.cipher;u=y}for(h=0;h<u.length&&l.indexOf(u[h])===-1;++h);if(h===u.length){p&&p("Handshake: No matching S->C cipher");return U(e,"Handshake failed: no matching S->C cipher","handshake",w.KEY_EXCHANGE_FAILED)}n.sc.cipher=u[h];p&&p(`Handshake: S->C cipher: ${u[h]}`);const m=s.lists.cs.mac.array;p&&p(`Handshake: (local) C->S MAC: ${m}`);p&&p(`Handshake: (remote) C->S MAC: ${o.cs.mac}`);if(k[n.cs.cipher].authLen>0){n.cs.mac="";p&&p("Handshake: C->S MAC: <implicit>")}else{if(e._server){l=m;u=o.cs.mac}else{l=o.cs.mac;u=m}for(h=0;h<u.length&&l.indexOf(u[h])===-1;++h);if(h===u.length){p&&p("Handshake: No matching C->S MAC");return U(e,"Handshake failed: no matching C->S MAC","handshake",w.KEY_EXCHANGE_FAILED)}n.cs.mac=u[h];p&&p(`Handshake: C->S MAC: ${u[h]}`)}const I=s.lists.sc.mac.array;p&&p(`Handshake: (local) S->C MAC: ${I}`);p&&p(`Handshake: (remote) S->C MAC: ${o.sc.mac}`);if(k[n.sc.cipher].authLen>0){n.sc.mac="";p&&p("Handshake: S->C MAC: <implicit>")}else{if(e._server){l=I;u=o.sc.mac}else{l=o.sc.mac;u=I}for(h=0;h<u.length&&l.indexOf(u[h])===-1;++h);if(h===u.length){p&&p("Handshake: No matching S->C MAC");return U(e,"Handshake failed: no matching S->C MAC","handshake",w.KEY_EXCHANGE_FAILED)}n.sc.mac=u[h];p&&p(`Handshake: S->C MAC: ${u[h]}`)}const b=s.lists.cs.compress.array;p&&p(`Handshake: (local) C->S compression: ${b}`);p&&p(`Handshake: (remote) C->S compression: ${o.cs.compress}`);if(e._server){l=b;u=o.cs.compress}else{l=o.cs.compress;u=b}for(h=0;h<u.length&&l.indexOf(u[h])===-1;++h);if(h===u.length){p&&p("Handshake: No matching C->S compression");return U(e,"Handshake failed: no matching C->S compression","handshake",w.KEY_EXCHANGE_FAILED)}n.cs.compress=u[h];p&&p(`Handshake: C->S compression: ${u[h]}`);const C=s.lists.sc.compress.array;p&&p(`Handshake: (local) S->C compression: ${C}`);p&&p(`Handshake: (remote) S->C compression: ${o.sc.compress}`);if(e._server){l=C;u=o.sc.compress}else{l=o.sc.compress;u=C}for(h=0;h<u.length&&l.indexOf(u[h])===-1;++h);if(h===u.length){p&&p("Handshake: No matching S->C compression");return U(e,"Handshake failed: no matching S->C compression","handshake",w.KEY_EXCHANGE_FAILED)}n.sc.compress=u[h];p&&p(`Handshake: S->C compression: ${u[h]}`);n.cs.lang="";n.sc.lang="";if(e._kex){if(!e._kexinit){kexinit(e)}e._decipher._onPayload=onKEXPayload.bind(e,{firstPacket:false})}e._kex=J(n,e,t);e._kex.start()}const J=(()=>{function convertToMpint(e){let t=0;let n=e.length;while(e[t]===0){++t;--n}let r;if(e[t]&128){r=Buffer.allocUnsafe(1+n);r[0]=0;e.copy(r,1,t);e=r}else if(n!==e.length){r=Buffer.allocUnsafe(n);e.copy(r,0,t);e=r}return e}class KeyExchange{constructor(e,t,n){this._protocol=t;this.sessionID=t._kex?t._kex.sessionID:undefined;this.negotiated=e;this._step=1;this._public=null;this._dh=null;this._sentNEWKEYS=false;this._receivedNEWKEYS=false;this._finished=false;this._hostVerified=false;this._kexinit=t._kexinit;this._remoteKexinit=n;this._identRaw=t._identRaw;this._remoteIdentRaw=t._remoteIdentRaw;this._hostKey=undefined;this._dhData=undefined;this._sig=undefined}finish(){if(this._finished)return false;this._finished=true;const e=this._protocol._server;const t=this.negotiated;const n=this.convertPublicKey(this._dhData);let r=this.computeSecret(this._dhData);if(r instanceof Error){r.message=`Error while computing DH secret (${this.type}): ${r.message}`;r.level="handshake";return U(this._protocol,r,w.KEY_EXCHANGE_FAILED)}const i=o(this.hashName);te(i,e?this._remoteIdentRaw:this._identRaw);te(i,e?this._identRaw:this._remoteIdentRaw);te(i,e?this._remoteKexinit:this._kexinit);te(i,e?this._kexinit:this._remoteKexinit);const s=e?this._hostKey.getPublicSSH():this._hostKey;te(i,s);if(this.type==="groupex"){const e=this.getDHParams();const t=Buffer.allocUnsafe(4);x(t,this._minBits,0);i.update(t);x(t,this._prefBits,0);i.update(t);x(t,this._maxBits,0);i.update(t);te(i,e.prime);te(i,e.generator)}te(i,e?n:this.getPublicKey());const f=e?this.getPublicKey():n;te(i,f);te(i,r);const u=i.digest();if(!e){P.init(this._sig,0);const e=P.readString(true);if(!e){return U(this._protocol,"Malformed packet while reading signature","handshake",w.KEY_EXCHANGE_FAILED)}if(e!==t.serverHostKey){return U(this._protocol,`Wrong signature type: ${e}, `+`expected: ${t.serverHostKey}`,"handshake",w.KEY_EXCHANGE_FAILED)}let n=P.readString();P.clear();if(n===undefined){return U(this._protocol,"Malformed packet while reading signature","handshake",w.KEY_EXCHANGE_FAILED)}if(!(n=Q(n,e))){return U(this._protocol,"Malformed signature","handshake",w.KEY_EXCHANGE_FAILED)}let r;{P.init(this._hostKey,0);const e=P.readString(true);const t=this._hostKey.slice(P.pos());P.clear();r=O(t,e);if(r instanceof Error){r.level="handshake";return U(this._protocol,r,w.KEY_EXCHANGE_FAILED)}}let i;switch(this.negotiated.serverHostKey){case"rsa-sha2-256":i="sha256";break;case"rsa-sha2-512":i="sha512";break}this._protocol._debug&&this._protocol._debug("Verifying signature ...");const s=r.verify(u,n,i);if(s!==true){if(s instanceof Error){this._protocol._debug&&this._protocol._debug(`Signature verification failed: ${s.stack}`)}else{this._protocol._debug&&this._protocol._debug("Signature verification failed")}return U(this._protocol,"Handshake failed: signature verification failed","handshake",w.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Verified signature")}else{let e;switch(this.negotiated.serverHostKey){case"rsa-sha2-256":e="sha256";break;case"rsa-sha2-512":e="sha512";break}this._protocol._debug&&this._protocol._debug("Generating signature ...");let t=this._hostKey.sign(u,e);if(t instanceof Error){return U(this._protocol,"Handshake failed: signature generation failed for "+`${this._hostKey.type} host key: ${t.message}`,"handshake",w.KEY_EXCHANGE_FAILED)}t=L(t,this._hostKey.type);if(t===false){return U(this._protocol,"Handshake failed: signature conversion failed for "+`${this._hostKey.type} host key`,"handshake",w.KEY_EXCHANGE_FAILED)}const n=this.negotiated.serverHostKey;const r=Buffer.byteLength(n);const i=4+r+4+t.length;let o=this._protocol._packetRW.write.allocStartKEX;const l=this._protocol._packetRW.write.alloc(1+4+s.length+4+f.length+4+i,true);l[o]=C.KEXDH_REPLY;x(l,s.length,++o);l.set(s,o+=4);x(l,f.length,o+=s.length);l.set(f,o+=4);x(l,i,o+=f.length);x(l,r,o+=4);l.utf8Write(n,o+=4,r);x(l,t.length,o+=r);l.set(t,o+=4);if(this._protocol._debug){let e;switch(this.type){case"group":e="KEXDH_REPLY";break;case"groupex":e="KEXDH_GEX_REPLY";break;default:e="KEXECDH_REPLY"}this._protocol._debug(`Outbound: Sending ${e}`)}this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(l,true))}trySendNEWKEYS(this);const completeHandshake=()=>{if(!this.sessionID)this.sessionID=u;{const e=Buffer.allocUnsafe(4+r.length);x(e,r.length,0);e.set(r,4);r=e}const n=k[t.cs.cipher];const i=k[t.sc.cipher];const s=generateKEXVal(n.ivLen,this.hashName,r,u,this.sessionID,"A");const o=generateKEXVal(i.ivLen,this.hashName,r,u,this.sessionID,"B");const f=generateKEXVal(n.keyLen,this.hashName,r,u,this.sessionID,"C");const l=generateKEXVal(i.keyLen,this.hashName,r,u,this.sessionID,"D");let h;let p;if(!n.authLen){h=v[t.cs.mac];p=generateKEXVal(h.len,this.hashName,r,u,this.sessionID,"E")}let g;let _;if(!i.authLen){g=v[t.sc.mac];_=generateKEXVal(g.len,this.hashName,r,u,this.sessionID,"F")}const E={inbound:{onPayload:this._protocol._onPayload,seqno:this._protocol._decipher.inSeqno,decipherInfo:!e?i:n,decipherIV:!e?o:s,decipherKey:!e?l:f,macInfo:!e?g:h,macKey:!e?_:p},outbound:{onWrite:this._protocol._onWrite,seqno:this._protocol._cipher.outSeqno,cipherInfo:e?i:n,cipherIV:e?o:s,cipherKey:e?l:f,macInfo:e?g:h,macKey:e?_:p}};this._protocol._cipher&&this._protocol._cipher.free();this._protocol._decipher&&this._protocol._decipher.free();this._protocol._cipher=R(E);this._protocol._decipher=B(E);const y={read:undefined,write:undefined};switch(t.cs.compress){case"zlib":if(e)y.read=new G;else y.write=new $(this._protocol);break;case"zlib@openssh.com":if(this._protocol._authenticated){if(e)y.read=new G;else y.write=new $(this._protocol);break}default:if(e)y.read=new W;else y.write=new q(this._protocol)}switch(t.sc.compress){case"zlib":if(e)y.write=new $(this._protocol);else y.read=new G;break;case"zlib@openssh.com":if(this._protocol._authenticated){if(e)y.write=new $(this._protocol);else y.read=new G;break}default:if(e)y.write=new q(this._protocol);else y.read=new W}this._protocol._packetRW.read.cleanup();this._protocol._packetRW.write.cleanup();this._protocol._packetRW=y;this._public=null;this._dh=null;this._kexinit=this._protocol._kexinit=undefined;this._remoteKexinit=undefined;this._identRaw=undefined;this._remoteIdentRaw=undefined;this._hostKey=undefined;this._dhData=undefined;this._sig=undefined;this._protocol._onHandshakeComplete(t);return false};if(!e)return completeHandshake();this.finish=completeHandshake}start(){if(!this._protocol._server){if(this._protocol._debug){let e;switch(this.type){case"group":e="KEXDH_INIT";break;default:e="KEXECDH_INIT"}this._protocol._debug(`Outbound: Sending ${e}`)}const e=this.getPublicKey();let t=this._protocol._packetRW.write.allocStartKEX;const n=this._protocol._packetRW.write.alloc(1+4+e.length,true);n[t]=C.KEXDH_INIT;x(n,e.length,++t);n.set(e,t+=4);this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(n,true))}}getPublicKey(){this.generateKeys();const e=this._public;if(e)return this.convertPublicKey(e)}convertPublicKey(e){let t;let n=0;let r=e.length;while(e[n]===0){++n;--r}if(e[n]&128){t=Buffer.allocUnsafe(1+r);t[0]=0;e.copy(t,1,n);return t}if(r!==e.length){t=Buffer.allocUnsafe(r);e.copy(t,0,n);e=t}return e}computeSecret(e){this.generateKeys();try{return convertToMpint(this._dh.computeSecret(e))}catch(e){return e}}parse(e){const t=e[0];switch(this._step){case 1:if(this._protocol._server){if(t!==C.KEXDH_INIT){return U(this._protocol,`Received packet ${t} instead of ${C.KEXDH_INIT}`,"handshake",w.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH Init");P.init(e,1);const n=P.readString();P.clear();if(n===undefined){return U(this._protocol,"Received malformed KEX*_INIT","handshake",w.KEY_EXCHANGE_FAILED)}this._dhData=n;let r=this._protocol._hostKeys[this.negotiated.serverHostKey];if(Array.isArray(r))r=r[0];this._hostKey=r;this.finish()}else{if(t!==C.KEXDH_REPLY){return U(this._protocol,`Received packet ${t} instead of ${C.KEXDH_REPLY}`,"handshake",w.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH Reply");P.init(e,1);let n;let r;let i;if((n=P.readString())===undefined||(r=P.readString())===undefined||(i=P.readString())===undefined){P.clear();return U(this._protocol,"Received malformed KEX*_REPLY","handshake",w.KEY_EXCHANGE_FAILED)}P.clear();P.init(n,0);const s=P.readString(true);P.clear();if(s===undefined){return U(this._protocol,"Received malformed host public key","handshake",w.KEY_EXCHANGE_FAILED)}if(s!==this.negotiated.serverHostKey){switch(this.negotiated.serverHostKey){case"rsa-sha2-256":case"rsa-sha2-512":if(s==="ssh-rsa")break;default:return U(this._protocol,"Host key does not match negotiated type","handshake",w.KEY_EXCHANGE_FAILED)}}this._hostKey=n;this._dhData=r;this._sig=i;let o=false;let f;if(this._protocol._hostVerifier===undefined){f=true;this._protocol._debug&&this._protocol._debug("Host accepted by default (no verification)")}else{f=this._protocol._hostVerifier(n,(e=>{if(o)return;o=true;if(e===false){this._protocol._debug&&this._protocol._debug("Host denied (verification failed)");return U(this._protocol,"Host denied (verification failed)","handshake",w.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Host accepted (verified)");this._hostVerified=true;if(this._receivedNEWKEYS)this.finish();else trySendNEWKEYS(this)}))}if(f===undefined){++this._step;return}o=true;if(f===false){this._protocol._debug&&this._protocol._debug("Host denied (verification failed)");return U(this._protocol,"Host denied (verification failed)","handshake",w.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Host accepted (verified)");this._hostVerified=true;trySendNEWKEYS(this)}++this._step;break;case 2:if(t!==C.NEWKEYS){return U(this._protocol,`Received packet ${t} instead of ${C.NEWKEYS}`,"handshake",w.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Inbound: NEWKEYS");this._receivedNEWKEYS=true;++this._step;if(this._protocol._server||this._hostVerified)return this.finish();return false;default:return U(this._protocol,`Received unexpected packet ${t} after NEWKEYS`,"handshake",w.KEY_EXCHANGE_FAILED)}}}class Curve25519Exchange extends KeyExchange{constructor(e,...t){super(...t);this.type="25519";this.hashName=e;this._keys=null}generateKeys(){if(!this._keys)this._keys=l("x25519")}getPublicKey(){this.generateKeys();const e=this._keys.publicKey.export({type:"spki",format:"der"});return e.slice(-32)}convertPublicKey(e){let t;let n=0;let r=e.length;while(e[n]===0){++n;--r}if(e.length===32)return e;if(r!==e.length){t=Buffer.allocUnsafe(r);e.copy(t,0,n);e=t}return e}computeSecret(e){this.generateKeys();try{const t=new p.Writer;t.startSequence();t.startSequence();t.writeOID("1.3.101.110");t.endSequence();t.startSequence(p.BitString);t.writeByte(0);t._ensure(e.length);e.copy(t._buf,t._offset,0,e.length);t._offset+=e.length;t.endSequence();t.endSequence();return convertToMpint(u({privateKey:this._keys.privateKey,publicKey:f({key:t.buffer,type:"spki",format:"der"})}))}catch(e){return e}}}class ECDHExchange extends KeyExchange{constructor(e,t,...n){super(...n);this.type="ecdh";this.curveName=e;this.hashName=t}generateKeys(){if(!this._dh){this._dh=s(this.curveName);this._public=this._dh.generateKeys()}}}class DHGroupExchange extends KeyExchange{constructor(e,...t){super(...t);this.type="groupex";this.hashName=e;this._prime=null;this._generator=null;this._minBits=j;this._prefBits=dhEstimate(this.negotiated);if(this._protocol._compatFlags&g.BUG_DHGEX_LARGE)this._prefBits=Math.min(this._prefBits,4096);this._maxBits=V}start(){if(this._protocol._server)return;this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_GEX_REQUEST");let e=this._protocol._packetRW.write.allocStartKEX;const t=this._protocol._packetRW.write.alloc(1+4+4+4,true);t[e]=C.KEXDH_GEX_REQUEST;x(t,this._minBits,++e);x(t,this._prefBits,e+=4);x(t,this._maxBits,e+=4);this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(t,true))}generateKeys(){if(!this._dh&&this._prime&&this._generator){this._dh=r(this._prime,this._generator);this._public=this._dh.generateKeys()}}setDHParams(e,t){if(!Buffer.isBuffer(e))throw new Error("Invalid prime value");if(!Buffer.isBuffer(t))throw new Error("Invalid generator value");this._prime=e;this._generator=t}getDHParams(){if(this._dh){return{prime:convertToMpint(this._dh.getPrime()),generator:convertToMpint(this._dh.getGenerator())}}}parse(e){const t=e[0];switch(this._step){case 1:if(this._protocol._server){if(t!==C.KEXDH_GEX_REQUEST){return U(this._protocol,`Received packet ${t} instead of `+C.KEXDH_GEX_REQUEST,"handshake",w.KEY_EXCHANGE_FAILED)}return U(this._protocol,"Group exchange not implemented for server","handshake",w.KEY_EXCHANGE_FAILED)}if(t!==C.KEXDH_GEX_GROUP){return U(this._protocol,`Received packet ${t} instead of ${C.KEXDH_GEX_GROUP}`,"handshake",w.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH GEX Group");P.init(e,1);let n;let r;if((n=P.readString())===undefined||(r=P.readString())===undefined){P.clear();return U(this._protocol,"Received malformed KEXDH_GEX_GROUP","handshake",w.KEY_EXCHANGE_FAILED)}P.clear();this.setDHParams(n,r);this.generateKeys();const i=this.getPublicKey();this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_GEX_INIT");let s=this._protocol._packetRW.write.allocStartKEX;const o=this._protocol._packetRW.write.alloc(1+4+i.length,true);o[s]=C.KEXDH_GEX_INIT;x(o,i.length,++s);o.set(i,s+=4);this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(o,true));++this._step;break;case 2:if(this._protocol._server){if(t!==C.KEXDH_GEX_INIT){return U(this._protocol,`Received packet ${t} instead of ${C.KEXDH_GEX_INIT}`,"handshake",w.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH GEX Init");return U(this._protocol,"Group exchange not implemented for server","handshake",w.KEY_EXCHANGE_FAILED)}else if(t!==C.KEXDH_GEX_REPLY){return U(this._protocol,`Received packet ${t} instead of ${C.KEXDH_GEX_REPLY}`,"handshake",w.KEY_EXCHANGE_FAILED)}this._protocol._debug&&this._protocol._debug("Received DH GEX Reply");this._step=1;e[0]=C.KEXDH_REPLY;this.parse=KeyExchange.prototype.parse;this.parse(e)}}}class DHExchange extends KeyExchange{constructor(e,t,...n){super(...n);this.type="group";this.groupName=e;this.hashName=t}start(){if(!this._protocol._server){this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_INIT");const e=this.getPublicKey();let t=this._protocol._packetRW.write.allocStartKEX;const n=this._protocol._packetRW.write.alloc(1+4+e.length,true);n[t]=C.KEXDH_INIT;x(n,e.length,++t);n.set(e,t+=4);this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(n,true))}}generateKeys(){if(!this._dh){this._dh=i(this.groupName);this._public=this._dh.generateKeys()}}getDHParams(){if(this._dh){return{prime:convertToMpint(this._dh.getPrime()),generator:convertToMpint(this._dh.getGenerator())}}}}return(e,...t)=>{if(typeof e!=="object"||e===null)throw new Error("Invalid negotiated argument");const n=e.kex;if(typeof n==="string"){t=[e,...t];switch(n){case"curve25519-sha256":case"curve25519-sha256@libssh.org":if(!_)break;return new Curve25519Exchange("sha256",...t);case"ecdh-sha2-nistp256":return new ECDHExchange("prime256v1","sha256",...t);case"ecdh-sha2-nistp384":return new ECDHExchange("secp384r1","sha384",...t);case"ecdh-sha2-nistp521":return new ECDHExchange("secp521r1","sha512",...t);case"diffie-hellman-group1-sha1":return new DHExchange("modp2","sha1",...t);case"diffie-hellman-group14-sha1":return new DHExchange("modp14","sha1",...t);case"diffie-hellman-group14-sha256":return new DHExchange("modp14","sha256",...t);case"diffie-hellman-group15-sha512":return new DHExchange("modp15","sha512",...t);case"diffie-hellman-group16-sha512":return new DHExchange("modp16","sha512",...t);case"diffie-hellman-group17-sha512":return new DHExchange("modp17","sha512",...t);case"diffie-hellman-group18-sha512":return new DHExchange("modp18","sha512",...t);case"diffie-hellman-group-exchange-sha1":return new DHGroupExchange("sha1",...t);case"diffie-hellman-group-exchange-sha256":return new DHGroupExchange("sha256",...t)}throw new Error(`Unsupported key exchange algorithm: ${n}`)}throw new Error(`Invalid key exchange type: ${n}`)}})();const ee=(()=>{const e=["kex","serverHostKey",["cs","cipher"],["sc","cipher"],["cs","mac"],["sc","mac"],["cs","compress"],["sc","compress"],["cs","lang"],["sc","lang"]];return class KexInit{constructor(t){if(typeof t!=="object"||t===null)throw new TypeError("Argument must be an object");const n={kex:undefined,serverHostKey:undefined,cs:{cipher:undefined,mac:undefined,compress:undefined,lang:undefined},sc:{cipher:undefined,mac:undefined,compress:undefined,lang:undefined},all:undefined};let r=0;for(const i of e){let e;let s;let o;let f;if(typeof i==="string"){e=n;s=t[i];o=f=i}else{const r=i[0];e=n[r];f=i[1];s=t[r][f];o=`${r}.${f}`}const u={array:undefined,buffer:undefined};if(Buffer.isBuffer(s)){u.array=(""+s).split(",");u.buffer=s;r+=4+s.length}else{if(typeof s==="string")s=s.split(",");if(Array.isArray(s)){u.array=s;u.buffer=Buffer.from(s.join(","))}else{throw new TypeError(`Invalid \`${o}\` type: ${typeof s}`)}r+=4+u.buffer.length}e[f]=u}const i=Buffer.allocUnsafe(r);n.all=i;let s=0;for(const t of e){let e;if(typeof t==="string")e=n[t].buffer;else e=n[t[0]][t[1]].buffer;s=x(i,e.length,s);i.set(e,s);s+=e.length}this.totalSize=r;this.lists=n}copyAllTo(e,t){const n=this.lists.all;if(typeof t!=="number")throw new TypeError(`Invalid offset value: ${typeof t}`);if(e.length-t<n.length)throw new Error("Insufficient space to copy list");e.set(n,t);return n.length}}})();const te=(()=>{const e=Buffer.allocUnsafe(4);return(t,n)=>{x(e,n.length,0);t.update(e);t.update(n)}})();function generateKEXVal(e,t,n,r,i,s){let f;if(e){let u=o(t).update(n).update(r).update(s).update(i).digest();while(u.length<e){const e=o(t).update(n).update(r).update(u).digest();const i=Buffer.allocUnsafe(u.length+e.length);i.set(u,0);i.set(e,u.length);u=i}if(u.length===e)f=u;else f=new D(u.buffer,u.byteOffset,e)}else{f=z}return f}function onKEXPayload(e,t){if(t.length===0){this._debug&&this._debug("Inbound: Skipping empty packet payload");return}if(this._skipNextInboundPacket){this._skipNextInboundPacket=false;return}t=this._packetRW.read.read(t);const r=t[0];switch(r){case C.DISCONNECT:case C.IGNORE:case C.UNIMPLEMENTED:case C.DEBUG:if(!Y)Y=n(172);return Y[r](this,t);case C.KEXINIT:if(!e.firstPacket){return U(this,"Received extra KEXINIT during handshake","handshake",w.KEY_EXCHANGE_FAILED)}e.firstPacket=false;return handleKexInit(this,t);default:if(r<20||r>49){return U(this,`Received unexpected packet type ${r}`,"handshake",w.KEY_EXCHANGE_FAILED)}}return this._kex.parse(t)}function dhEstimate(e){const t=k[e.cs.cipher];const n=k[e.sc.cipher];const r=Math.max(0,t.sslName==="des-ede3-cbc"?14:t.keyLen,t.blockLen,t.ivLen,n.sslName==="des-ede3-cbc"?14:n.keyLen,n.blockLen,n.ivLen)*8;if(r<=112)return 2048;if(r<=128)return 3072;if(r<=192)return 7680;return 8192}function trySendNEWKEYS(e){if(!e._sentNEWKEYS){e._protocol._debug&&e._protocol._debug("Outbound: Sending NEWKEYS");const t=e._protocol._packetRW.write.allocStartKEX;const n=e._protocol._packetRW.write.alloc(1,true);n[t]=C.NEWKEYS;e._protocol._cipher.encrypt(e._protocol._packetRW.write.finalize(n,true));e._sentNEWKEYS=true}}e.exports={KexInit:ee,kexinit:kexinit,onKEXPayload:onKEXPayload,DEFAULT_KEXINIT:new ee({kex:E,serverHostKey:y,cs:{cipher:m,mac:I,compress:b,lang:[]},sc:{cipher:m,mac:I,compress:b,lang:[]}}),HANDLERS:{[C.KEXINIT]:handleKexInit}}},2218:(e,t,n)=>{"use strict";const{createDecipheriv:r,createECDH:i,createHash:s,createHmac:o,createSign:f,createVerify:u,getCiphers:l,sign:h,verify:p}=n(6113);const g=l();const{Ber:_}=n(970);const E=n(5447).pbkdf;const{CIPHER_INFO:y}=n(5708);const{eddsaSupported:m,SUPPORTED_CIPHER:I}=n(6832);const{bufferSlice:b,makeBufferParser:w,readString:C,readUInt32BE:k,writeUInt32BE:R}=n(9475);const B=Symbol("Hash Algorithm");const v=Symbol("Private key PEM");const O=Symbol("Public key PEM");const T=Symbol("Public key SSH");const P=Symbol("Decrypted Key");const L=Object.create(null);{const e=Object.keys(y);for(let t=0;t<e.length;++t){const n=y[e[t]].sslName;if(!n||L[n])continue;L[n]=y[e[t]]}}const U=w();function makePEM(e,t){t=t.base64Slice(0,t.length);let n=t.replace(/.{64}/g,"$&\n");if(t.length&63)n+="\n";return`-----BEGIN ${e} KEY-----\n${n}-----END ${e} KEY-----`}function combineBuffers(e,t){const n=Buffer.allocUnsafe(e.length+t.length);n.set(e,0);n.set(t,e.length);return n}function skipFields(e,t){const n=e.length;let r=e._pos||0;for(let i=0;i<t;++i){const t=n-r;if(r>=n||t<4)return false;const i=k(e,r);if(t<4+i)return false;r+=4+i}e._pos=r;return true}function genOpenSSLRSAPub(e,t){const n=new _.Writer;n.startSequence();n.startSequence();n.writeOID("1.2.840.113549.1.1.1");n.writeNull();n.endSequence();n.startSequence(_.BitString);n.writeByte(0);n.startSequence();n.writeBuffer(e,_.Integer);n.writeBuffer(t,_.Integer);n.endSequence();n.endSequence();n.endSequence();return makePEM("PUBLIC",n.buffer)}function genOpenSSHRSAPub(e,t){const n=Buffer.allocUnsafe(4+7+4+t.length+4+e.length);R(n,7,0);n.utf8Write("ssh-rsa",4,7);let r=4+7;R(n,t.length,r);n.set(t,r+=4);R(n,e.length,r+=t.length);n.set(e,r+4);return n}const D=(()=>{function genRSAASN1Buf(e,t,n,r,i,s,o,f){const u=new _.Writer;u.startSequence();u.writeInt(0,_.Integer);u.writeBuffer(e,_.Integer);u.writeBuffer(t,_.Integer);u.writeBuffer(n,_.Integer);u.writeBuffer(r,_.Integer);u.writeBuffer(i,_.Integer);u.writeBuffer(s,_.Integer);u.writeBuffer(o,_.Integer);u.writeBuffer(f,_.Integer);u.endSequence();return u.buffer}function bigIntFromBuffer(e){return BigInt(`0x${e.hexSlice(0,e.length)}`)}function bigIntToBuffer(e){let t=e.toString(16);if((t.length&1)!==0){t=`0${t}`}else{const e=t.charCodeAt(0);if(e===56||e===57||e>=97&&e<=102){t=`00${t}`}}return Buffer.from(t,"hex")}return function genOpenSSLRSAPriv(e,t,n,r,i,s){const o=bigIntFromBuffer(n);const f=bigIntToBuffer(o%(bigIntFromBuffer(i)-1n));const u=bigIntToBuffer(o%(bigIntFromBuffer(s)-1n));return makePEM("RSA PRIVATE",genRSAASN1Buf(e,t,n,i,s,f,u,r))}})();function genOpenSSLDSAPub(e,t,n,r){const i=new _.Writer;i.startSequence();i.startSequence();i.writeOID("1.2.840.10040.4.1");i.startSequence();i.writeBuffer(e,_.Integer);i.writeBuffer(t,_.Integer);i.writeBuffer(n,_.Integer);i.endSequence();i.endSequence();i.startSequence(_.BitString);i.writeByte(0);i.writeBuffer(r,_.Integer);i.endSequence();i.endSequence();return makePEM("PUBLIC",i.buffer)}function genOpenSSHDSAPub(e,t,n,r){const i=Buffer.allocUnsafe(4+7+4+e.length+4+t.length+4+n.length+4+r.length);R(i,7,0);i.utf8Write("ssh-dss",4,7);let s=4+7;R(i,e.length,s);i.set(e,s+=4);R(i,t.length,s+=e.length);i.set(t,s+=4);R(i,n.length,s+=t.length);i.set(n,s+=4);R(i,r.length,s+=n.length);i.set(r,s+4);return i}function genOpenSSLDSAPriv(e,t,n,r,i){const s=new _.Writer;s.startSequence();s.writeInt(0,_.Integer);s.writeBuffer(e,_.Integer);s.writeBuffer(t,_.Integer);s.writeBuffer(n,_.Integer);s.writeBuffer(r,_.Integer);s.writeBuffer(i,_.Integer);s.endSequence();return makePEM("DSA PRIVATE",s.buffer)}function genOpenSSLEdPub(e){const t=new _.Writer;t.startSequence();t.startSequence();t.writeOID("1.3.101.112");t.endSequence();t.startSequence(_.BitString);t.writeByte(0);t._ensure(e.length);t._buf.set(e,t._offset);t._offset+=e.length;t.endSequence();t.endSequence();return makePEM("PUBLIC",t.buffer)}function genOpenSSHEdPub(e){const t=Buffer.allocUnsafe(4+11+4+e.length);R(t,11,0);t.utf8Write("ssh-ed25519",4,11);R(t,e.length,15);t.set(e,19);return t}function genOpenSSLEdPriv(e){const t=new _.Writer;t.startSequence();t.writeInt(0,_.Integer);t.startSequence();t.writeOID("1.3.101.112");t.endSequence();t.startSequence(_.OctetString);t.writeBuffer(e,_.OctetString);t.endSequence();t.endSequence();return makePEM("PRIVATE",t.buffer)}function genOpenSSLECDSAPub(e,t){const n=new _.Writer;n.startSequence();n.startSequence();n.writeOID("1.2.840.10045.2.1");n.writeOID(e);n.endSequence();n.startSequence(_.BitString);n.writeByte(0);n._ensure(t.length);n._buf.set(t,n._offset);n._offset+=t.length;n.endSequence();n.endSequence();return makePEM("PUBLIC",n.buffer)}function genOpenSSHECDSAPub(e,t){let n;switch(e){case"1.2.840.10045.3.1.7":n="nistp256";break;case"1.3.132.0.34":n="nistp384";break;case"1.3.132.0.35":n="nistp521";break;default:return}const r=Buffer.allocUnsafe(4+19+4+8+4+t.length);R(r,19,0);r.utf8Write(`ecdsa-sha2-${n}`,4,19);R(r,8,23);r.utf8Write(n,27,8);R(r,t.length,35);r.set(t,39);return r}function genOpenSSLECDSAPriv(e,t,n){const r=new _.Writer;r.startSequence();r.writeInt(1,_.Integer);r.writeBuffer(n,_.OctetString);r.startSequence(160);r.writeOID(e);r.endSequence();r.startSequence(161);r.startSequence(_.BitString);r.writeByte(0);r._ensure(t.length);r._buf.set(t,r._offset);r._offset+=t.length;r.endSequence();r.endSequence();r.endSequence();return makePEM("EC PRIVATE",r.buffer)}function genOpenSSLECDSAPubFromPriv(e,t){const n=i(e);n.setPrivateKey(t);return n.getPublicKey()}const Q={sign:(()=>{if(typeof h==="function"){return function sign(e,t){const n=this[v];if(n===null)return new Error("No private key available");if(!t||typeof t!=="string")t=this[B];try{return h(t,e,n)}catch(e){return e}}}return function sign(e,t){const n=this[v];if(n===null)return new Error("No private key available");if(!t||typeof t!=="string")t=this[B];const r=f(t);r.update(e);try{return r.sign(n)}catch(e){return e}}})(),verify:(()=>{if(typeof p==="function"){return function verify(e,t,n){const r=this[O];if(r===null)return new Error("No public key available");if(!n||typeof n!=="string")n=this[B];try{return p(n,e,r,t)}catch(e){return e}}}return function verify(e,t,n){const r=this[O];if(r===null)return new Error("No public key available");if(!n||typeof n!=="string")n=this[B];const i=u(n);i.update(e);try{return i.verify(r,t)}catch(e){return e}}})(),isPrivateKey:function isPrivateKey(){return this[v]!==null},getPrivatePEM:function getPrivatePEM(){return this[v]},getPublicPEM:function getPublicPEM(){return this[O]},getPublicSSH:function getPublicSSH(){return this[T]},equals:function equals(e){const t=parseKey(e);if(t instanceof Error)return false;return this.type===t.type&&this[v]===t[v]&&this[O]===t[O]&&this[T]===t[T]}};function OpenSSH_Private(e,t,n,r,i,s,o){this.type=e;this.comment=t;this[v]=n;this[O]=r;this[T]=i;this[B]=s;this[P]=o}OpenSSH_Private.prototype=Q;{const e=/^-----BEGIN OPENSSH PRIVATE KEY-----(?:\r\n|\n)([\s\S]+)(?:\r\n|\n)-----END OPENSSH PRIVATE KEY-----$/;OpenSSH_Private.parse=(t,n)=>{const i=e.exec(t);if(i===null)return null;let s;const o=Buffer.from(i[1],"base64");if(o.length<31)return new Error("Malformed OpenSSH private key");const f=o.utf8Slice(0,15);if(f!=="openssh-key-v1\0")return new Error(`Unsupported OpenSSH key magic: ${f}`);const u=C(o,15,true);if(u===undefined)return new Error("Malformed OpenSSH private key");if(u!=="none"&&I.indexOf(u)===-1)return new Error(`Unsupported cipher for OpenSSH key: ${u}`);const l=C(o,o._pos,true);if(l===undefined)return new Error("Malformed OpenSSH private key");if(l!=="none"){if(u==="none")return new Error("Malformed OpenSSH private key");if(l!=="bcrypt")return new Error(`Unsupported kdf name for OpenSSH key: ${l}`);if(!n){return new Error("Encrypted private OpenSSH key detected, but no passphrase given")}}else if(u!=="none"){return new Error("Malformed OpenSSH private key")}let h;let p;let g;if(u!=="none")h=y[u];const _=C(o,o._pos);if(_===undefined)return new Error("Malformed OpenSSH private key");if(_.length){switch(l){case"none":return new Error("Malformed OpenSSH private key");case"bcrypt":const e=C(_,0);if(e===undefined||_._pos+4>_.length)return new Error("Malformed OpenSSH private key");const t=k(_,_._pos);const r=Buffer.allocUnsafe(h.keyLen+h.ivLen);const i=E(n,n.length,e,e.length,r,r.length,t);if(i!==0)return new Error("Failed to generate information to decrypt key");p=b(r,0,h.keyLen);g=b(r,h.keyLen,r.length);break}}else if(l!=="none"){return new Error("Malformed OpenSSH private key")}if(o._pos+3>=o.length)return new Error("Malformed OpenSSH private key");const m=k(o,o._pos);o._pos+=4;if(m>0){for(let e=0;e<m;++e){const e=C(o,o._pos);if(e===undefined)return new Error("Malformed OpenSSH private key");const t=C(e,0,true);if(t===undefined)return new Error("Malformed OpenSSH private key")}let e=C(o,o._pos);if(e===undefined)return new Error("Malformed OpenSSH private key");if(p!==undefined){if(e.length<h.blockLen||e.length%h.blockLen!==0){return new Error("Malformed OpenSSH private key")}try{const t={authTagLength:h.authLen};const n=r(h.sslName,p,g,t);if(h.authLen>0){if(o.length-o._pos<h.authLen)return new Error("Malformed OpenSSH private key");n.setAuthTag(b(o,o._pos,o._pos+=h.authLen))}e=combineBuffers(n.update(e),n.final())}catch(e){return e}}if(o._pos!==o.length)return new Error("Malformed OpenSSH private key");s=parseOpenSSHPrivKeys(e,m,p!==undefined)}else{s=[]}if(s instanceof Error)return s;return s[0]};function parseOpenSSHPrivKeys(e,t,n){const r=[];if(e.length<8)return new Error("Malformed OpenSSH private key");const i=k(e,0);const s=k(e,4);if(i!==s){if(n){return new Error("OpenSSH key integrity check failed -- bad passphrase?")}return new Error("OpenSSH key integrity check failed")}e._pos=8;let o;let f;for(o=0;o<t;++o){let t;let i;let s;let o;const u=C(e,e._pos,true);if(u===undefined)return new Error("Malformed OpenSSH private key");switch(u){case"ssh-rsa":{const n=C(e,e._pos);if(n===undefined)return new Error("Malformed OpenSSH private key");const r=C(e,e._pos);if(r===undefined)return new Error("Malformed OpenSSH private key");const f=C(e,e._pos);if(f===undefined)return new Error("Malformed OpenSSH private key");const u=C(e,e._pos);if(u===undefined)return new Error("Malformed OpenSSH private key");const l=C(e,e._pos);if(l===undefined)return new Error("Malformed OpenSSH private key");const h=C(e,e._pos);if(h===undefined)return new Error("Malformed OpenSSH private key");s=genOpenSSLRSAPub(n,r);o=genOpenSSHRSAPub(n,r);i=D(n,r,f,u,l,h);t="sha1";break}case"ssh-dss":{const n=C(e,e._pos);if(n===undefined)return new Error("Malformed OpenSSH private key");const r=C(e,e._pos);if(r===undefined)return new Error("Malformed OpenSSH private key");const f=C(e,e._pos);if(f===undefined)return new Error("Malformed OpenSSH private key");const u=C(e,e._pos);if(u===undefined)return new Error("Malformed OpenSSH private key");const l=C(e,e._pos);if(l===undefined)return new Error("Malformed OpenSSH private key");s=genOpenSSLDSAPub(n,r,f,u);o=genOpenSSHDSAPub(n,r,f,u);i=genOpenSSLDSAPriv(n,r,f,u,l);t="sha1";break}case"ssh-ed25519":{if(!m)return new Error(`Unsupported OpenSSH private key type: ${u}`);const n=C(e,e._pos);if(n===undefined||n.length!==32)return new Error("Malformed OpenSSH private key");const r=C(e,e._pos);if(r===undefined||r.length!==64)return new Error("Malformed OpenSSH private key");s=genOpenSSLEdPub(n);o=genOpenSSHEdPub(n);i=genOpenSSLEdPriv(b(r,0,32));t=null;break}case"ecdsa-sha2-nistp256":t="sha256";f="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":if(t===undefined){t="sha384";f="1.3.132.0.34"}case"ecdsa-sha2-nistp521":{if(t===undefined){t="sha512";f="1.3.132.0.35"}if(!skipFields(e,1))return new Error("Malformed OpenSSH private key");const n=C(e,e._pos);if(n===undefined)return new Error("Malformed OpenSSH private key");const r=C(e,e._pos);if(r===undefined)return new Error("Malformed OpenSSH private key");s=genOpenSSLECDSAPub(f,n);o=genOpenSSHECDSAPub(f,n);i=genOpenSSLECDSAPriv(f,n,r);break}default:return new Error(`Unsupported OpenSSH private key type: ${u}`)}const l=C(e,e._pos,true);if(l===undefined)return new Error("Malformed OpenSSH private key");r.push(new OpenSSH_Private(u,l,i,s,o,t,n))}let u=0;for(o=e._pos;o<e.length;++o){if(e[o]!==++u%255)return new Error("Malformed OpenSSH private key")}return r}}function OpenSSH_Old_Private(e,t,n,r,i,s,o){this.type=e;this.comment=t;this[v]=n;this[O]=r;this[T]=i;this[B]=s;this[P]=o}OpenSSH_Old_Private.prototype=Q;{const e=/^-----BEGIN (RSA|DSA|EC) PRIVATE KEY-----(?:\r\n|\n)((?:[^:]+:\s*[\S].*(?:\r\n|\n))*)([\s\S]+)(?:\r\n|\n)-----END (RSA|DSA|EC) PRIVATE KEY-----$/;OpenSSH_Old_Private.parse=(t,n)=>{const i=e.exec(t);if(i===null)return null;let o=Buffer.from(i[3],"base64");let f=i[2];let u=false;if(f!==undefined){f=f.split(/\r\n|\n/g);for(let e=0;e<f.length;++e){const t=f[e];let i=t.indexOf(":");if(t.slice(0,i)==="DEK-Info"){const e=t.slice(i+2);i=e.indexOf(",");if(i===-1)continue;const f=e.slice(0,i).toLowerCase();if(g.indexOf(f)===-1){return new Error(`Cipher (${f}) not supported `+"for encrypted OpenSSH private key")}const l=L[f];if(!l){return new Error(`Cipher (${f}) not supported `+"for encrypted OpenSSH private key")}const h=Buffer.from(e.slice(i+1),"hex");if(h.length!==l.ivLen)return new Error("Malformed encrypted OpenSSH private key");if(!n){return new Error("Encrypted OpenSSH private key detected, but no passphrase given")}const p=b(h,0,8);let _=s("md5").update(n).update(p).digest();while(_.length<l.keyLen){_=combineBuffers(_,s("md5").update(_).update(n).update(p).digest())}if(_.length>l.keyLen)_=b(_,0,l.keyLen);try{const e=r(f,_,h);e.setAutoPadding(false);o=combineBuffers(e.update(o),e.final());u=true}catch(e){return e}}}}let l;let h;let p;let E;let y;let m;let I="Malformed OpenSSH private key";if(u)I+=". Bad passphrase?";switch(i[1]){case"RSA":l="ssh-rsa";h=makePEM("RSA PRIVATE",o);try{m=new _.Reader(o);m.readSequence();m.readInt();const e=m.readString(_.Integer,true);if(e===null)return new Error(I);const t=m.readString(_.Integer,true);if(t===null)return new Error(I);p=genOpenSSLRSAPub(e,t);E=genOpenSSHRSAPub(e,t)}catch{return new Error(I)}y="sha1";break;case"DSA":l="ssh-dss";h=makePEM("DSA PRIVATE",o);try{m=new _.Reader(o);m.readSequence();m.readInt();const e=m.readString(_.Integer,true);if(e===null)return new Error(I);const t=m.readString(_.Integer,true);if(t===null)return new Error(I);const n=m.readString(_.Integer,true);if(n===null)return new Error(I);const r=m.readString(_.Integer,true);if(r===null)return new Error(I);p=genOpenSSLDSAPub(e,t,n,r);E=genOpenSSHDSAPub(e,t,n,r)}catch{return new Error(I)}y="sha1";break;case"EC":let e;let t;let n;try{m=new _.Reader(o);m.readSequence();m.readInt();t=m.readString(_.OctetString,true);m.readByte();const r=m.readLength();if(r!==null){m._offset=r;n=m.readOID();if(n===null)return new Error(I);switch(n){case"1.2.840.10045.3.1.7":e="prime256v1";l="ecdsa-sha2-nistp256";y="sha256";break;case"1.3.132.0.34":e="secp384r1";l="ecdsa-sha2-nistp384";y="sha384";break;case"1.3.132.0.35":e="secp521r1";l="ecdsa-sha2-nistp521";y="sha512";break;default:return new Error(`Unsupported private key EC OID: ${n}`)}}else{return new Error(I)}}catch{return new Error(I)}h=makePEM("EC PRIVATE",o);const r=genOpenSSLECDSAPubFromPriv(e,t);p=genOpenSSLECDSAPub(n,r);E=genOpenSSHECDSAPub(n,r);break}return new OpenSSH_Old_Private(l,"",h,p,E,y,u)}}function PPK_Private(e,t,n,r,i,s,o){this.type=e;this.comment=t;this[v]=n;this[O]=r;this[T]=i;this[B]=s;this[P]=o}PPK_Private.prototype=Q;{const e=Buffer.alloc(0);const t=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);const n=Buffer.from([0,0,0,0]);const i=Buffer.from([0,0,0,1]);const f=/^PuTTY-User-Key-File-2: (ssh-(?:rsa|dss))\r?\nEncryption: (aes256-cbc|none)\r?\nComment: ([^\r\n]*)\r?\nPublic-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-MAC: ([^\r\n]+)/;PPK_Private.parse=(u,l)=>{const h=f.exec(u);if(h===null)return null;const p=h[2];const g=p!=="none";if(g&&!l){return new Error("Encrypted PPK private key detected, but no passphrase given")}let _=Buffer.from(h[5],"base64");if(g){const e=y[p];let o=combineBuffers(s("sha1").update(n).update(l).digest(),s("sha1").update(i).update(l).digest());if(o.length>e.keyLen)o=b(o,0,e.keyLen);try{const n=r(e.sslName,o,t);n.setAutoPadding(false);_=combineBuffers(n.update(_),n.final())}catch(e){return e}}const E=h[1];const m=h[3];const I=Buffer.from(h[4],"base64");const w=h[6];const k=E.length;const B=p.length;const v=Buffer.byteLength(m);const O=I.length;const T=_.length;const P=Buffer.allocUnsafe(4+k+4+B+4+v+4+O+4+T);let L=0;R(P,k,L);P.utf8Write(E,L+=4,k);R(P,B,L+=k);P.utf8Write(p,L+=4,B);R(P,v,L+=B);P.utf8Write(m,L+=4,v);R(P,O,L+=v);P.set(I,L+=4);R(P,T,L+=O);P.set(_,L+4);if(!l)l=e;const U=o("sha1",s("sha1").update("putty-private-key-file-mac-key").update(l).digest()).update(P).digest("hex");if(U!==w){if(g){return new Error("PPK private key integrity check failed -- bad passphrase?")}return new Error("PPK private key integrity check failed")}let Q;let x;let W;I._pos=0;skipFields(I,1);switch(E){case"ssh-rsa":{const e=C(I,I._pos);if(e===undefined)return new Error("Malformed PPK public key");const t=C(I,I._pos);if(t===undefined)return new Error("Malformed PPK public key");const n=C(_,0);if(n===undefined)return new Error("Malformed PPK private key");const r=C(_,_._pos);if(r===undefined)return new Error("Malformed PPK private key");const i=C(_,_._pos);if(i===undefined)return new Error("Malformed PPK private key");const s=C(_,_._pos);if(s===undefined)return new Error("Malformed PPK private key");Q=genOpenSSLRSAPub(t,e);x=genOpenSSHRSAPub(t,e);W=D(t,e,n,s,r,i);break}case"ssh-dss":{const e=C(I,I._pos);if(e===undefined)return new Error("Malformed PPK public key");const t=C(I,I._pos);if(t===undefined)return new Error("Malformed PPK public key");const n=C(I,I._pos);if(n===undefined)return new Error("Malformed PPK public key");const r=C(I,I._pos);if(r===undefined)return new Error("Malformed PPK public key");const i=C(_,0);if(i===undefined)return new Error("Malformed PPK private key");Q=genOpenSSLDSAPub(e,t,n,r);x=genOpenSSHDSAPub(e,t,n,r);W=genOpenSSLDSAPriv(e,t,n,r,i);break}}return new PPK_Private(E,m,W,Q,x,"sha1",g)}}function OpenSSH_Public(e,t,n,r,i){this.type=e;this.comment=t;this[v]=null;this[O]=n;this[T]=r;this[B]=i;this[P]=false}OpenSSH_Public.prototype=Q;{let e;if(m)e=/^(((?:ssh-(?:rsa|dss|ed25519))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z/+=]+)(?:$|\s+([\S].*)?)$/;else e=/^(((?:ssh-(?:rsa|dss))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z/+=]+)(?:$|\s+([\S].*)?)$/;OpenSSH_Public.parse=t=>{const n=e.exec(t);if(n===null)return null;const r=n[1];const i=n[2];const s=Buffer.from(n[3],"base64");const o=n[4]||"";const f=C(s,s._pos,true);if(f===undefined||f.indexOf(i)!==0)return new Error("Malformed OpenSSH public key");return parseDER(s,i,o,r)}}function RFC4716_Public(e,t,n,r,i){this.type=e;this.comment=t;this[v]=null;this[O]=n;this[T]=r;this[B]=i;this[P]=false}RFC4716_Public.prototype=Q;{const e=/^---- BEGIN SSH2 PUBLIC KEY ----(?:\r?\n)((?:.{0,72}\r?\n)+)---- END SSH2 PUBLIC KEY ----$/;const t=/^[A-Z0-9a-z/+=\r\n]+$/;const n=/^([\x21-\x39\x3B-\x7E]{1,64}): ((?:[^\\]*\\\r?\n)*[^\r\n]+)\r?\n/gm;const r=/\\\r?\n/g;RFC4716_Public.parse=i=>{let s=e.exec(i);if(s===null)return null;const o=s[1];let f=0;let u="";while(s=n.exec(o)){const e=s[1];const t=s[2].replace(r,"");if(t.length>1024){n.lastIndex=0;return new Error("Malformed RFC4716 public key")}f=n.lastIndex;if(e.toLowerCase()==="comment"){u=t;if(u.length>1&&u.charCodeAt(0)===34&&u.charCodeAt(u.length-1)===34){u=u.slice(1,-1)}}}let l=o.slice(f);if(!t.test(l))return new Error("Malformed RFC4716 public key");l=Buffer.from(l,"base64");const h=C(l,0,true);if(h===undefined)return new Error("Malformed RFC4716 public key");let p=null;let g=null;switch(h){case"ssh-rsa":{const e=C(l,l._pos);if(e===undefined)return new Error("Malformed RFC4716 public key");const t=C(l,l._pos);if(t===undefined)return new Error("Malformed RFC4716 public key");p=genOpenSSLRSAPub(t,e);g=genOpenSSHRSAPub(t,e);break}case"ssh-dss":{const e=C(l,l._pos);if(e===undefined)return new Error("Malformed RFC4716 public key");const t=C(l,l._pos);if(t===undefined)return new Error("Malformed RFC4716 public key");const n=C(l,l._pos);if(n===undefined)return new Error("Malformed RFC4716 public key");const r=C(l,l._pos);if(r===undefined)return new Error("Malformed RFC4716 public key");p=genOpenSSLDSAPub(e,t,n,r);g=genOpenSSHDSAPub(e,t,n,r);break}default:return new Error("Malformed RFC4716 public key")}return new RFC4716_Public(h,u,p,g,"sha1")}}function parseDER(e,t,n,r){if(!isSupportedKeyType(t))return new Error(`Unsupported OpenSSH public key type: ${t}`);let i;let s;let o=null;let f=null;switch(t){case"ssh-rsa":{const t=C(e,e._pos||0);if(t===undefined)return new Error("Malformed OpenSSH public key");const n=C(e,e._pos);if(n===undefined)return new Error("Malformed OpenSSH public key");o=genOpenSSLRSAPub(n,t);f=genOpenSSHRSAPub(n,t);i="sha1";break}case"ssh-dss":{const t=C(e,e._pos||0);if(t===undefined)return new Error("Malformed OpenSSH public key");const n=C(e,e._pos);if(n===undefined)return new Error("Malformed OpenSSH public key");const r=C(e,e._pos);if(r===undefined)return new Error("Malformed OpenSSH public key");const s=C(e,e._pos);if(s===undefined)return new Error("Malformed OpenSSH public key");o=genOpenSSLDSAPub(t,n,r,s);f=genOpenSSHDSAPub(t,n,r,s);i="sha1";break}case"ssh-ed25519":{const t=C(e,e._pos||0);if(t===undefined||t.length!==32)return new Error("Malformed OpenSSH public key");o=genOpenSSLEdPub(t);f=genOpenSSHEdPub(t);i=null;break}case"ecdsa-sha2-nistp256":i="sha256";s="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":if(i===undefined){i="sha384";s="1.3.132.0.34"}case"ecdsa-sha2-nistp521":{if(i===undefined){i="sha512";s="1.3.132.0.35"}if(!skipFields(e,1))return new Error("Malformed OpenSSH public key");const t=C(e,e._pos||0);if(t===undefined)return new Error("Malformed OpenSSH public key");o=genOpenSSLECDSAPub(s,t);f=genOpenSSHECDSAPub(s,t);break}default:return new Error(`Unsupported OpenSSH public key type: ${t}`)}return new OpenSSH_Public(r,n,o,f,i)}function isSupportedKeyType(e){switch(e){case"ssh-rsa":case"ssh-dss":case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":return true;case"ssh-ed25519":if(m)return true;default:return false}}function isParsedKey(e){if(!e)return false;return typeof e[P]==="boolean"}function parseKey(e,t){if(isParsedKey(e))return e;let n;if(Buffer.isBuffer(e)){n=e;e=e.utf8Slice(0,e.length).trim()}else if(typeof e==="string"){e=e.trim()}else{return new Error("Key data must be a Buffer or string")}if(t!=undefined){if(typeof t==="string")t=Buffer.from(t);else if(!Buffer.isBuffer(t))return new Error("Passphrase must be a string or Buffer when supplied")}let r;if((r=OpenSSH_Private.parse(e,t))!==null)return r;if((r=OpenSSH_Old_Private.parse(e,t))!==null)return r;if((r=PPK_Private.parse(e,t))!==null)return r;if((r=OpenSSH_Public.parse(e))!==null)return r;if((r=RFC4716_Public.parse(e))!==null)return r;if(n){U.init(n,0);const t=U.readString(true);if(t!==undefined){e=U.readRaw();if(e!==undefined){r=parseDER(e,t,"",t);if(r instanceof Error)r=null}}U.clear()}if(r)return r;return new Error("Unsupported key format")}e.exports={isParsedKey:isParsedKey,isSupportedKeyType:isSupportedKeyType,parseDERKey:(e,t)=>parseDER(e,t,"",t),parseKey:parseKey}},7609:(e,t,n)=>{"use strict";const r=n(9491);const{inspect:i}=n(3837);function addNumericalSeparator(e){let t="";let n=e.length;const r=e[0]==="-"?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function oneOf(e,t){r(typeof t==="string","`thing` has to be of type string");if(Array.isArray(e)){const n=e.length;r(n>0,"At least one expected value needs to be specified");e=e.map((e=>String(e)));if(n>2){return`one of ${t} ${e.slice(0,n-1).join(", ")}, or `+e[n-1]}else if(n===2){return`one of ${t} ${e[0]} or ${e[1]}`}return`of ${t} ${e[0]}`}return`of ${t} ${String(e)}`}t.ERR_INTERNAL_ASSERTION=class ERR_INTERNAL_ASSERTION extends Error{constructor(e){super();Error.captureStackTrace(this,ERR_INTERNAL_ASSERTION);const t="This is caused by either a bug in ssh2 "+"or incorrect usage of ssh2 internals.\n"+"Please open an issue with this stack trace at "+"https://github.com/mscdex/ssh2/issues\n";this.message=e===undefined?t:`${e}\n${t}`}};const s=2**32;const o=(()=>{try{return new Function("return 2n ** 32n")()}catch{}})();t.ERR_OUT_OF_RANGE=class ERR_OUT_OF_RANGE extends RangeError{constructor(e,t,n,f){super();Error.captureStackTrace(this,ERR_OUT_OF_RANGE);r(t,'Missing "range" argument');let u=f?e:`The value of "${e}" is out of range.`;let l;if(Number.isInteger(n)&&Math.abs(n)>s){l=addNumericalSeparator(String(n))}else if(typeof n==="bigint"){l=String(n);if(n>o||n<-o)l=addNumericalSeparator(l);l+="n"}else{l=i(n)}u+=` It must be ${t}. Received ${l}`;this.message=u}};class ERR_INVALID_ARG_TYPE extends TypeError{constructor(e,t,n){super();Error.captureStackTrace(this,ERR_INVALID_ARG_TYPE);r(typeof e==="string",`'name' must be a string`);let i;if(typeof t==="string"&&t.startsWith("not ")){i="must not be";t=t.replace(/^not /,"")}else{i="must be"}let s;if(e.endsWith(" argument")){s=`The ${e} ${i} ${oneOf(t,"type")}`}else{const n=e.includes(".")?"property":"argument";s=`The "${e}" ${n} ${i} ${oneOf(t,"type")}`}s+=`. Received type ${typeof n}`;this.message=s}}t.ERR_INVALID_ARG_TYPE=ERR_INVALID_ARG_TYPE;t.validateNumber=function validateNumber(e,t){if(typeof e!=="number")throw new ERR_INVALID_ARG_TYPE(t,"number",e)}},9475:(e,t,n)=>{"use strict";const r=n(970).Ber;let i;const s=Buffer[Symbol.species];const o=Object.getPrototypeOf(Uint8Array.prototype).fill;function readUInt32BE(e,t){return e[t++]*16777216+e[t++]*65536+e[t++]*256+e[t]}function bufferCopy(e,t,n,r,i){if(!i)i=0;if(r>e.length)r=e.length;let s=r-n;const o=t.length-i;if(s>o)s=o;t.set(new Uint8Array(e.buffer,e.byteOffset+n,s),i);return s}function bufferSlice(e,t,n){if(n===undefined)n=e.length;return new s(e.buffer,e.byteOffset+t,n-t)}function makeBufferParser(){let e=0;let t;const n={init:(n,r)=>{t=n;e=typeof r==="number"?r:0},pos:()=>e,length:()=>t?t.length:0,avail:()=>t&&e<t.length?t.length-e:0,clear:()=>{t=undefined},readUInt32BE:()=>{if(!t||e+3>=t.length)return;return t[e++]*16777216+t[e++]*65536+t[e++]*256+t[e++]},readUInt64BE:n=>{if(!t||e+7>=t.length)return;switch(n){case"always":return BigInt(`0x${t.hexSlice(e,e+=8)}`);case"maybe":if(t[e]>31)return BigInt(`0x${t.hexSlice(e,e+=8)}`);default:return t[e++]*72057594037927940+t[e++]*281474976710656+t[e++]*1099511627776+t[e++]*4294967296+t[e++]*16777216+t[e++]*65536+t[e++]*256+t[e++]}},skip:n=>{if(t&&n>0)e+=n},skipString:()=>{const r=n.readUInt32BE();if(r===undefined)return;e+=r;return e<=t.length?r:undefined},readByte:()=>{if(t&&e<t.length)return t[e++]},readBool:()=>{if(t&&e<t.length)return!!t[e++]},readList:()=>{const e=n.readString(true);if(e===undefined)return;return e?e.split(","):[]},readString:(r,i)=>{if(typeof r==="number"){i=r;r=undefined}const s=n.readUInt32BE();if(s===undefined)return;if(t.length-e<s||typeof i==="number"&&s>i){return}if(r){if(Buffer.isBuffer(r))return bufferCopy(t,r,e,e+=s);return t.utf8Slice(e,e+=s)}return bufferSlice(t,e,e+=s)},readRaw:n=>{if(!t)return;if(typeof n!=="number")return bufferSlice(t,e,e+=t.length-e);if(t.length-e>=n)return bufferSlice(t,e,e+=n)}};return n}function makeError(e,t,n){const r=new Error(e);if(typeof t==="boolean"){n=t;r.level="protocol"}else{r.level=t||"protocol"}r.fatal=!!n;return r}function writeUInt32BE(e,t,n){e[n++]=t>>>24;e[n++]=t>>>16;e[n++]=t>>>8;e[n++]=t;return n}const f=makeBufferParser();e.exports={bufferCopy:bufferCopy,bufferSlice:bufferSlice,FastBuffer:s,bufferFill:(e,t,n,r)=>o.call(e,t,n,r),makeError:makeError,doFatalError:(e,t,r,s)=>{let o;if(i===undefined)({DISCONNECT_REASON:i}=n(6832));if(t instanceof Error){o=t;if(typeof r!=="number")s=i.PROTOCOL_ERROR;else s=r}else{o=makeError(t,r,true)}if(typeof s!=="number")s=i.PROTOCOL_ERROR;e.disconnect(s);e._destruct();e._onError(o);return Infinity},readUInt32BE:readUInt32BE,writeUInt32BE:writeUInt32BE,writeUInt32LE:(e,t,n)=>{e[n++]=t;e[n++]=t>>>8;e[n++]=t>>>16;e[n++]=t>>>24;return n},makeBufferParser:makeBufferParser,bufferParser:makeBufferParser(),readString:(e,t,n,r)=>{if(typeof n==="number"){r=n;n=undefined}if(t===undefined)t=0;const i=e.length-t;if(t<0||t>=e.length||i<4)return;const s=readUInt32BE(e,t);if(i<4+s||typeof r==="number"&&s>r)return;t+=4;const o=t+s;e._pos=o;if(n){if(Buffer.isBuffer(n))return bufferCopy(e,n,t,o);return e.utf8Slice(t,o)}return bufferSlice(e,t,o)},sigSSHToASN1:(e,t)=>{switch(t){case"ssh-dss":{if(e.length>40)return e;const t=new r.Writer;t.startSequence();let n=e.slice(0,20);let i=e.slice(20);if(n[0]&128){const e=Buffer.allocUnsafe(21);e[0]=0;n.copy(e,1);n=e}else if(n[0]===0&&!(n[1]&128)){n=n.slice(1)}if(i[0]&128){const e=Buffer.allocUnsafe(21);e[0]=0;i.copy(e,1);i=e}else if(i[0]===0&&!(i[1]&128)){i=i.slice(1)}t.writeBuffer(n,r.Integer);t.writeBuffer(i,r.Integer);t.endSequence();return t.buffer}case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":{f.init(e,0);const t=f.readString();const n=f.readString();f.clear();if(t===undefined||n===undefined)return;const i=new r.Writer;i.startSequence();i.writeBuffer(t,r.Integer);i.writeBuffer(n,r.Integer);i.endSequence();return i.buffer}default:return e}},convertSignature:(e,t)=>{switch(t){case"ssh-dss":{if(e.length<=40)return e;const t=new r.Reader(e);t.readSequence();let n=t.readString(r.Integer,true);let i=t.readString(r.Integer,true);let s=0;let o=0;if(n.length<20){const e=Buffer.allocUnsafe(20);e.set(n,1);n=e;n[0]=0}if(i.length<20){const e=Buffer.allocUnsafe(20);e.set(i,1);i=e;i[0]=0}if(n.length>20&&n[0]===0)s=1;if(i.length>20&&i[0]===0)o=1;const f=Buffer.allocUnsafe(n.length-s+(i.length-o));bufferCopy(n,f,s,n.length,0);bufferCopy(i,f,o,i.length,n.length-s);return f}case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":{if(e[0]===0)return e;const t=new r.Reader(e);t.readSequence();const n=t.readString(r.Integer,true);const i=t.readString(r.Integer,true);if(n===null||i===null)return;const s=Buffer.allocUnsafe(4+n.length+4+i.length);writeUInt32BE(s,n.length,0);s.set(n,4);writeUInt32BE(s,i.length,4+n.length);s.set(i,4+4+n.length);return s}}return e},sendPacket:(e,t,n)=>{if(!n&&e._kexinit!==undefined){if(e._queue===undefined)e._queue=[];e._queue.push(t);e._debug&&e._debug("Outbound: ... packet queued");return false}e._cipher.encrypt(t);return true}}},6715:(e,t,n)=>{"use strict";const{kMaxLength:r}=n(4300);const{createInflate:i,constants:{DEFLATE:s,INFLATE:o,Z_DEFAULT_CHUNK:f,Z_DEFAULT_COMPRESSION:u,Z_DEFAULT_MEMLEVEL:l,Z_DEFAULT_STRATEGY:h,Z_DEFAULT_WINDOWBITS:p,Z_PARTIAL_FLUSH:g}}=n(9796);const _=i()._handle.constructor;function processCallback(){throw new Error("Should not get here")}function zlibOnError(e,t,n){const r=this._owner;const i=new Error(e);i.errno=t;i.code=n;r._err=i}function _close(e){if(!e._handle)return;e._handle.close();e._handle=null}class Zlib{constructor(e){const t=p;const n=u;const i=l;const s=h;const o=undefined;this._err=undefined;this._writeState=new Uint32Array(2);this._chunkSize=f;this._maxOutputLength=r;this._outBuffer=Buffer.allocUnsafe(this._chunkSize);this._outOffset=0;this._handle=new _(e);this._handle._owner=this;this._handle.onerror=zlibOnError;this._handle.init(t,n,i,s,this._writeState,processCallback,o)}writeSync(e,t){const n=this._handle;if(!n)throw new Error("Invalid Zlib instance");let r=e.length;let i=this._chunkSize-this._outOffset;let s=0;let o;let f;let u;let l=0;const h=this._writeState;let p=this._outBuffer;let _=this._outOffset;const E=this._chunkSize;while(true){n.writeSync(g,e,s,r,p,_,i);if(this._err)throw this._err;o=h[0];f=h[1];const t=r-f;const y=i-o;if(y>0){const e=_===0&&y===p.length?p:p.slice(_,_+y);_+=y;if(!u)u=e;else if(u.push===undefined)u=[u,e];else u.push(e);l+=e.byteLength;if(l>this._maxOutputLength){_close(this);throw new Error(`Output length exceeded maximum of ${this._maxOutputLength}`)}}else if(y!==0){throw new Error("have should not go down")}if(o===0||_>=E){i=E;_=0;p=Buffer.allocUnsafe(E)}if(o===0){s+=t;r=f}else{break}}this._outBuffer=p;this._outOffset=_;if(l===0)u=Buffer.alloc(0);if(t){u.totalLen=l;return u}if(u.push===undefined)return u;const y=Buffer.allocUnsafe(l);for(let e=0,t=0;e<u.length;++e){const n=u[e];y.set(n,t);t+=n.length}return y}}class ZlibPacketWriter{constructor(e){this.allocStart=0;this.allocStartKEX=0;this._protocol=e;this._zlib=new Zlib(s)}cleanup(){if(this._zlib)_close(this._zlib)}alloc(e,t){return Buffer.allocUnsafe(e)}finalize(e,t){if(this._protocol._kexinit===undefined||t){const t=this._zlib.writeSync(e,true);const n=this._protocol._cipher.allocPacket(t.totalLen);if(t.push===undefined){n.set(t,5)}else{for(let e=0,r=5;e<t.length;++e){const i=t[e];n.set(i,r);r+=i.length}}return n}return e}}class PacketWriter{constructor(e){this.allocStart=5;this.allocStartKEX=5;this._protocol=e}cleanup(){}alloc(e,t){if(this._protocol._kexinit===undefined||t)return this._protocol._cipher.allocPacket(e);return Buffer.allocUnsafe(e)}finalize(e,t){return e}}class ZlibPacketReader{constructor(){this._zlib=new Zlib(o)}cleanup(){if(this._zlib)_close(this._zlib)}read(e){return this._zlib.writeSync(e,false)}}class PacketReader{cleanup(){}read(e){return e}}e.exports={PacketReader:PacketReader,PacketWriter:PacketWriter,ZlibPacketReader:ZlibPacketReader,ZlibPacketWriter:ZlibPacketWriter}},2986:(e,t,n)=>{"use strict";const{Server:r}=n(1808);const i=n(2361);const{listenerCount:s}=i;const{CHANNEL_OPEN_FAILURE:o,DEFAULT_CIPHER:f,DEFAULT_COMPRESSION:u,DEFAULT_KEX:l,DEFAULT_MAC:h,DEFAULT_SERVER_HOST_KEY:p,DISCONNECT_REASON:g,DISCONNECT_REASON_BY_VALUE:_,SUPPORTED_CIPHER:E,SUPPORTED_COMPRESSION:y,SUPPORTED_KEX:m,SUPPORTED_MAC:I,SUPPORTED_SERVER_HOST_KEY:b}=n(6832);const{init:w}=n(5708);const{KexInit:C}=n(4126);const{parseKey:k}=n(2218);const R=n(9031);const{SFTP:B}=n(2026);const{writeUInt32BE:v}=n(9475);const{Channel:O,MAX_WINDOW:T,PACKET_SIZE:P,windowAdjust:L,WINDOW_THRESHOLD:U}=n(3204);const{ChannelManager:D,generateAlgorithmList:Q,isWritable:x,onChannelOpenFailure:W,onCHANNEL_CLOSE:q}=n(834);const G=10;class AuthContext extends i{constructor(e,t,n,r,i){super();this.username=this.user=t;this.service=n;this.method=r;this._initialResponse=false;this._finalResponse=false;this._multistep=false;this._cbfinal=(e,t,n)=>{if(!this._finalResponse){this._finalResponse=true;i(this,e,t,n)}};this._protocol=e}accept(){this._cleanup&&this._cleanup();this._initialResponse=true;this._cbfinal(true)}reject(e,t){this._cleanup&&this._cleanup();this._initialResponse=true;this._cbfinal(false,e,t)}}class KeyboardAuthContext extends AuthContext{constructor(e,t,n,r,i,s){super(e,t,n,r,s);this._multistep=true;this._cb=undefined;this._onInfoResponse=e=>{const t=this._cb;if(t){this._cb=undefined;t(e)}};this.submethods=i;this.on("abort",(()=>{this._cb&&this._cb(new Error("Authentication request aborted"))}))}prompt(e,t,n,r){if(!Array.isArray(e))e=[e];if(typeof t==="function"){r=t;t=n=undefined}else if(typeof n==="function"){r=n;n=undefined}else if(typeof r!=="function"){r=undefined}for(let t=0;t<e.length;++t){if(typeof e[t]==="string"){e[t]={prompt:e[t],echo:true}}}this._cb=r;this._initialResponse=true;this._protocol.authInfoReq(t,n,e)}}class PKAuthContext extends AuthContext{constructor(e,t,n,r,i,s){super(e,t,n,r,s);this.key={algo:i.keyAlgo,data:i.key};this.signature=i.signature;this.blob=i.blob}accept(){if(!this.signature){this._initialResponse=true;this._protocol.authPKOK(this.key.algo,this.key.data)}else{AuthContext.prototype.accept.call(this)}}}class HostbasedAuthContext extends AuthContext{constructor(e,t,n,r,i,s){super(e,t,n,r,s);this.key={algo:i.keyAlgo,data:i.key};this.signature=i.signature;this.blob=i.blob;this.localHostname=i.localHostname;this.localUsername=i.localUsername}}class PwdAuthContext extends AuthContext{constructor(e,t,n,r,i,s){super(e,t,n,r,s);this.password=i;this._changeCb=undefined}requestChange(e,t){if(this._changeCb)throw new Error("Change request already in progress");if(typeof e!=="string")throw new Error("prompt argument must be a string");if(typeof t!=="function")throw new Error("Callback argument must be a function");this._changeCb=t;this._protocol.authPasswdChg(e)}}class Session extends i{constructor(e,t,n){super();this.type="session";this.subtype=undefined;this.server=true;this._ending=false;this._channel=undefined;this._chanInfo={type:"session",incoming:{id:n,window:T,packetSize:P,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}}}}class Server extends i{constructor(e,t){super();if(typeof e!=="object"||e===null)throw new Error("Missing configuration object");const n=Object.create(null);const i=[];const s=e.hostKeys;if(!Array.isArray(s))throw new Error("hostKeys must be an array");const o=typeof e.algorithms==="object"&&e.algorithms!==null?e.algorithms:{};const g=Q(o.serverHostKey,p,b);for(let e=0;e<s.length;++e){let t;if(Buffer.isBuffer(s[e])||typeof s[e]==="string")t=k(s[e]);else t=k(s[e].key,s[e].passphrase);if(t instanceof Error)throw new Error(`Cannot parse privateKey: ${t.message}`);if(Array.isArray(t)){t=t[0]}if(t.getPrivatePEM()===null)throw new Error("privateKey value contains an invalid private key");if(i.includes(t.type))continue;if(t.type==="ssh-rsa"){let e=g.indexOf("ssh-rsa");const r=g.indexOf("rsa-sha2-256");const s=g.indexOf("rsa-sha2-512");if(e===-1){e=Infinity}[e,r,s].sort(compareNumbers).forEach((o=>{if(o===-1)return;let f;switch(o){case e:f="ssh-rsa";break;case r:f="rsa-sha2-256";break;case s:f="rsa-sha2-512";break;default:return}n[f]=t;i.push(f)}))}else{n[t.type]=t;i.push(t.type)}}const _={kex:Q(o.kex,l,m),serverHostKey:i,cs:{cipher:Q(o.cipher,f,E),mac:Q(o.hmac,h,I),compress:Q(o.compress,u,y),lang:[]},sc:undefined};_.sc=_.cs;if(typeof t==="function")this.on("connection",t);const w=typeof e.debug==="function"?e.debug:undefined;const R=e.ident?Buffer.from(e.ident):undefined;const B=new C(_);this._srv=new r((t=>{if(this._connections>=this.maxConnections){t.destroy();return}++this._connections;t.once("close",(()=>{--this._connections}));let r;if(w){const e=`[${process.hrtime().join(".")}] `;r=t=>{w(`${e}${t}`)}}new Client(t,n,R,B,r,this,e)})).on("error",(e=>{this.emit("error",e)})).on("listening",(()=>{this.emit("listening")})).on("close",(()=>{this.emit("close")}));this._connections=0;this.maxConnections=Infinity}injectSocket(e){this._srv.emit("connection",e)}listen(...e){this._srv.listen(...e);return this}address(){return this._srv.address()}getConnections(e){this._srv.getConnections(e);return this}close(e){this._srv.close(e);return this}ref(){this._srv.ref();return this}unref(){this._srv.unref();return this}}Server.KEEPALIVE_CLIENT_INTERVAL=15e3;Server.KEEPALIVE_CLIENT_COUNT_MAX=3;class Client extends i{constructor(e,t,n,r,i,f,u){super();let l=0;let h=false;let p=[];let E;let y;let m;const I=[];this._sock=e;this._chanMgr=new D(this);this._debug=i;this.noMoreSessions=false;this.authenticated=false;function onClientPreHeaderError(e){}this.on("error",onClientPreHeaderError);const b=!i?undefined:(e,t,n)=>{i(`Debug output from client: ${JSON.stringify(n)}`)};const C=typeof u.keepaliveInterval==="number"&&isFinite(u.keepaliveInterval)&&u.keepaliveInterval>0?u.keepaliveInterval:typeof Server.KEEPALIVE_CLIENT_INTERVAL==="number"&&isFinite(Server.KEEPALIVE_CLIENT_INTERVAL)&&Server.KEEPALIVE_CLIENT_INTERVAL>0?Server.KEEPALIVE_CLIENT_INTERVAL:-1;const k=typeof u.keepaliveCountMax==="number"&&isFinite(u.keepaliveCountMax)&&u.keepaliveCountMax>=0?u.keepaliveCountMax:typeof Server.KEEPALIVE_CLIENT_COUNT_MAX==="number"&&isFinite(Server.KEEPALIVE_CLIENT_COUNT_MAX)&&Server.KEEPALIVE_CLIENT_COUNT_MAX>=0?Server.KEEPALIVE_CLIENT_COUNT_MAX:-1;let Q=0;if(C!==-1&&k!==-1){this.once("ready",(()=>{const onClose=()=>{clearInterval(y)};this.on("close",onClose).on("end",onClose);y=setInterval((()=>{if(++Q>k){clearInterval(y);const e=new Error("Keepalive timeout");e.level="client-timeout";this.emit("error",e);this.end()}else{$.ping()}}),C)}));m=()=>{y&&y.refresh();Q=0}}const $=this._protocol=new R({server:true,hostKeys:t,ident:n,offer:r,onPacket:m,greeting:u.greeting,banner:u.banner,onWrite:t=>{if(x(e))e.write(t)},onError:t=>{if(!$._destruct)e.removeAllListeners("data");this.emit("error",t);try{e.end()}catch{}},onHeader:t=>{this.removeListener("error",onClientPreHeaderError);const n={ip:e.remoteAddress,family:e.remoteFamily,port:e.remotePort,header:t};if(!f.emit("connection",this,n)){$.disconnect(g.BY_APPLICATION);e.end();return}if(t.greeting)this.emit("greeting",t.greeting)},onHandshakeComplete:e=>{if(++l>1)this.emit("rekey");this.emit("handshake",e)},debug:i,messageHandlers:{DEBUG:b,DISCONNECT:(t,n,r)=>{if(n!==g.BY_APPLICATION){if(!r){r=_[n];if(r===undefined)r=`Unexpected disconnection reason: ${n}`}const e=new Error(r);e.code=n;this.emit("error",e)}e.end()},CHANNEL_OPEN:(e,t)=>{if(t.type==="session"&&this.noMoreSessions||!this.authenticated){const e=o.ADMINISTRATIVELY_PROHIBITED;return $.channelOpenFail(t.sender,e)}let n=-1;let r;let f=false;let u;const reject=()=>{if(f)return;f=true;if(r===undefined){if(n===-1)r=o.RESOURCE_SHORTAGE;else r=o.CONNECT_FAILED}if(n!==-1)this._chanMgr.remove(n);$.channelOpenFail(t.sender,r,"")};const reserveChannel=()=>{n=this._chanMgr.add();if(n===-1){r=o.RESOURCE_SHORTAGE;if(i){i("Automatic rejection of incoming channel open: "+"no channels available")}}return n!==-1};const l=t.data;switch(t.type){case"session":if(s(this,"session")&&reserveChannel()){u=()=>{if(f)return;f=true;const e=new Session(this,t,n);this._chanMgr.update(n,e);$.channelOpenConfirm(t.sender,n,T,P);return e};this.emit("session",u,reject);return}break;case"direct-tcpip":if(s(this,"tcpip")&&reserveChannel()){u=()=>{if(f)return;f=true;const e={type:undefined,incoming:{id:n,window:T,packetSize:P,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};const r=new O(this,e,{server:true});this._chanMgr.update(n,r);$.channelOpenConfirm(t.sender,n,T,P);return r};this.emit("tcpip",u,reject,l);return}break;case"direct-streamlocal@openssh.com":if(s(this,"openssh.streamlocal")&&reserveChannel()){u=()=>{if(f)return;f=true;const e={type:undefined,incoming:{id:n,window:T,packetSize:P,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};const r=new O(this,e,{server:true});this._chanMgr.update(n,r);$.channelOpenConfirm(t.sender,n,T,P);return r};this.emit("openssh.streamlocal",u,reject,l);return}break;default:r=o.UNKNOWN_CHANNEL_TYPE;if(i){i("Automatic rejection of unsupported incoming channel open"+` type: ${t.type}`)}}if(r===undefined){r=o.ADMINISTRATIVELY_PROHIBITED;if(i){i("Automatic rejection of unexpected incoming channel open"+` for: ${t.type}`)}}reject()},CHANNEL_OPEN_CONFIRMATION:(e,t)=>{const n=this._chanMgr.get(t.recipient);if(typeof n!=="function")return;const r={type:n.type,incoming:{id:t.recipient,window:T,packetSize:P,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};const i=new O(this,r,{server:true});this._chanMgr.update(t.recipient,i);n(undefined,i)},CHANNEL_OPEN_FAILURE:(e,t,n,r)=>{const i=this._chanMgr.get(t);if(typeof i!=="function")return;const s={reason:n,description:r};W(this,t,s,i)},CHANNEL_DATA:(e,t,n)=>{let r=this._chanMgr.get(t);if(typeof r!=="object"||r===null)return;if(r.constructor===Session){r=r._channel;if(!r)return}if(r.incoming.window===0)return;r.incoming.window-=n.length;if(r.push(n)===false){r._waitChanDrain=true;return}if(r.incoming.window<=U)L(r)},CHANNEL_EXTENDED_DATA:(e,t,n,r)=>{},CHANNEL_WINDOW_ADJUST:(e,t,n)=>{let r=this._chanMgr.get(t);if(typeof r!=="object"||r===null)return;if(r.constructor===Session){r=r._channel;if(!r)return}r.outgoing.window+=n;if(r._waitWindow){r._waitWindow=false;if(r._chunk){r._write(r._chunk,null,r._chunkcb)}else if(r._chunkcb){r._chunkcb()}else if(r._chunkErr){r.stderr._write(r._chunkErr,null,r._chunkcbErr)}else if(r._chunkcbErr){r._chunkcbErr()}}},CHANNEL_SUCCESS:(e,t)=>{let n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;if(n.constructor===Session){n=n._channel;if(!n)return}if(n._callbacks.length)n._callbacks.shift()(false)},CHANNEL_FAILURE:(e,t)=>{let n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;if(n.constructor===Session){n=n._channel;if(!n)return}if(n._callbacks.length)n._callbacks.shift()(true)},CHANNEL_REQUEST:(e,t,n,r,o)=>{const f=this._chanMgr.get(t);if(typeof f!=="object"||f===null)return;let u=false;let l;let h;if(f.constructor!==Session){if(r)$.channelFailure(f.outgoing.id);return}if(r){if(n!=="shell"&&n!=="exec"&&n!=="subsystem"){l=()=>{if(u||f._ending||f._channel)return;u=true;$.channelSuccess(f._chanInfo.outgoing.id)}}h=()=>{if(u||f._ending||f._channel)return;u=true;$.channelFailure(f._chanInfo.outgoing.id)}}if(f._ending){h&&h();return}switch(n){case"env":if(s(f,"env")){f.emit("env",l,h,{key:o.name,val:o.value});return}break;case"pty-req":if(s(f,"pty")){f.emit("pty",l,h,o);return}break;case"window-change":if(s(f,"window-change"))f.emit("window-change",l,h,o);else h&&h();break;case"x11-req":if(s(f,"x11")){f.emit("x11",l,h,o);return}break;case"signal":if(s(f,"signal")){f.emit("signal",l,h,{name:o});return}break;case"auth-agent-req@openssh.com":if(s(f,"auth-agent")){f.emit("auth-agent",l,h);return}break;case"shell":if(s(f,"shell")){l=()=>{if(u||f._ending||f._channel)return;u=true;if(r)$.channelSuccess(f._chanInfo.outgoing.id);const e=new O(this,f._chanInfo,{server:true});e.subtype=f.subtype=n;f._channel=e;return e};f.emit("shell",l,h);return}break;case"exec":if(s(f,"exec")){l=()=>{if(u||f._ending||f._channel)return;u=true;if(r)$.channelSuccess(f._chanInfo.outgoing.id);const e=new O(this,f._chanInfo,{server:true});e.subtype=f.subtype=n;f._channel=e;return e};f.emit("exec",l,h,{command:o});return}break;case"subsystem":{let e=o==="sftp";l=()=>{if(u||f._ending||f._channel)return;u=true;if(r)$.channelSuccess(f._chanInfo.outgoing.id);let t;if(e){t=new B(this,f._chanInfo,{server:true,debug:i})}else{t=new O(this,f._chanInfo,{server:true});t.subtype=f.subtype=`${n}:${o}`}f._channel=t;return t};if(o==="sftp"){if(s(f,"sftp")){f.emit("sftp",l,h);return}e=false}if(s(f,"subsystem")){f.emit("subsystem",l,h,{name:o});return}break}}i&&i(`Automatic rejection of incoming channel request: ${n}`);h&&h()},CHANNEL_EOF:(e,t)=>{let n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;if(n.constructor===Session){if(!n._ending){n._ending=true;n.emit("eof");n.emit("end")}n=n._channel;if(!n)return}if(n.incoming.state!=="open")return;n.incoming.state="eof";if(n.readable)n.push(null)},CHANNEL_CLOSE:(e,t)=>{let n=this._chanMgr.get(t);if(typeof n!=="object"||n===null)return;if(n.constructor===Session){n._ending=true;n.emit("close");n=n._channel;if(!n)return}q(this,t,n)},SERVICE_REQUEST:(t,n)=>{if(l===0||h||this.authenticated||n!=="ssh-userauth"){$.disconnect(g.SERVICE_NOT_AVAILABLE);e.end();return}h=true;$.serviceAccept(n)},USERAUTH_REQUEST:(t,n,r,i,o)=>{if(l===0||this.authenticated||E&&(E.username!==n||E.service!==r)||i!=="password"&&i!=="publickey"&&i!=="hostbased"&&i!=="keyboard-interactive"&&i!=="none"||p.length===G){$.disconnect(g.PROTOCOL_ERROR);e.end();return}else if(r!=="ssh-connection"){$.disconnect(g.SERVICE_NOT_AVAILABLE);e.end();return}let f;switch(i){case"keyboard-interactive":f=new KeyboardAuthContext($,n,r,i,o,onAuthDecide);break;case"publickey":f=new PKAuthContext($,n,r,i,o,onAuthDecide);break;case"hostbased":f=new HostbasedAuthContext($,n,r,i,o,onAuthDecide);break;case"password":if(E&&E instanceof PwdAuthContext&&E._changeCb){const e=E._changeCb;E._changeCb=undefined;e(o.newPassword);return}f=new PwdAuthContext($,n,r,i,o,onAuthDecide);break;case"none":f=new AuthContext($,n,r,i,onAuthDecide);break}if(E){if(!E._initialResponse){return p.push(f)}else if(E._multistep&&!E._finalResponse){E._cleanup&&E._cleanup();E.emit("abort")}}E=f;if(s(this,"authentication"))this.emit("authentication",E);else E.reject()},USERAUTH_INFO_RESPONSE:(e,t)=>{if(E&&E instanceof KeyboardAuthContext)E._onInfoResponse(t)},GLOBAL_REQUEST:(e,t,n,r)=>{const i={type:null,buf:null};function setReply(e,t){i.type=e;i.buf=t;sendReplies()}if(n)I.push(i);if((t==="tcpip-forward"||t==="cancel-tcpip-forward"||t==="no-more-sessions@openssh.com"||t==="streamlocal-forward@openssh.com"||t==="cancel-streamlocal-forward@openssh.com")&&s(this,"request")&&this.authenticated){let e;let i;if(n){let n=false;e=e=>{if(n)return;n=true;let i;if(t==="tcpip-forward"&&r.bindPort===0&&typeof e==="number"){i=Buffer.allocUnsafe(4);v(i,e,0)}setReply("SUCCESS",i)};i=()=>{if(n)return;n=true;setReply("FAILURE")}}if(t==="no-more-sessions@openssh.com"){this.noMoreSessions=true;e&&e();return}this.emit("request",e,i,t,r)}else if(n){setReply("FAILURE")}}}});e.pause();w.then((()=>{$.start();e.on("data",(t=>{try{$.parse(t,0,t.length)}catch(t){this.emit("error",t);try{if(x(e))e.end()}catch{}}}));e.resume()})).catch((t=>{this.emit("error",t);try{if(x(e))e.end()}catch{}}));e.on("error",(e=>{e.level="socket";this.emit("error",e)})).once("end",(()=>{i&&i("Socket ended");$.cleanup();this.emit("end")})).once("close",(()=>{i&&i("Socket closed");$.cleanup();this.emit("close");const e=new Error("No response from server");this._chanMgr.cleanup(e)}));const onAuthDecide=(e,t,n,r)=>{if(E===e&&!this.authenticated){if(t){E=undefined;this.authenticated=true;$.authSuccess();p=[];this.emit("ready")}else{$.authFailure(n,r);if(p.length){E=p.pop();if(s(this,"authentication"))this.emit("authentication",E);else E.reject()}}}};function sendReplies(){while(I.length>0&&I[0].type){const e=I.shift();if(e.type==="SUCCESS")$.requestSuccess(e.buf);if(e.type==="FAILURE")$.requestFailure()}}}end(){if(this._sock&&x(this._sock)){this._protocol.disconnect(g.BY_APPLICATION);this._sock.end()}return this}x11(e,t,n){const r={originAddr:e,originPort:t};openChannel(this,"x11",r,n);return this}forwardOut(e,t,n,r,i){const s={boundAddr:e,boundPort:t,remoteAddr:n,remotePort:r};openChannel(this,"forwarded-tcpip",s,i);return this}openssh_forwardOutStreamLocal(e,t){const n={socketPath:e};openChannel(this,"forwarded-streamlocal@openssh.com",n,t);return this}rekey(e){let t;try{this._protocol.rekey()}catch(e){t=e}if(typeof e==="function"){if(t)process.nextTick(e,t);else this.once("rekey",e)}}}function openChannel(e,t,n,r){const i=T;const s=P;if(typeof n==="function"){r=n;n={}}const wrapper=(e,t)=>{r(e,t)};wrapper.type=t;const o=e._chanMgr.add(wrapper);if(o===-1){r(new Error("No free channels available"));return}switch(t){case"forwarded-tcpip":e._protocol.forwardedTcpip(o,i,s,n);break;case"x11":e._protocol.x11(o,i,s,n);break;case"forwarded-streamlocal@openssh.com":e._protocol.openssh_forwardedStreamLocal(o,i,s,n);break;default:throw new Error(`Unsupported channel type: ${t}`)}}function compareNumbers(e,t){return e-t}e.exports=Server;e.exports.IncomingClient=Client},834:(e,t,n)=>{"use strict";const{SFTP:r}=n(2026);const i=2**32-1;function onChannelOpenFailure(e,t,n,r){e._chanMgr.remove(t);if(typeof r!=="function")return;let i;if(n instanceof Error){i=n}else if(typeof n==="object"&&n!==null){i=new Error(`(SSH) Channel open failure: ${n.description}`);i.reason=n.reason}else{i=new Error("(SSH) Channel open failure: server closed channel unexpectedly");i.reason=""}r(i)}function onCHANNEL_CLOSE(e,t,n,i,s){if(typeof n==="function"){onChannelOpenFailure(e,t,i,n);return}if(typeof n!=="object"||n===null)return;if(n.incoming&&n.incoming.state==="closed")return;e._chanMgr.remove(t);if(n.server&&n.constructor.name==="Session")return;n.incoming.state="closed";if(n.readable)n.push(null);if(n.server){if(n.stderr.writable)n.stderr.end()}else if(n.stderr.readable){n.stderr.push(null)}if(n.constructor!==r&&(n.outgoing.state==="open"||n.outgoing.state==="eof")&&!s){n.close()}if(n.outgoing.state==="closing")n.outgoing.state="closed";const o=n._readableState;const f=n._writableState;if(f&&!f.ending&&!f.finished&&!s)n.end();const u=n._callbacks;n._callbacks=[];for(let e=0;e<u.length;++e)u[e](true);if(n.server){if(!n.readable||n.destroyed||o&&o.endEmitted){n.emit("close")}else{n.once("end",(()=>n.emit("close")))}}else{let e;switch(n.type){case"direct-streamlocal@openssh.com":case"direct-tcpip":e=()=>n.emit("close");break;default:{const t=n._exit;e=()=>{if(t.code===null)n.emit("close",t.code,t.signal,t.dump,t.desc);else n.emit("close",t.code)}}}if(!n.readable||n.destroyed||o&&o.endEmitted){e()}else{n.once("end",e)}const t=n.stderr._readableState;if(!n.stderr.readable||n.stderr.destroyed||t&&t.endEmitted){n.stderr.emit("close")}else{n.stderr.once("end",(()=>n.stderr.emit("close")))}}}class ChannelManager{constructor(e){this._client=e;this._channels={};this._cur=-1;this._count=0}add(e){let t;if(this._cur<i){t=++this._cur}else if(this._count===0){this._cur=0;t=0}else{const e=this._channels;for(let n=0;n<i;++n){if(e[n]===undefined){t=n;break}}}if(t===undefined)return-1;this._channels[t]=e||true;++this._count;return t}update(e,t){if(typeof e!=="number"||e<0||e>=i||!isFinite(e))throw new Error(`Invalid channel id: ${e}`);if(t&&this._channels[e])this._channels[e]=t}get(e){if(typeof e!=="number"||e<0||e>=i||!isFinite(e))throw new Error(`Invalid channel id: ${e}`);return this._channels[e]}remove(e){if(typeof e!=="number"||e<0||e>=i||!isFinite(e))throw new Error(`Invalid channel id: ${e}`);if(this._channels[e]){delete this._channels[e];if(this._count)--this._count}}cleanup(e){const t=this._channels;this._channels={};this._cur=-1;this._count=0;const n=Object.keys(t);const r=this._client;for(let i=0;i<n.length;++i){const s=+n[i];const o=t[s];onCHANNEL_CLOSE(r,s,o._channel||o,e,true)}}}const s=(()=>{const e=Object.prototype.toString;return t=>e.call(t)==="[object RegExp]"})();function generateAlgorithmList(e,t,n){if(Array.isArray(e)&&e.length>0){for(let t=0;t<e.length;++t){if(n.indexOf(e[t])===-1)throw new Error(`Unsupported algorithm: ${e[t]}`)}return e}if(typeof e==="object"&&e!==null){const r=Object.keys(e);let i=t;for(let o=0;o<r.length;++o){const f=r[o];let u=e[f];switch(f){case"append":if(!Array.isArray(u))u=[u];if(Array.isArray(u)){for(let e=0;e<u.length;++e){const r=u[e];if(typeof r==="string"){if(!r||i.indexOf(r)!==-1)continue;if(n.indexOf(r)===-1)throw new Error(`Unsupported algorithm: ${r}`);if(i===t)i=i.slice();i.push(r)}else if(s(r)){for(let e=0;e<n.length;++e){const s=n[e];if(r.test(s)){if(i.indexOf(s)!==-1)continue;if(i===t)i=i.slice();i.push(s)}}}}}break;case"prepend":if(!Array.isArray(u))u=[u];if(Array.isArray(u)){for(let e=u.length;e>=0;--e){const r=u[e];if(typeof r==="string"){if(!r||i.indexOf(r)!==-1)continue;if(n.indexOf(r)===-1)throw new Error(`Unsupported algorithm: ${r}`);if(i===t)i=i.slice();i.unshift(r)}else if(s(r)){for(let e=n.length;e>=0;--e){const s=n[e];if(r.test(s)){if(i.indexOf(s)!==-1)continue;if(i===t)i=i.slice();i.unshift(s)}}}}}break;case"remove":if(!Array.isArray(u))u=[u];if(Array.isArray(u)){for(let e=0;e<u.length;++e){const n=u[e];if(typeof n==="string"){if(!n)continue;const e=i.indexOf(n);if(e===-1)continue;if(i===t)i=i.slice();i.splice(e,1)}else if(s(n)){for(let e=0;e<i.length;++e){if(n.test(i[e])){if(i===t)i=i.slice();i.splice(e,1);--e}}}}}break}}return i}return t}e.exports={ChannelManager:ChannelManager,generateAlgorithmList:generateAlgorithmList,onChannelOpenFailure:onChannelOpenFailure,onCHANNEL_CLOSE:onCHANNEL_CLOSE,isWritable:e=>e&&e.writable&&e._readableState&&e._readableState.ended===false}},4294:(e,t,n)=>{e.exports=n(4219)},4219:(e,t,n)=>{"use strict";var r=n(1808);var i=n(4404);var s=n(3685);var o=n(5687);var f=n(2361);var u=n(9491);var l=n(3837);t.httpOverHttp=httpOverHttp;t.httpsOverHttp=httpsOverHttp;t.httpOverHttps=httpOverHttps;t.httpsOverHttps=httpsOverHttps;function httpOverHttp(e){var t=new TunnelingAgent(e);t.request=s.request;return t}function httpsOverHttp(e){var t=new TunnelingAgent(e);t.request=s.request;t.createSocket=createSecureSocket;t.defaultPort=443;return t}function httpOverHttps(e){var t=new TunnelingAgent(e);t.request=o.request;return t}function httpsOverHttps(e){var t=new TunnelingAgent(e);t.request=o.request;t.createSocket=createSecureSocket;t.defaultPort=443;return t}function TunnelingAgent(e){var t=this;t.options=e||{};t.proxyOptions=t.options.proxy||{};t.maxSockets=t.options.maxSockets||s.Agent.defaultMaxSockets;t.requests=[];t.sockets=[];t.on("free",(function onFree(e,n,r,i){var s=toOptions(n,r,i);for(var o=0,f=t.requests.length;o<f;++o){var u=t.requests[o];if(u.host===s.host&&u.port===s.port){t.requests.splice(o,1);u.request.onSocket(e);return}}e.destroy();t.removeSocket(e)}))}l.inherits(TunnelingAgent,f.EventEmitter);TunnelingAgent.prototype.addRequest=function addRequest(e,t,n,r){var i=this;var s=mergeOptions({request:e},i.options,toOptions(t,n,r));if(i.sockets.length>=this.maxSockets){i.requests.push(s);return}i.createSocket(s,(function(t){t.on("free",onFree);t.on("close",onCloseOrRemove);t.on("agentRemove",onCloseOrRemove);e.onSocket(t);function onFree(){i.emit("free",t,s)}function onCloseOrRemove(e){i.removeSocket(t);t.removeListener("free",onFree);t.removeListener("close",onCloseOrRemove);t.removeListener("agentRemove",onCloseOrRemove)}}))};TunnelingAgent.prototype.createSocket=function createSocket(e,t){var n=this;var r={};n.sockets.push(r);var i=mergeOptions({},n.proxyOptions,{method:"CONNECT",path:e.host+":"+e.port,agent:false,headers:{host:e.host+":"+e.port}});if(e.localAddress){i.localAddress=e.localAddress}if(i.proxyAuth){i.headers=i.headers||{};i.headers["Proxy-Authorization"]="Basic "+new Buffer(i.proxyAuth).toString("base64")}h("making CONNECT request");var s=n.request(i);s.useChunkedEncodingByDefault=false;s.once("response",onResponse);s.once("upgrade",onUpgrade);s.once("connect",onConnect);s.once("error",onError);s.end();function onResponse(e){e.upgrade=true}function onUpgrade(e,t,n){process.nextTick((function(){onConnect(e,t,n)}))}function onConnect(i,o,f){s.removeAllListeners();o.removeAllListeners();if(i.statusCode!==200){h("tunneling socket could not be established, statusCode=%d",i.statusCode);o.destroy();var u=new Error("tunneling socket could not be established, "+"statusCode="+i.statusCode);u.code="ECONNRESET";e.request.emit("error",u);n.removeSocket(r);return}if(f.length>0){h("got illegal response body from proxy");o.destroy();var u=new Error("got illegal response body from proxy");u.code="ECONNRESET";e.request.emit("error",u);n.removeSocket(r);return}h("tunneling connection has established");n.sockets[n.sockets.indexOf(r)]=o;return t(o)}function onError(t){s.removeAllListeners();h("tunneling socket could not be established, cause=%s\n",t.message,t.stack);var i=new Error("tunneling socket could not be established, "+"cause="+t.message);i.code="ECONNRESET";e.request.emit("error",i);n.removeSocket(r)}};TunnelingAgent.prototype.removeSocket=function removeSocket(e){var t=this.sockets.indexOf(e);if(t===-1){return}this.sockets.splice(t,1);var n=this.requests.shift();if(n){this.createSocket(n,(function(e){n.request.onSocket(e)}))}};function createSecureSocket(e,t){var n=this;TunnelingAgent.prototype.createSocket.call(n,e,(function(r){var s=e.request.getHeader("host");var o=mergeOptions({},n.options,{socket:r,servername:s?s.replace(/:.*$/,""):e.host});var f=i.connect(0,o);n.sockets[n.sockets.indexOf(r)]=f;t(f)}))}function toOptions(e,t,n){if(typeof e==="string"){return{host:e,port:t,localAddress:n}}return e}function mergeOptions(e){for(var t=1,n=arguments.length;t<n;++t){var r=arguments[t];if(typeof r==="object"){var i=Object.keys(r);for(var s=0,o=i.length;s<o;++s){var f=i[s];if(r[f]!==undefined){e[f]=r[f]}}}}return e}var h;if(process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)){h=function(){var e=Array.prototype.slice.call(arguments);if(typeof e[0]==="string"){e[0]="TUNNEL: "+e[0]}else{e.unshift("TUNNEL:")}console.error.apply(console,e)}}else{h=function(){}}t.debug=h},8729:(e,t,n)=>{(function(e){"use strict";var gf=function(e){var t,n=new Float64Array(16);if(e)for(t=0;t<e.length;t++)n[t]=e[t];return n};var randombytes=function(){throw new Error("no PRNG")};var t=new Uint8Array(16);var r=new Uint8Array(32);r[0]=9;var i=gf(),s=gf([1]),o=gf([56129,1]),f=gf([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),u=gf([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),l=gf([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),h=gf([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),p=gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ts64(e,t,n,r){e[t]=n>>24&255;e[t+1]=n>>16&255;e[t+2]=n>>8&255;e[t+3]=n&255;e[t+4]=r>>24&255;e[t+5]=r>>16&255;e[t+6]=r>>8&255;e[t+7]=r&255}function vn(e,t,n,r,i){var s,o=0;for(s=0;s<i;s++)o|=e[t+s]^n[r+s];return(1&o-1>>>8)-1}function crypto_verify_16(e,t,n,r){return vn(e,t,n,r,16)}function crypto_verify_32(e,t,n,r){return vn(e,t,n,r,32)}function core_salsa20(e,t,n,r){var i=r[0]&255|(r[1]&255)<<8|(r[2]&255)<<16|(r[3]&255)<<24,s=n[0]&255|(n[1]&255)<<8|(n[2]&255)<<16|(n[3]&255)<<24,o=n[4]&255|(n[5]&255)<<8|(n[6]&255)<<16|(n[7]&255)<<24,f=n[8]&255|(n[9]&255)<<8|(n[10]&255)<<16|(n[11]&255)<<24,u=n[12]&255|(n[13]&255)<<8|(n[14]&255)<<16|(n[15]&255)<<24,l=r[4]&255|(r[5]&255)<<8|(r[6]&255)<<16|(r[7]&255)<<24,h=t[0]&255|(t[1]&255)<<8|(t[2]&255)<<16|(t[3]&255)<<24,p=t[4]&255|(t[5]&255)<<8|(t[6]&255)<<16|(t[7]&255)<<24,g=t[8]&255|(t[9]&255)<<8|(t[10]&255)<<16|(t[11]&255)<<24,_=t[12]&255|(t[13]&255)<<8|(t[14]&255)<<16|(t[15]&255)<<24,E=r[8]&255|(r[9]&255)<<8|(r[10]&255)<<16|(r[11]&255)<<24,y=n[16]&255|(n[17]&255)<<8|(n[18]&255)<<16|(n[19]&255)<<24,m=n[20]&255|(n[21]&255)<<8|(n[22]&255)<<16|(n[23]&255)<<24,I=n[24]&255|(n[25]&255)<<8|(n[26]&255)<<16|(n[27]&255)<<24,b=n[28]&255|(n[29]&255)<<8|(n[30]&255)<<16|(n[31]&255)<<24,w=r[12]&255|(r[13]&255)<<8|(r[14]&255)<<16|(r[15]&255)<<24;var C=i,k=s,R=o,B=f,v=u,O=l,T=h,P=p,L=g,U=_,D=E,Q=y,x=m,W=I,q=b,G=w,$;for(var Y=0;Y<20;Y+=2){$=C+x|0;v^=$<<7|$>>>32-7;$=v+C|0;L^=$<<9|$>>>32-9;$=L+v|0;x^=$<<13|$>>>32-13;$=x+L|0;C^=$<<18|$>>>32-18;$=O+k|0;U^=$<<7|$>>>32-7;$=U+O|0;W^=$<<9|$>>>32-9;$=W+U|0;k^=$<<13|$>>>32-13;$=k+W|0;O^=$<<18|$>>>32-18;$=D+T|0;q^=$<<7|$>>>32-7;$=q+D|0;R^=$<<9|$>>>32-9;$=R+q|0;T^=$<<13|$>>>32-13;$=T+R|0;D^=$<<18|$>>>32-18;$=G+Q|0;B^=$<<7|$>>>32-7;$=B+G|0;P^=$<<9|$>>>32-9;$=P+B|0;Q^=$<<13|$>>>32-13;$=Q+P|0;G^=$<<18|$>>>32-18;$=C+B|0;k^=$<<7|$>>>32-7;$=k+C|0;R^=$<<9|$>>>32-9;$=R+k|0;B^=$<<13|$>>>32-13;$=B+R|0;C^=$<<18|$>>>32-18;$=O+v|0;T^=$<<7|$>>>32-7;$=T+O|0;P^=$<<9|$>>>32-9;$=P+T|0;v^=$<<13|$>>>32-13;$=v+P|0;O^=$<<18|$>>>32-18;$=D+U|0;Q^=$<<7|$>>>32-7;$=Q+D|0;L^=$<<9|$>>>32-9;$=L+Q|0;U^=$<<13|$>>>32-13;$=U+L|0;D^=$<<18|$>>>32-18;$=G+q|0;x^=$<<7|$>>>32-7;$=x+G|0;W^=$<<9|$>>>32-9;$=W+x|0;q^=$<<13|$>>>32-13;$=q+W|0;G^=$<<18|$>>>32-18}C=C+i|0;k=k+s|0;R=R+o|0;B=B+f|0;v=v+u|0;O=O+l|0;T=T+h|0;P=P+p|0;L=L+g|0;U=U+_|0;D=D+E|0;Q=Q+y|0;x=x+m|0;W=W+I|0;q=q+b|0;G=G+w|0;e[0]=C>>>0&255;e[1]=C>>>8&255;e[2]=C>>>16&255;e[3]=C>>>24&255;e[4]=k>>>0&255;e[5]=k>>>8&255;e[6]=k>>>16&255;e[7]=k>>>24&255;e[8]=R>>>0&255;e[9]=R>>>8&255;e[10]=R>>>16&255;e[11]=R>>>24&255;e[12]=B>>>0&255;e[13]=B>>>8&255;e[14]=B>>>16&255;e[15]=B>>>24&255;e[16]=v>>>0&255;e[17]=v>>>8&255;e[18]=v>>>16&255;e[19]=v>>>24&255;e[20]=O>>>0&255;e[21]=O>>>8&255;e[22]=O>>>16&255;e[23]=O>>>24&255;e[24]=T>>>0&255;e[25]=T>>>8&255;e[26]=T>>>16&255;e[27]=T>>>24&255;e[28]=P>>>0&255;e[29]=P>>>8&255;e[30]=P>>>16&255;e[31]=P>>>24&255;e[32]=L>>>0&255;e[33]=L>>>8&255;e[34]=L>>>16&255;e[35]=L>>>24&255;e[36]=U>>>0&255;e[37]=U>>>8&255;e[38]=U>>>16&255;e[39]=U>>>24&255;e[40]=D>>>0&255;e[41]=D>>>8&255;e[42]=D>>>16&255;e[43]=D>>>24&255;e[44]=Q>>>0&255;e[45]=Q>>>8&255;e[46]=Q>>>16&255;e[47]=Q>>>24&255;e[48]=x>>>0&255;e[49]=x>>>8&255;e[50]=x>>>16&255;e[51]=x>>>24&255;e[52]=W>>>0&255;e[53]=W>>>8&255;e[54]=W>>>16&255;e[55]=W>>>24&255;e[56]=q>>>0&255;e[57]=q>>>8&255;e[58]=q>>>16&255;e[59]=q>>>24&255;e[60]=G>>>0&255;e[61]=G>>>8&255;e[62]=G>>>16&255;e[63]=G>>>24&255}function core_hsalsa20(e,t,n,r){var i=r[0]&255|(r[1]&255)<<8|(r[2]&255)<<16|(r[3]&255)<<24,s=n[0]&255|(n[1]&255)<<8|(n[2]&255)<<16|(n[3]&255)<<24,o=n[4]&255|(n[5]&255)<<8|(n[6]&255)<<16|(n[7]&255)<<24,f=n[8]&255|(n[9]&255)<<8|(n[10]&255)<<16|(n[11]&255)<<24,u=n[12]&255|(n[13]&255)<<8|(n[14]&255)<<16|(n[15]&255)<<24,l=r[4]&255|(r[5]&255)<<8|(r[6]&255)<<16|(r[7]&255)<<24,h=t[0]&255|(t[1]&255)<<8|(t[2]&255)<<16|(t[3]&255)<<24,p=t[4]&255|(t[5]&255)<<8|(t[6]&255)<<16|(t[7]&255)<<24,g=t[8]&255|(t[9]&255)<<8|(t[10]&255)<<16|(t[11]&255)<<24,_=t[12]&255|(t[13]&255)<<8|(t[14]&255)<<16|(t[15]&255)<<24,E=r[8]&255|(r[9]&255)<<8|(r[10]&255)<<16|(r[11]&255)<<24,y=n[16]&255|(n[17]&255)<<8|(n[18]&255)<<16|(n[19]&255)<<24,m=n[20]&255|(n[21]&255)<<8|(n[22]&255)<<16|(n[23]&255)<<24,I=n[24]&255|(n[25]&255)<<8|(n[26]&255)<<16|(n[27]&255)<<24,b=n[28]&255|(n[29]&255)<<8|(n[30]&255)<<16|(n[31]&255)<<24,w=r[12]&255|(r[13]&255)<<8|(r[14]&255)<<16|(r[15]&255)<<24;var C=i,k=s,R=o,B=f,v=u,O=l,T=h,P=p,L=g,U=_,D=E,Q=y,x=m,W=I,q=b,G=w,$;for(var Y=0;Y<20;Y+=2){$=C+x|0;v^=$<<7|$>>>32-7;$=v+C|0;L^=$<<9|$>>>32-9;$=L+v|0;x^=$<<13|$>>>32-13;$=x+L|0;C^=$<<18|$>>>32-18;$=O+k|0;U^=$<<7|$>>>32-7;$=U+O|0;W^=$<<9|$>>>32-9;$=W+U|0;k^=$<<13|$>>>32-13;$=k+W|0;O^=$<<18|$>>>32-18;$=D+T|0;q^=$<<7|$>>>32-7;$=q+D|0;R^=$<<9|$>>>32-9;$=R+q|0;T^=$<<13|$>>>32-13;$=T+R|0;D^=$<<18|$>>>32-18;$=G+Q|0;B^=$<<7|$>>>32-7;$=B+G|0;P^=$<<9|$>>>32-9;$=P+B|0;Q^=$<<13|$>>>32-13;$=Q+P|0;G^=$<<18|$>>>32-18;$=C+B|0;k^=$<<7|$>>>32-7;$=k+C|0;R^=$<<9|$>>>32-9;$=R+k|0;B^=$<<13|$>>>32-13;$=B+R|0;C^=$<<18|$>>>32-18;$=O+v|0;T^=$<<7|$>>>32-7;$=T+O|0;P^=$<<9|$>>>32-9;$=P+T|0;v^=$<<13|$>>>32-13;$=v+P|0;O^=$<<18|$>>>32-18;$=D+U|0;Q^=$<<7|$>>>32-7;$=Q+D|0;L^=$<<9|$>>>32-9;$=L+Q|0;U^=$<<13|$>>>32-13;$=U+L|0;D^=$<<18|$>>>32-18;$=G+q|0;x^=$<<7|$>>>32-7;$=x+G|0;W^=$<<9|$>>>32-9;$=W+x|0;q^=$<<13|$>>>32-13;$=q+W|0;G^=$<<18|$>>>32-18}e[0]=C>>>0&255;e[1]=C>>>8&255;e[2]=C>>>16&255;e[3]=C>>>24&255;e[4]=O>>>0&255;e[5]=O>>>8&255;e[6]=O>>>16&255;e[7]=O>>>24&255;e[8]=D>>>0&255;e[9]=D>>>8&255;e[10]=D>>>16&255;e[11]=D>>>24&255;e[12]=G>>>0&255;e[13]=G>>>8&255;e[14]=G>>>16&255;e[15]=G>>>24&255;e[16]=T>>>0&255;e[17]=T>>>8&255;e[18]=T>>>16&255;e[19]=T>>>24&255;e[20]=P>>>0&255;e[21]=P>>>8&255;e[22]=P>>>16&255;e[23]=P>>>24&255;e[24]=L>>>0&255;e[25]=L>>>8&255;e[26]=L>>>16&255;e[27]=L>>>24&255;e[28]=U>>>0&255;e[29]=U>>>8&255;e[30]=U>>>16&255;e[31]=U>>>24&255}function crypto_core_salsa20(e,t,n,r){core_salsa20(e,t,n,r)}function crypto_core_hsalsa20(e,t,n,r){core_hsalsa20(e,t,n,r)}var g=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function crypto_stream_salsa20_xor(e,t,n,r,i,s,o){var f=new Uint8Array(16),u=new Uint8Array(64);var l,h;for(h=0;h<16;h++)f[h]=0;for(h=0;h<8;h++)f[h]=s[h];while(i>=64){crypto_core_salsa20(u,f,o,g);for(h=0;h<64;h++)e[t+h]=n[r+h]^u[h];l=1;for(h=8;h<16;h++){l=l+(f[h]&255)|0;f[h]=l&255;l>>>=8}i-=64;t+=64;r+=64}if(i>0){crypto_core_salsa20(u,f,o,g);for(h=0;h<i;h++)e[t+h]=n[r+h]^u[h]}return 0}function crypto_stream_salsa20(e,t,n,r,i){var s=new Uint8Array(16),o=new Uint8Array(64);var f,u;for(u=0;u<16;u++)s[u]=0;for(u=0;u<8;u++)s[u]=r[u];while(n>=64){crypto_core_salsa20(o,s,i,g);for(u=0;u<64;u++)e[t+u]=o[u];f=1;for(u=8;u<16;u++){f=f+(s[u]&255)|0;s[u]=f&255;f>>>=8}n-=64;t+=64}if(n>0){crypto_core_salsa20(o,s,i,g);for(u=0;u<n;u++)e[t+u]=o[u]}return 0}function crypto_stream(e,t,n,r,i){var s=new Uint8Array(32);crypto_core_hsalsa20(s,r,i,g);var o=new Uint8Array(8);for(var f=0;f<8;f++)o[f]=r[f+16];return crypto_stream_salsa20(e,t,n,o,s)}function crypto_stream_xor(e,t,n,r,i,s,o){var f=new Uint8Array(32);crypto_core_hsalsa20(f,s,o,g);var u=new Uint8Array(8);for(var l=0;l<8;l++)u[l]=s[l+16];return crypto_stream_salsa20_xor(e,t,n,r,i,u,f)}var poly1305=function(e){this.buffer=new Uint8Array(16);this.r=new Uint16Array(10);this.h=new Uint16Array(10);this.pad=new Uint16Array(8);this.leftover=0;this.fin=0;var t,n,r,i,s,o,f,u;t=e[0]&255|(e[1]&255)<<8;this.r[0]=t&8191;n=e[2]&255|(e[3]&255)<<8;this.r[1]=(t>>>13|n<<3)&8191;r=e[4]&255|(e[5]&255)<<8;this.r[2]=(n>>>10|r<<6)&7939;i=e[6]&255|(e[7]&255)<<8;this.r[3]=(r>>>7|i<<9)&8191;s=e[8]&255|(e[9]&255)<<8;this.r[4]=(i>>>4|s<<12)&255;this.r[5]=s>>>1&8190;o=e[10]&255|(e[11]&255)<<8;this.r[6]=(s>>>14|o<<2)&8191;f=e[12]&255|(e[13]&255)<<8;this.r[7]=(o>>>11|f<<5)&8065;u=e[14]&255|(e[15]&255)<<8;this.r[8]=(f>>>8|u<<8)&8191;this.r[9]=u>>>5&127;this.pad[0]=e[16]&255|(e[17]&255)<<8;this.pad[1]=e[18]&255|(e[19]&255)<<8;this.pad[2]=e[20]&255|(e[21]&255)<<8;this.pad[3]=e[22]&255|(e[23]&255)<<8;this.pad[4]=e[24]&255|(e[25]&255)<<8;this.pad[5]=e[26]&255|(e[27]&255)<<8;this.pad[6]=e[28]&255|(e[29]&255)<<8;this.pad[7]=e[30]&255|(e[31]&255)<<8};poly1305.prototype.blocks=function(e,t,n){var r=this.fin?0:1<<11;var i,s,o,f,u,l,h,p,g;var _,E,y,m,I,b,w,C,k,R;var B=this.h[0],v=this.h[1],O=this.h[2],T=this.h[3],P=this.h[4],L=this.h[5],U=this.h[6],D=this.h[7],Q=this.h[8],x=this.h[9];var W=this.r[0],q=this.r[1],G=this.r[2],$=this.r[3],Y=this.r[4],j=this.r[5],V=this.r[6],z=this.r[7],J=this.r[8],ee=this.r[9];while(n>=16){i=e[t+0]&255|(e[t+1]&255)<<8;B+=i&8191;s=e[t+2]&255|(e[t+3]&255)<<8;v+=(i>>>13|s<<3)&8191;o=e[t+4]&255|(e[t+5]&255)<<8;O+=(s>>>10|o<<6)&8191;f=e[t+6]&255|(e[t+7]&255)<<8;T+=(o>>>7|f<<9)&8191;u=e[t+8]&255|(e[t+9]&255)<<8;P+=(f>>>4|u<<12)&8191;L+=u>>>1&8191;l=e[t+10]&255|(e[t+11]&255)<<8;U+=(u>>>14|l<<2)&8191;h=e[t+12]&255|(e[t+13]&255)<<8;D+=(l>>>11|h<<5)&8191;p=e[t+14]&255|(e[t+15]&255)<<8;Q+=(h>>>8|p<<8)&8191;x+=p>>>5|r;g=0;_=g;_+=B*W;_+=v*(5*ee);_+=O*(5*J);_+=T*(5*z);_+=P*(5*V);g=_>>>13;_&=8191;_+=L*(5*j);_+=U*(5*Y);_+=D*(5*$);_+=Q*(5*G);_+=x*(5*q);g+=_>>>13;_&=8191;E=g;E+=B*q;E+=v*W;E+=O*(5*ee);E+=T*(5*J);E+=P*(5*z);g=E>>>13;E&=8191;E+=L*(5*V);E+=U*(5*j);E+=D*(5*Y);E+=Q*(5*$);E+=x*(5*G);g+=E>>>13;E&=8191;y=g;y+=B*G;y+=v*q;y+=O*W;y+=T*(5*ee);y+=P*(5*J);g=y>>>13;y&=8191;y+=L*(5*z);y+=U*(5*V);y+=D*(5*j);y+=Q*(5*Y);y+=x*(5*$);g+=y>>>13;y&=8191;m=g;m+=B*$;m+=v*G;m+=O*q;m+=T*W;m+=P*(5*ee);g=m>>>13;m&=8191;m+=L*(5*J);m+=U*(5*z);m+=D*(5*V);m+=Q*(5*j);m+=x*(5*Y);g+=m>>>13;m&=8191;I=g;I+=B*Y;I+=v*$;I+=O*G;I+=T*q;I+=P*W;g=I>>>13;I&=8191;I+=L*(5*ee);I+=U*(5*J);I+=D*(5*z);I+=Q*(5*V);I+=x*(5*j);g+=I>>>13;I&=8191;b=g;b+=B*j;b+=v*Y;b+=O*$;b+=T*G;b+=P*q;g=b>>>13;b&=8191;b+=L*W;b+=U*(5*ee);b+=D*(5*J);b+=Q*(5*z);b+=x*(5*V);g+=b>>>13;b&=8191;w=g;w+=B*V;w+=v*j;w+=O*Y;w+=T*$;w+=P*G;g=w>>>13;w&=8191;w+=L*q;w+=U*W;w+=D*(5*ee);w+=Q*(5*J);w+=x*(5*z);g+=w>>>13;w&=8191;C=g;C+=B*z;C+=v*V;C+=O*j;C+=T*Y;C+=P*$;g=C>>>13;C&=8191;C+=L*G;C+=U*q;C+=D*W;C+=Q*(5*ee);C+=x*(5*J);g+=C>>>13;C&=8191;k=g;k+=B*J;k+=v*z;k+=O*V;k+=T*j;k+=P*Y;g=k>>>13;k&=8191;k+=L*$;k+=U*G;k+=D*q;k+=Q*W;k+=x*(5*ee);g+=k>>>13;k&=8191;R=g;R+=B*ee;R+=v*J;R+=O*z;R+=T*V;R+=P*j;g=R>>>13;R&=8191;R+=L*Y;R+=U*$;R+=D*G;R+=Q*q;R+=x*W;g+=R>>>13;R&=8191;g=(g<<2)+g|0;g=g+_|0;_=g&8191;g=g>>>13;E+=g;B=_;v=E;O=y;T=m;P=I;L=b;U=w;D=C;Q=k;x=R;t+=16;n-=16}this.h[0]=B;this.h[1]=v;this.h[2]=O;this.h[3]=T;this.h[4]=P;this.h[5]=L;this.h[6]=U;this.h[7]=D;this.h[8]=Q;this.h[9]=x};poly1305.prototype.finish=function(e,t){var n=new Uint16Array(10);var r,i,s,o;if(this.leftover){o=this.leftover;this.buffer[o++]=1;for(;o<16;o++)this.buffer[o]=0;this.fin=1;this.blocks(this.buffer,0,16)}r=this.h[1]>>>13;this.h[1]&=8191;for(o=2;o<10;o++){this.h[o]+=r;r=this.h[o]>>>13;this.h[o]&=8191}this.h[0]+=r*5;r=this.h[0]>>>13;this.h[0]&=8191;this.h[1]+=r;r=this.h[1]>>>13;this.h[1]&=8191;this.h[2]+=r;n[0]=this.h[0]+5;r=n[0]>>>13;n[0]&=8191;for(o=1;o<10;o++){n[o]=this.h[o]+r;r=n[o]>>>13;n[o]&=8191}n[9]-=1<<13;i=(r^1)-1;for(o=0;o<10;o++)n[o]&=i;i=~i;for(o=0;o<10;o++)this.h[o]=this.h[o]&i|n[o];this.h[0]=(this.h[0]|this.h[1]<<13)&65535;this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535;this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535;this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535;this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535;this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535;this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535;this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535;s=this.h[0]+this.pad[0];this.h[0]=s&65535;for(o=1;o<8;o++){s=(this.h[o]+this.pad[o]|0)+(s>>>16)|0;this.h[o]=s&65535}e[t+0]=this.h[0]>>>0&255;e[t+1]=this.h[0]>>>8&255;e[t+2]=this.h[1]>>>0&255;e[t+3]=this.h[1]>>>8&255;e[t+4]=this.h[2]>>>0&255;e[t+5]=this.h[2]>>>8&255;e[t+6]=this.h[3]>>>0&255;e[t+7]=this.h[3]>>>8&255;e[t+8]=this.h[4]>>>0&255;e[t+9]=this.h[4]>>>8&255;e[t+10]=this.h[5]>>>0&255;e[t+11]=this.h[5]>>>8&255;e[t+12]=this.h[6]>>>0&255;e[t+13]=this.h[6]>>>8&255;e[t+14]=this.h[7]>>>0&255;e[t+15]=this.h[7]>>>8&255};poly1305.prototype.update=function(e,t,n){var r,i;if(this.leftover){i=16-this.leftover;if(i>n)i=n;for(r=0;r<i;r++)this.buffer[this.leftover+r]=e[t+r];n-=i;t+=i;this.leftover+=i;if(this.leftover<16)return;this.blocks(this.buffer,0,16);this.leftover=0}if(n>=16){i=n-n%16;this.blocks(e,t,i);t+=i;n-=i}if(n){for(r=0;r<n;r++)this.buffer[this.leftover+r]=e[t+r];this.leftover+=n}};function crypto_onetimeauth(e,t,n,r,i,s){var o=new poly1305(s);o.update(n,r,i);o.finish(e,t);return 0}function crypto_onetimeauth_verify(e,t,n,r,i,s){var o=new Uint8Array(16);crypto_onetimeauth(o,0,n,r,i,s);return crypto_verify_16(e,t,o,0)}function crypto_secretbox(e,t,n,r,i){var s;if(n<32)return-1;crypto_stream_xor(e,0,t,0,n,r,i);crypto_onetimeauth(e,16,e,32,n-32,e);for(s=0;s<16;s++)e[s]=0;return 0}function crypto_secretbox_open(e,t,n,r,i){var s;var o=new Uint8Array(32);if(n<32)return-1;crypto_stream(o,0,32,r,i);if(crypto_onetimeauth_verify(t,16,t,32,n-32,o)!==0)return-1;crypto_stream_xor(e,0,t,0,n,r,i);for(s=0;s<32;s++)e[s]=0;return 0}function set25519(e,t){var n;for(n=0;n<16;n++)e[n]=t[n]|0}function car25519(e){var t,n,r=1;for(t=0;t<16;t++){n=e[t]+r+65535;r=Math.floor(n/65536);e[t]=n-r*65536}e[0]+=r-1+37*(r-1)}function sel25519(e,t,n){var r,i=~(n-1);for(var s=0;s<16;s++){r=i&(e[s]^t[s]);e[s]^=r;t[s]^=r}}function pack25519(e,t){var n,r,i;var s=gf(),o=gf();for(n=0;n<16;n++)o[n]=t[n];car25519(o);car25519(o);car25519(o);for(r=0;r<2;r++){s[0]=o[0]-65517;for(n=1;n<15;n++){s[n]=o[n]-65535-(s[n-1]>>16&1);s[n-1]&=65535}s[15]=o[15]-32767-(s[14]>>16&1);i=s[15]>>16&1;s[14]&=65535;sel25519(o,s,1-i)}for(n=0;n<16;n++){e[2*n]=o[n]&255;e[2*n+1]=o[n]>>8}}function neq25519(e,t){var n=new Uint8Array(32),r=new Uint8Array(32);pack25519(n,e);pack25519(r,t);return crypto_verify_32(n,0,r,0)}function par25519(e){var t=new Uint8Array(32);pack25519(t,e);return t[0]&1}function unpack25519(e,t){var n;for(n=0;n<16;n++)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767}function A(e,t,n){for(var r=0;r<16;r++)e[r]=t[r]+n[r]}function Z(e,t,n){for(var r=0;r<16;r++)e[r]=t[r]-n[r]}function M(e,t,n){var r,i,s=0,o=0,f=0,u=0,l=0,h=0,p=0,g=0,_=0,E=0,y=0,m=0,I=0,b=0,w=0,C=0,k=0,R=0,B=0,v=0,O=0,T=0,P=0,L=0,U=0,D=0,Q=0,x=0,W=0,q=0,G=0,$=n[0],Y=n[1],j=n[2],V=n[3],z=n[4],J=n[5],ee=n[6],te=n[7],ne=n[8],re=n[9],ie=n[10],se=n[11],oe=n[12],ae=n[13],ce=n[14],fe=n[15];r=t[0];s+=r*$;o+=r*Y;f+=r*j;u+=r*V;l+=r*z;h+=r*J;p+=r*ee;g+=r*te;_+=r*ne;E+=r*re;y+=r*ie;m+=r*se;I+=r*oe;b+=r*ae;w+=r*ce;C+=r*fe;r=t[1];o+=r*$;f+=r*Y;u+=r*j;l+=r*V;h+=r*z;p+=r*J;g+=r*ee;_+=r*te;E+=r*ne;y+=r*re;m+=r*ie;I+=r*se;b+=r*oe;w+=r*ae;C+=r*ce;k+=r*fe;r=t[2];f+=r*$;u+=r*Y;l+=r*j;h+=r*V;p+=r*z;g+=r*J;_+=r*ee;E+=r*te;y+=r*ne;m+=r*re;I+=r*ie;b+=r*se;w+=r*oe;C+=r*ae;k+=r*ce;R+=r*fe;r=t[3];u+=r*$;l+=r*Y;h+=r*j;p+=r*V;g+=r*z;_+=r*J;E+=r*ee;y+=r*te;m+=r*ne;I+=r*re;b+=r*ie;w+=r*se;C+=r*oe;k+=r*ae;R+=r*ce;B+=r*fe;r=t[4];l+=r*$;h+=r*Y;p+=r*j;g+=r*V;_+=r*z;E+=r*J;y+=r*ee;m+=r*te;I+=r*ne;b+=r*re;w+=r*ie;C+=r*se;k+=r*oe;R+=r*ae;B+=r*ce;v+=r*fe;r=t[5];h+=r*$;p+=r*Y;g+=r*j;_+=r*V;E+=r*z;y+=r*J;m+=r*ee;I+=r*te;b+=r*ne;w+=r*re;C+=r*ie;k+=r*se;R+=r*oe;B+=r*ae;v+=r*ce;O+=r*fe;r=t[6];p+=r*$;g+=r*Y;_+=r*j;E+=r*V;y+=r*z;m+=r*J;I+=r*ee;b+=r*te;w+=r*ne;C+=r*re;k+=r*ie;R+=r*se;B+=r*oe;v+=r*ae;O+=r*ce;T+=r*fe;r=t[7];g+=r*$;_+=r*Y;E+=r*j;y+=r*V;m+=r*z;I+=r*J;b+=r*ee;w+=r*te;C+=r*ne;k+=r*re;R+=r*ie;B+=r*se;v+=r*oe;O+=r*ae;T+=r*ce;P+=r*fe;r=t[8];_+=r*$;E+=r*Y;y+=r*j;m+=r*V;I+=r*z;b+=r*J;w+=r*ee;C+=r*te;k+=r*ne;R+=r*re;B+=r*ie;v+=r*se;O+=r*oe;T+=r*ae;P+=r*ce;L+=r*fe;r=t[9];E+=r*$;y+=r*Y;m+=r*j;I+=r*V;b+=r*z;w+=r*J;C+=r*ee;k+=r*te;R+=r*ne;B+=r*re;v+=r*ie;O+=r*se;T+=r*oe;P+=r*ae;L+=r*ce;U+=r*fe;r=t[10];y+=r*$;m+=r*Y;I+=r*j;b+=r*V;w+=r*z;C+=r*J;k+=r*ee;R+=r*te;B+=r*ne;v+=r*re;O+=r*ie;T+=r*se;P+=r*oe;L+=r*ae;U+=r*ce;D+=r*fe;r=t[11];m+=r*$;I+=r*Y;b+=r*j;w+=r*V;C+=r*z;k+=r*J;R+=r*ee;B+=r*te;v+=r*ne;O+=r*re;T+=r*ie;P+=r*se;L+=r*oe;U+=r*ae;D+=r*ce;Q+=r*fe;r=t[12];I+=r*$;b+=r*Y;w+=r*j;C+=r*V;k+=r*z;R+=r*J;B+=r*ee;v+=r*te;O+=r*ne;T+=r*re;P+=r*ie;L+=r*se;U+=r*oe;D+=r*ae;Q+=r*ce;x+=r*fe;r=t[13];b+=r*$;w+=r*Y;C+=r*j;k+=r*V;R+=r*z;B+=r*J;v+=r*ee;O+=r*te;T+=r*ne;P+=r*re;L+=r*ie;U+=r*se;D+=r*oe;Q+=r*ae;x+=r*ce;W+=r*fe;r=t[14];w+=r*$;C+=r*Y;k+=r*j;R+=r*V;B+=r*z;v+=r*J;O+=r*ee;T+=r*te;P+=r*ne;L+=r*re;U+=r*ie;D+=r*se;Q+=r*oe;x+=r*ae;W+=r*ce;q+=r*fe;r=t[15];C+=r*$;k+=r*Y;R+=r*j;B+=r*V;v+=r*z;O+=r*J;T+=r*ee;P+=r*te;L+=r*ne;U+=r*re;D+=r*ie;Q+=r*se;x+=r*oe;W+=r*ae;q+=r*ce;G+=r*fe;s+=38*k;o+=38*R;f+=38*B;u+=38*v;l+=38*O;h+=38*T;p+=38*P;g+=38*L;_+=38*U;E+=38*D;y+=38*Q;m+=38*x;I+=38*W;b+=38*q;w+=38*G;i=1;r=s+i+65535;i=Math.floor(r/65536);s=r-i*65536;r=o+i+65535;i=Math.floor(r/65536);o=r-i*65536;r=f+i+65535;i=Math.floor(r/65536);f=r-i*65536;r=u+i+65535;i=Math.floor(r/65536);u=r-i*65536;r=l+i+65535;i=Math.floor(r/65536);l=r-i*65536;r=h+i+65535;i=Math.floor(r/65536);h=r-i*65536;r=p+i+65535;i=Math.floor(r/65536);p=r-i*65536;r=g+i+65535;i=Math.floor(r/65536);g=r-i*65536;r=_+i+65535;i=Math.floor(r/65536);_=r-i*65536;r=E+i+65535;i=Math.floor(r/65536);E=r-i*65536;r=y+i+65535;i=Math.floor(r/65536);y=r-i*65536;r=m+i+65535;i=Math.floor(r/65536);m=r-i*65536;r=I+i+65535;i=Math.floor(r/65536);I=r-i*65536;r=b+i+65535;i=Math.floor(r/65536);b=r-i*65536;r=w+i+65535;i=Math.floor(r/65536);w=r-i*65536;r=C+i+65535;i=Math.floor(r/65536);C=r-i*65536;s+=i-1+37*(i-1);i=1;r=s+i+65535;i=Math.floor(r/65536);s=r-i*65536;r=o+i+65535;i=Math.floor(r/65536);o=r-i*65536;r=f+i+65535;i=Math.floor(r/65536);f=r-i*65536;r=u+i+65535;i=Math.floor(r/65536);u=r-i*65536;r=l+i+65535;i=Math.floor(r/65536);l=r-i*65536;r=h+i+65535;i=Math.floor(r/65536);h=r-i*65536;r=p+i+65535;i=Math.floor(r/65536);p=r-i*65536;r=g+i+65535;i=Math.floor(r/65536);g=r-i*65536;r=_+i+65535;i=Math.floor(r/65536);_=r-i*65536;r=E+i+65535;i=Math.floor(r/65536);E=r-i*65536;r=y+i+65535;i=Math.floor(r/65536);y=r-i*65536;r=m+i+65535;i=Math.floor(r/65536);m=r-i*65536;r=I+i+65535;i=Math.floor(r/65536);I=r-i*65536;r=b+i+65535;i=Math.floor(r/65536);b=r-i*65536;r=w+i+65535;i=Math.floor(r/65536);w=r-i*65536;r=C+i+65535;i=Math.floor(r/65536);C=r-i*65536;s+=i-1+37*(i-1);e[0]=s;e[1]=o;e[2]=f;e[3]=u;e[4]=l;e[5]=h;e[6]=p;e[7]=g;e[8]=_;e[9]=E;e[10]=y;e[11]=m;e[12]=I;e[13]=b;e[14]=w;e[15]=C}function S(e,t){M(e,t,t)}function inv25519(e,t){var n=gf();var r;for(r=0;r<16;r++)n[r]=t[r];for(r=253;r>=0;r--){S(n,n);if(r!==2&&r!==4)M(n,n,t)}for(r=0;r<16;r++)e[r]=n[r]}function pow2523(e,t){var n=gf();var r;for(r=0;r<16;r++)n[r]=t[r];for(r=250;r>=0;r--){S(n,n);if(r!==1)M(n,n,t)}for(r=0;r<16;r++)e[r]=n[r]}function crypto_scalarmult(e,t,n){var r=new Uint8Array(32);var i=new Float64Array(80),s,f;var u=gf(),l=gf(),h=gf(),p=gf(),g=gf(),_=gf();for(f=0;f<31;f++)r[f]=t[f];r[31]=t[31]&127|64;r[0]&=248;unpack25519(i,n);for(f=0;f<16;f++){l[f]=i[f];p[f]=u[f]=h[f]=0}u[0]=p[0]=1;for(f=254;f>=0;--f){s=r[f>>>3]>>>(f&7)&1;sel25519(u,l,s);sel25519(h,p,s);A(g,u,h);Z(u,u,h);A(h,l,p);Z(l,l,p);S(p,g);S(_,u);M(u,h,u);M(h,l,g);A(g,u,h);Z(u,u,h);S(l,u);Z(h,p,_);M(u,h,o);A(u,u,p);M(h,h,u);M(u,p,_);M(p,l,i);S(l,g);sel25519(u,l,s);sel25519(h,p,s)}for(f=0;f<16;f++){i[f+16]=u[f];i[f+32]=h[f];i[f+48]=l[f];i[f+64]=p[f]}var E=i.subarray(32);var y=i.subarray(16);inv25519(E,E);M(y,y,E);pack25519(e,y);return 0}function crypto_scalarmult_base(e,t){return crypto_scalarmult(e,t,r)}function crypto_box_keypair(e,t){randombytes(t,32);return crypto_scalarmult_base(e,t)}function crypto_box_beforenm(e,n,r){var i=new Uint8Array(32);crypto_scalarmult(i,r,n);return crypto_core_hsalsa20(e,t,i,g)}var _=crypto_secretbox;var E=crypto_secretbox_open;function crypto_box(e,t,n,r,i,s){var o=new Uint8Array(32);crypto_box_beforenm(o,i,s);return _(e,t,n,r,o)}function crypto_box_open(e,t,n,r,i,s){var o=new Uint8Array(32);crypto_box_beforenm(o,i,s);return E(e,t,n,r,o)}var y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function crypto_hashblocks_hl(e,t,n,r){var i=new Int32Array(16),s=new Int32Array(16),o,f,u,l,h,p,g,_,E,m,I,b,w,C,k,R,B,v,O,T,P,L,U,D,Q,x;var W=e[0],q=e[1],G=e[2],$=e[3],Y=e[4],j=e[5],V=e[6],z=e[7],J=t[0],ee=t[1],te=t[2],ne=t[3],re=t[4],ie=t[5],se=t[6],oe=t[7];var ae=0;while(r>=128){for(O=0;O<16;O++){T=8*O+ae;i[O]=n[T+0]<<24|n[T+1]<<16|n[T+2]<<8|n[T+3];s[O]=n[T+4]<<24|n[T+5]<<16|n[T+6]<<8|n[T+7]}for(O=0;O<80;O++){o=W;f=q;u=G;l=$;h=Y;p=j;g=V;_=z;E=J;m=ee;I=te;b=ne;w=re;C=ie;k=se;R=oe;P=z;L=oe;U=L&65535;D=L>>>16;Q=P&65535;x=P>>>16;P=(Y>>>14|re<<32-14)^(Y>>>18|re<<32-18)^(re>>>41-32|Y<<32-(41-32));L=(re>>>14|Y<<32-14)^(re>>>18|Y<<32-18)^(Y>>>41-32|re<<32-(41-32));U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;P=Y&j^~Y&V;L=re&ie^~re&se;U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;P=y[O*2];L=y[O*2+1];U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;P=i[O%16];L=s[O%16];U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;D+=U>>>16;Q+=D>>>16;x+=Q>>>16;B=Q&65535|x<<16;v=U&65535|D<<16;P=B;L=v;U=L&65535;D=L>>>16;Q=P&65535;x=P>>>16;P=(W>>>28|J<<32-28)^(J>>>34-32|W<<32-(34-32))^(J>>>39-32|W<<32-(39-32));L=(J>>>28|W<<32-28)^(W>>>34-32|J<<32-(34-32))^(W>>>39-32|J<<32-(39-32));U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;P=W&q^W&G^q&G;L=J&ee^J&te^ee&te;U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;D+=U>>>16;Q+=D>>>16;x+=Q>>>16;_=Q&65535|x<<16;R=U&65535|D<<16;P=l;L=b;U=L&65535;D=L>>>16;Q=P&65535;x=P>>>16;P=B;L=v;U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;D+=U>>>16;Q+=D>>>16;x+=Q>>>16;l=Q&65535|x<<16;b=U&65535|D<<16;q=o;G=f;$=u;Y=l;j=h;V=p;z=g;W=_;ee=E;te=m;ne=I;re=b;ie=w;se=C;oe=k;J=R;if(O%16===15){for(T=0;T<16;T++){P=i[T];L=s[T];U=L&65535;D=L>>>16;Q=P&65535;x=P>>>16;P=i[(T+9)%16];L=s[(T+9)%16];U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;B=i[(T+1)%16];v=s[(T+1)%16];P=(B>>>1|v<<32-1)^(B>>>8|v<<32-8)^B>>>7;L=(v>>>1|B<<32-1)^(v>>>8|B<<32-8)^(v>>>7|B<<32-7);U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;B=i[(T+14)%16];v=s[(T+14)%16];P=(B>>>19|v<<32-19)^(v>>>61-32|B<<32-(61-32))^B>>>6;L=(v>>>19|B<<32-19)^(B>>>61-32|v<<32-(61-32))^(v>>>6|B<<32-6);U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;D+=U>>>16;Q+=D>>>16;x+=Q>>>16;i[T]=Q&65535|x<<16;s[T]=U&65535|D<<16}}}P=W;L=J;U=L&65535;D=L>>>16;Q=P&65535;x=P>>>16;P=e[0];L=t[0];U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;D+=U>>>16;Q+=D>>>16;x+=Q>>>16;e[0]=W=Q&65535|x<<16;t[0]=J=U&65535|D<<16;P=q;L=ee;U=L&65535;D=L>>>16;Q=P&65535;x=P>>>16;P=e[1];L=t[1];U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;D+=U>>>16;Q+=D>>>16;x+=Q>>>16;e[1]=q=Q&65535|x<<16;t[1]=ee=U&65535|D<<16;P=G;L=te;U=L&65535;D=L>>>16;Q=P&65535;x=P>>>16;P=e[2];L=t[2];U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;D+=U>>>16;Q+=D>>>16;x+=Q>>>16;e[2]=G=Q&65535|x<<16;t[2]=te=U&65535|D<<16;P=$;L=ne;U=L&65535;D=L>>>16;Q=P&65535;x=P>>>16;P=e[3];L=t[3];U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;D+=U>>>16;Q+=D>>>16;x+=Q>>>16;e[3]=$=Q&65535|x<<16;t[3]=ne=U&65535|D<<16;P=Y;L=re;U=L&65535;D=L>>>16;Q=P&65535;x=P>>>16;P=e[4];L=t[4];U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;D+=U>>>16;Q+=D>>>16;x+=Q>>>16;e[4]=Y=Q&65535|x<<16;t[4]=re=U&65535|D<<16;P=j;L=ie;U=L&65535;D=L>>>16;Q=P&65535;x=P>>>16;P=e[5];L=t[5];U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;D+=U>>>16;Q+=D>>>16;x+=Q>>>16;e[5]=j=Q&65535|x<<16;t[5]=ie=U&65535|D<<16;P=V;L=se;U=L&65535;D=L>>>16;Q=P&65535;x=P>>>16;P=e[6];L=t[6];U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;D+=U>>>16;Q+=D>>>16;x+=Q>>>16;e[6]=V=Q&65535|x<<16;t[6]=se=U&65535|D<<16;P=z;L=oe;U=L&65535;D=L>>>16;Q=P&65535;x=P>>>16;P=e[7];L=t[7];U+=L&65535;D+=L>>>16;Q+=P&65535;x+=P>>>16;D+=U>>>16;Q+=D>>>16;x+=Q>>>16;e[7]=z=Q&65535|x<<16;t[7]=oe=U&65535|D<<16;ae+=128;r-=128}return r}function crypto_hash(e,t,n){var r=new Int32Array(8),i=new Int32Array(8),s=new Uint8Array(256),o,f=n;r[0]=1779033703;r[1]=3144134277;r[2]=1013904242;r[3]=2773480762;r[4]=1359893119;r[5]=2600822924;r[6]=528734635;r[7]=1541459225;i[0]=4089235720;i[1]=2227873595;i[2]=4271175723;i[3]=1595750129;i[4]=2917565137;i[5]=725511199;i[6]=4215389547;i[7]=327033209;crypto_hashblocks_hl(r,i,t,n);n%=128;for(o=0;o<n;o++)s[o]=t[f-n+o];s[n]=128;n=256-128*(n<112?1:0);s[n-9]=0;ts64(s,n-8,f/536870912|0,f<<3);crypto_hashblocks_hl(r,i,s,n);for(o=0;o<8;o++)ts64(e,8*o,r[o],i[o]);return 0}function add(e,t){var n=gf(),r=gf(),i=gf(),s=gf(),o=gf(),f=gf(),l=gf(),h=gf(),p=gf();Z(n,e[1],e[0]);Z(p,t[1],t[0]);M(n,n,p);A(r,e[0],e[1]);A(p,t[0],t[1]);M(r,r,p);M(i,e[3],t[3]);M(i,i,u);M(s,e[2],t[2]);A(s,s,s);Z(o,r,n);Z(f,s,i);A(l,s,i);A(h,r,n);M(e[0],o,f);M(e[1],h,l);M(e[2],l,f);M(e[3],o,h)}function cswap(e,t,n){var r;for(r=0;r<4;r++){sel25519(e[r],t[r],n)}}function pack(e,t){var n=gf(),r=gf(),i=gf();inv25519(i,t[2]);M(n,t[0],i);M(r,t[1],i);pack25519(e,r);e[31]^=par25519(n)<<7}function scalarmult(e,t,n){var r,o;set25519(e[0],i);set25519(e[1],s);set25519(e[2],s);set25519(e[3],i);for(o=255;o>=0;--o){r=n[o/8|0]>>(o&7)&1;cswap(e,t,r);add(t,e);add(e,e);cswap(e,t,r)}}function scalarbase(e,t){var n=[gf(),gf(),gf(),gf()];set25519(n[0],l);set25519(n[1],h);set25519(n[2],s);M(n[3],l,h);scalarmult(e,n,t)}function crypto_sign_keypair(e,t,n){var r=new Uint8Array(64);var i=[gf(),gf(),gf(),gf()];var s;if(!n)randombytes(t,32);crypto_hash(r,t,32);r[0]&=248;r[31]&=127;r[31]|=64;scalarbase(i,r);pack(e,i);for(s=0;s<32;s++)t[s+32]=e[s];return 0}var m=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function modL(e,t){var n,r,i,s;for(r=63;r>=32;--r){n=0;for(i=r-32,s=r-12;i<s;++i){t[i]+=n-16*t[r]*m[i-(r-32)];n=t[i]+128>>8;t[i]-=n*256}t[i]+=n;t[r]=0}n=0;for(i=0;i<32;i++){t[i]+=n-(t[31]>>4)*m[i];n=t[i]>>8;t[i]&=255}for(i=0;i<32;i++)t[i]-=n*m[i];for(r=0;r<32;r++){t[r+1]+=t[r]>>8;e[r]=t[r]&255}}function reduce(e){var t=new Float64Array(64),n;for(n=0;n<64;n++)t[n]=e[n];for(n=0;n<64;n++)e[n]=0;modL(e,t)}function crypto_sign(e,t,n,r){var i=new Uint8Array(64),s=new Uint8Array(64),o=new Uint8Array(64);var f,u,l=new Float64Array(64);var h=[gf(),gf(),gf(),gf()];crypto_hash(i,r,32);i[0]&=248;i[31]&=127;i[31]|=64;var p=n+64;for(f=0;f<n;f++)e[64+f]=t[f];for(f=0;f<32;f++)e[32+f]=i[32+f];crypto_hash(o,e.subarray(32),n+32);reduce(o);scalarbase(h,o);pack(e,h);for(f=32;f<64;f++)e[f]=r[f];crypto_hash(s,e,n+64);reduce(s);for(f=0;f<64;f++)l[f]=0;for(f=0;f<32;f++)l[f]=o[f];for(f=0;f<32;f++){for(u=0;u<32;u++){l[f+u]+=s[f]*i[u]}}modL(e.subarray(32),l);return p}function unpackneg(e,t){var n=gf(),r=gf(),o=gf(),u=gf(),l=gf(),h=gf(),g=gf();set25519(e[2],s);unpack25519(e[1],t);S(o,e[1]);M(u,o,f);Z(o,o,e[2]);A(u,e[2],u);S(l,u);S(h,l);M(g,h,l);M(n,g,o);M(n,n,u);pow2523(n,n);M(n,n,o);M(n,n,u);M(n,n,u);M(e[0],n,u);S(r,e[0]);M(r,r,u);if(neq25519(r,o))M(e[0],e[0],p);S(r,e[0]);M(r,r,u);if(neq25519(r,o))return-1;if(par25519(e[0])===t[31]>>7)Z(e[0],i,e[0]);M(e[3],e[0],e[1]);return 0}function crypto_sign_open(e,t,n,r){var i,s;var o=new Uint8Array(32),f=new Uint8Array(64);var u=[gf(),gf(),gf(),gf()],l=[gf(),gf(),gf(),gf()];s=-1;if(n<64)return-1;if(unpackneg(l,r))return-1;for(i=0;i<n;i++)e[i]=t[i];for(i=0;i<32;i++)e[i+32]=r[i];crypto_hash(f,e,n);reduce(f);scalarmult(u,l,f);scalarbase(l,t.subarray(32));add(u,l);pack(o,u);n-=64;if(crypto_verify_32(t,0,o,0)){for(i=0;i<n;i++)e[i]=0;return-1}for(i=0;i<n;i++)e[i]=t[i+64];s=n;return s}var I=32,b=24,w=32,C=16,k=32,R=32,B=32,v=32,O=32,T=b,P=w,L=C,U=64,D=32,Q=64,x=32,W=64;e.lowlevel={crypto_core_hsalsa20:crypto_core_hsalsa20,crypto_stream_xor:crypto_stream_xor,crypto_stream:crypto_stream,crypto_stream_salsa20_xor:crypto_stream_salsa20_xor,crypto_stream_salsa20:crypto_stream_salsa20,crypto_onetimeauth:crypto_onetimeauth,crypto_onetimeauth_verify:crypto_onetimeauth_verify,crypto_verify_16:crypto_verify_16,crypto_verify_32:crypto_verify_32,crypto_secretbox:crypto_secretbox,crypto_secretbox_open:crypto_secretbox_open,crypto_scalarmult:crypto_scalarmult,crypto_scalarmult_base:crypto_scalarmult_base,crypto_box_beforenm:crypto_box_beforenm,crypto_box_afternm:_,crypto_box:crypto_box,crypto_box_open:crypto_box_open,crypto_box_keypair:crypto_box_keypair,crypto_hash:crypto_hash,crypto_sign:crypto_sign,crypto_sign_keypair:crypto_sign_keypair,crypto_sign_open:crypto_sign_open,crypto_secretbox_KEYBYTES:I,crypto_secretbox_NONCEBYTES:b,crypto_secretbox_ZEROBYTES:w,crypto_secretbox_BOXZEROBYTES:C,crypto_scalarmult_BYTES:k,crypto_scalarmult_SCALARBYTES:R,crypto_box_PUBLICKEYBYTES:B,crypto_box_SECRETKEYBYTES:v,crypto_box_BEFORENMBYTES:O,crypto_box_NONCEBYTES:T,crypto_box_ZEROBYTES:P,crypto_box_BOXZEROBYTES:L,crypto_sign_BYTES:U,crypto_sign_PUBLICKEYBYTES:D,crypto_sign_SECRETKEYBYTES:Q,crypto_sign_SEEDBYTES:x,crypto_hash_BYTES:W};function checkLengths(e,t){if(e.length!==I)throw new Error("bad key size");if(t.length!==b)throw new Error("bad nonce size")}function checkBoxLengths(e,t){if(e.length!==B)throw new Error("bad public key size");if(t.length!==v)throw new Error("bad secret key size")}function checkArrayTypes(){var e,t;for(t=0;t<arguments.length;t++){if((e=Object.prototype.toString.call(arguments[t]))!=="[object Uint8Array]")throw new TypeError("unexpected type "+e+", use Uint8Array")}}function cleanup(e){for(var t=0;t<e.length;t++)e[t]=0}if(!e.util){e.util={};e.util.decodeUTF8=e.util.encodeUTF8=e.util.encodeBase64=e.util.decodeBase64=function(){throw new Error("nacl.util moved into separate package: https://github.com/dchest/tweetnacl-util-js")}}e.randomBytes=function(e){var t=new Uint8Array(e);randombytes(t,e);return t};e.secretbox=function(e,t,n){checkArrayTypes(e,t,n);checkLengths(n,t);var r=new Uint8Array(w+e.length);var i=new Uint8Array(r.length);for(var s=0;s<e.length;s++)r[s+w]=e[s];crypto_secretbox(i,r,r.length,t,n);return i.subarray(C)};e.secretbox.open=function(e,t,n){checkArrayTypes(e,t,n);checkLengths(n,t);var r=new Uint8Array(C+e.length);var i=new Uint8Array(r.length);for(var s=0;s<e.length;s++)r[s+C]=e[s];if(r.length<32)return false;if(crypto_secretbox_open(i,r,r.length,t,n)!==0)return false;return i.subarray(w)};e.secretbox.keyLength=I;e.secretbox.nonceLength=b;e.secretbox.overheadLength=C;e.scalarMult=function(e,t){checkArrayTypes(e,t);if(e.length!==R)throw new Error("bad n size");if(t.length!==k)throw new Error("bad p size");var n=new Uint8Array(k);crypto_scalarmult(n,e,t);return n};e.scalarMult.base=function(e){checkArrayTypes(e);if(e.length!==R)throw new Error("bad n size");var t=new Uint8Array(k);crypto_scalarmult_base(t,e);return t};e.scalarMult.scalarLength=R;e.scalarMult.groupElementLength=k;e.box=function(t,n,r,i){var s=e.box.before(r,i);return e.secretbox(t,n,s)};e.box.before=function(e,t){checkArrayTypes(e,t);checkBoxLengths(e,t);var n=new Uint8Array(O);crypto_box_beforenm(n,e,t);return n};e.box.after=e.secretbox;e.box.open=function(t,n,r,i){var s=e.box.before(r,i);return e.secretbox.open(t,n,s)};e.box.open.after=e.secretbox.open;e.box.keyPair=function(){var e=new Uint8Array(B);var t=new Uint8Array(v);crypto_box_keypair(e,t);return{publicKey:e,secretKey:t}};e.box.keyPair.fromSecretKey=function(e){checkArrayTypes(e);if(e.length!==v)throw new Error("bad secret key size");var t=new Uint8Array(B);crypto_scalarmult_base(t,e);return{publicKey:t,secretKey:new Uint8Array(e)}};e.box.publicKeyLength=B;e.box.secretKeyLength=v;e.box.sharedKeyLength=O;e.box.nonceLength=T;e.box.overheadLength=e.secretbox.overheadLength;e.sign=function(e,t){checkArrayTypes(e,t);if(t.length!==Q)throw new Error("bad secret key size");var n=new Uint8Array(U+e.length);crypto_sign(n,e,e.length,t);return n};e.sign.open=function(e,t){if(arguments.length!==2)throw new Error("nacl.sign.open accepts 2 arguments; did you mean to use nacl.sign.detached.verify?");checkArrayTypes(e,t);if(t.length!==D)throw new Error("bad public key size");var n=new Uint8Array(e.length);var r=crypto_sign_open(n,e,e.length,t);if(r<0)return null;var i=new Uint8Array(r);for(var s=0;s<i.length;s++)i[s]=n[s];return i};e.sign.detached=function(t,n){var r=e.sign(t,n);var i=new Uint8Array(U);for(var s=0;s<i.length;s++)i[s]=r[s];return i};e.sign.detached.verify=function(e,t,n){checkArrayTypes(e,t,n);if(t.length!==U)throw new Error("bad signature size");if(n.length!==D)throw new Error("bad public key size");var r=new Uint8Array(U+e.length);var i=new Uint8Array(U+e.length);var s;for(s=0;s<U;s++)r[s]=t[s];for(s=0;s<e.length;s++)r[s+U]=e[s];return crypto_sign_open(i,r,r.length,n)>=0};e.sign.keyPair=function(){var e=new Uint8Array(D);var t=new Uint8Array(Q);crypto_sign_keypair(e,t);return{publicKey:e,secretKey:t}};e.sign.keyPair.fromSecretKey=function(e){checkArrayTypes(e);if(e.length!==Q)throw new Error("bad secret key size");var t=new Uint8Array(D);for(var n=0;n<t.length;n++)t[n]=e[32+n];return{publicKey:t,secretKey:new Uint8Array(e)}};e.sign.keyPair.fromSeed=function(e){checkArrayTypes(e);if(e.length!==x)throw new Error("bad seed size");var t=new Uint8Array(D);var n=new Uint8Array(Q);for(var r=0;r<32;r++)n[r]=e[r];crypto_sign_keypair(t,n,true);return{publicKey:t,secretKey:n}};e.sign.publicKeyLength=D;e.sign.secretKeyLength=Q;e.sign.seedLength=x;e.sign.signatureLength=U;e.hash=function(e){checkArrayTypes(e);var t=new Uint8Array(W);crypto_hash(t,e,e.length);return t};e.hash.hashLength=W;e.verify=function(e,t){checkArrayTypes(e,t);if(e.length===0||t.length===0)return false;if(e.length!==t.length)return false;return vn(e,0,t,0,e.length)===0?true:false};e.setPRNG=function(e){randombytes=e};(function(){var t=typeof self!=="undefined"?self.crypto||self.msCrypto:null;if(t&&t.getRandomValues){var r=65536;e.setPRNG((function(e,n){var i,s=new Uint8Array(n);for(i=0;i<n;i+=r){t.getRandomValues(s.subarray(i,i+Math.min(n-i,r)))}for(i=0;i<n;i++)e[i]=s[i];cleanup(s)}))}else if(true){t=n(6113);if(t&&t.randomBytes){e.setPRNG((function(e,n){var r,i=t.randomBytes(n);for(r=0;r<n;r++)e[r]=i[r];cleanup(i)}))}}})()})(true&&e.exports?e.exports:self.nacl=self.nacl||{})},4240:(e,t,n)=>{e.exports=require(n.ab+"build/Release/cpufeatures.node")},9041:(e,t,n)=>{e.exports=require(n.ab+"lib/protocol/crypto/build/Release/sshcrypto.node")},9491:e=>{"use strict";e.exports=require("assert")},4300:e=>{"use strict";e.exports=require("buffer")},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},7503:e=>{"use strict";e.exports=require("node:net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},7334:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){if(r===undefined)r=n;Object.defineProperty(e,r,{enumerable:true,get:function(){return t[n]}})}:function(e,t,n,r){if(r===undefined)r=n;e[r]=t[n]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)if(n!=="default"&&Object.prototype.hasOwnProperty.call(e,n))r(t,e,n);i(t,e);return t};var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.NodeSSH=t.SSHError=void 0;const f=o(n(7147));const u=o(n(1017));const l=o(n(9126));const h=o(n(1554));const p=o(n(8741));const g=o(n(869));const _=n(3779);const E=s(n(9491));const y=o(n(5869));const m=1;const DEFAULT_VALIDATE=e=>!u.default.basename(e).startsWith(".");const DEFAULT_TICK=()=>{};class SSHError extends Error{constructor(e,t=null){super(e);this.code=t}}t.SSHError=SSHError;function unixifyPath(e){if(e.includes("\\")){return e.split("\\").join("/")}return e}async function readFile(e){return new Promise(((t,n)=>{f.default.readFile(e,"utf8",((e,r)=>{if(e){n(e)}else{t(r)}}))}))}const I=/Error: (E[\S]+): /;async function makeDirectoryWithSftp(e,t){let n=null;try{n=await new Promise(((n,r)=>{t.stat(e,((e,t)=>{if(e){r(e)}else{n(t)}}))}))}catch(e){}if(n){if(n.isDirectory()){return}throw new Error("mkdir() failed, target already exists and is not a directory")}try{await new Promise(((n,r)=>{t.mkdir(e,(e=>{if(e){r(e)}else{n()}}))}))}catch(e){if(e!=null&&typeof e.stack==="string"){const t=I.exec(e.stack);if(t!=null){throw new SSHError(e.message,t[1])}throw e}}}class NodeSSH{constructor(){this.connection=null}getConnection(){const{connection:e}=this;if(e==null){throw new Error("Not connected to server")}return e}async connect(e){E.default(e!=null&&typeof e==="object","config must be a valid object");const t={...e};E.default(t.username!=null&&typeof t.username==="string","config.username must be a valid string");if(t.host!=null){E.default(typeof t.host==="string","config.host must be a valid string")}else if(t.sock!=null){E.default(typeof t.sock==="object","config.sock must be a valid object")}else{throw new E.AssertionError({message:"Either config.host or config.sock must be provided"})}if(t.privateKey!=null){E.default(typeof t.privateKey==="string","config.privateKey must be a valid string");E.default(t.passphrase==null||typeof t.passphrase==="string","config.passphrase must be a valid string");if(!(t.privateKey.includes("BEGIN")&&t.privateKey.includes("KEY")||t.privateKey.includes("PuTTY-User-Key-File-2"))){try{t.privateKey=await readFile(t.privateKey)}catch(e){if(e!=null&&e.code==="ENOENT"){throw new E.AssertionError({message:"config.privateKey does not exist at given fs path"})}throw e}}}else if(t.password!=null){E.default(typeof t.password==="string","config.password must be a valid string")}if(t.tryKeyboard!=null){E.default(typeof t.tryKeyboard==="boolean","config.tryKeyboard must be a valid boolean")}if(t.tryKeyboard){const{password:e}=t;if(t.onKeyboardInteractive!=null){E.default(typeof t.onKeyboardInteractive==="function","config.onKeyboardInteractive must be a valid function")}else if(e!=null){t.onKeyboardInteractive=(t,n,r,i,s)=>{if(i.length>0&&i[0].prompt.toLowerCase().includes("password")){s([e])}}}}const n=new y.default.Client;this.connection=n;await new Promise(((e,r)=>{n.on("error",r);if(t.onKeyboardInteractive){n.on("keyboard-interactive",t.onKeyboardInteractive)}n.on("ready",(()=>{n.removeListener("error",r);e()}));n.on("end",(()=>{if(this.connection===n){this.connection=null}}));n.on("close",(()=>{if(this.connection===n){this.connection=null}r(new SSHError("No response from server","ETIMEDOUT"))}));n.connect(t)}));return this}isConnected(){return this.connection!=null}async requestShell(e){const t=this.getConnection();return new Promise(((n,r)=>{t.on("error",r);const callback=(e,i)=>{t.removeListener("error",r);if(e){r(e)}else{n(i)}};if(e==null){t.shell(callback)}else{t.shell(e,callback)}}))}async withShell(e,t){E.default(typeof e==="function","callback must be a valid function");const n=await this.requestShell(t);try{await e(n)}finally{if(!n.close()){n.destroy()}}}async requestSFTP(){const e=this.getConnection();return new Promise(((t,n)=>{e.on("error",n);e.sftp(((r,i)=>{e.removeListener("error",n);if(r){n(r)}else{t(i)}}))}))}async withSFTP(e){E.default(typeof e==="function","callback must be a valid function");const t=await this.requestSFTP();try{await e(t)}finally{t.end()}}async execCommand(e,t={}){E.default(typeof e==="string","command must be a valid string");E.default(t!=null&&typeof t==="object","options must be a valid object");E.default(t.cwd==null||typeof t.cwd==="string","options.cwd must be a valid string");E.default(t.stdin==null||typeof t.stdin==="string"||h.default.readable(t.stdin),"options.stdin must be a valid string or readable stream");E.default(t.execOptions==null||typeof t.execOptions==="object","options.execOptions must be a valid object");E.default(t.encoding==null||typeof t.encoding==="string","options.encoding must be a valid string");E.default(t.onChannel==null||typeof t.onChannel==="function","options.onChannel must be a valid function");E.default(t.onStdout==null||typeof t.onStdout==="function","options.onStdout must be a valid function");E.default(t.onStderr==null||typeof t.onStderr==="function","options.onStderr must be a valid function");let n=e;if(t.cwd){n=`cd ${p.default([t.cwd])} ; ${n}`}const r=this.getConnection();const i={stdout:[],stderr:[]};return new Promise(((e,s)=>{r.on("error",s);r.exec(n,t.execOptions!=null?t.execOptions:{},((n,o)=>{r.removeListener("error",s);if(n){s(n);return}if(t.onChannel){t.onChannel(o)}o.on("data",(e=>{if(t.onStdout)t.onStdout(e);i.stdout.push(e.toString(t.encoding))}));o.stderr.on("data",(e=>{if(t.onStderr)t.onStderr(e);i.stderr.push(e.toString(t.encoding))}));if(t.stdin!=null){if(h.default.readable(t.stdin)){t.stdin.pipe(o,{end:true})}else{o.write(t.stdin);o.end()}}else{o.end()}let f=null;let u=null;o.on("exit",((e,t)=>{f=e!==null&&e!==void 0?e:null;u=t!==null&&t!==void 0?t:null}));o.on("close",(()=>{e({code:f!=null?f:null,signal:u!=null?u:null,stdout:i.stdout.join("").trim(),stderr:i.stderr.join("").trim()})}))}))}))}async exec(e,t,n={}){E.default(typeof e==="string","command must be a valid string");E.default(Array.isArray(t),"parameters must be a valid array");E.default(n!=null&&typeof n==="object","options must be a valid object");E.default(n.stream==null||["both","stdout","stderr"].includes(n.stream),"options.stream must be one of both, stdout, stderr");for(let e=0,{length:n}=t;e<n;e+=1){E.default(typeof t[e]==="string",`parameters[${e}] must be a valid string`)}const r=`${e} ${p.default(t)}`;const i=await this.execCommand(r,n);if(n.stream==null||n.stream==="stdout"){if(i.stderr){throw new Error(i.stderr)}return i.stdout}if(n.stream==="stderr"){return i.stderr}return i}async mkdir(e,t="sftp",n=null){E.default(typeof e==="string","path must be a valid string");E.default(typeof t==="string"&&(t==="sftp"||t==="exec"),"method must be either sftp or exec");E.default(n==null||typeof n==="object","sftp must be a valid object");if(t==="exec"){await this.exec("mkdir",["-p",unixifyPath(e)]);return}const r=n||await this.requestSFTP();const makeSftpDirectory=async t=>makeDirectoryWithSftp(unixifyPath(e),r).catch((async n=>{if(!t||n==null||n.message!=="No such file"&&n.code!=="ENOENT"){throw n}await this.mkdir(u.default.dirname(e),"sftp",r);await makeSftpDirectory(false)}));try{await makeSftpDirectory(true)}finally{if(!n){r.end()}}}async getFile(e,t,n=null,r=null){E.default(typeof e==="string","localFile must be a valid string");E.default(typeof t==="string","remoteFile must be a valid string");E.default(n==null||typeof n==="object","sftp must be a valid object");E.default(r==null||typeof r==="object","transferOptions must be a valid object");const i=n||await this.requestSFTP();try{await new Promise(((n,s)=>{i.fastGet(unixifyPath(t),e,r||{},(e=>{if(e){s(e)}else{n()}}))}))}finally{if(!n){i.end()}}}async putFile(e,t,n=null,r=null){E.default(typeof e==="string","localFile must be a valid string");E.default(typeof t==="string","remoteFile must be a valid string");E.default(n==null||typeof n==="object","sftp must be a valid object");E.default(r==null||typeof r==="object","transferOptions must be a valid object");E.default(await new Promise((t=>{f.default.access(e,f.default.constants.R_OK,(e=>{t(e===null)}))})),`localFile does not exist at ${e}`);const i=n||await this.requestSFTP();const putFile=n=>new Promise(((s,o)=>{i.fastPut(e,unixifyPath(t),r||{},(e=>{if(e==null){s();return}if(e.message==="No such file"&&n){s(this.mkdir(u.default.dirname(t),"sftp",i).then((()=>putFile(false))))}else{o(e)}}))}));try{await putFile(true)}finally{if(!n){i.end()}}}async putFiles(e,{concurrency:t=m,sftp:n=null,transferOptions:r={}}={}){E.default(Array.isArray(e),"files must be an array");for(let t=0,{length:n}=e;t<n;t+=1){const n=e[t];E.default(n,"files items must be valid objects");E.default(n.local&&typeof n.local==="string",`files[${t}].local must be a string`);E.default(n.remote&&typeof n.remote==="string",`files[${t}].remote must be a string`)}const i=[];const s=n||await this.requestSFTP();const o=new _.PromiseQueue({concurrency:t});try{await new Promise(((t,n)=>{e.forEach((e=>{o.add((async()=>{await this.putFile(e.local,e.remote,s,r);i.push(e)})).catch(n)}));o.waitTillIdle().then(t)}))}catch(e){if(e!=null){e.transferred=i}throw e}finally{if(!n){s.end()}}}async putDirectory(e,t,{concurrency:n=m,sftp:r=null,transferOptions:i={},recursive:s=true,tick:o=DEFAULT_TICK,validate:l=DEFAULT_VALIDATE}={}){E.default(typeof e==="string"&&e,"localDirectory must be a string");E.default(typeof t==="string"&&t,"remoteDirectory must be a string");const h=await new Promise((t=>{f.default.stat(e,((e,n)=>{t(n||null)}))}));E.default(h!=null,`localDirectory does not exist at ${e}`);E.default(h.isDirectory(),`localDirectory is not a directory at ${e}`);const p=r||await this.requestSFTP();const y=await g.default(e,{recursive:s,validate:l});const I=y.files.map((t=>u.default.relative(e,t)));const b=y.directories.map((t=>u.default.relative(e,t)));b.sort(((e,t)=>e.length-t.length));let w=false;try{await new Promise(((e,r)=>{const i=new _.PromiseQueue({concurrency:n});b.forEach((e=>{i.add((async()=>{await this.mkdir(u.default.join(t,e),"sftp",p)})).catch(r)}));e(i.waitTillIdle())}));await new Promise(((r,s)=>{const f=new _.PromiseQueue({concurrency:n});I.forEach((n=>{f.add((async()=>{const r=u.default.join(e,n);const s=u.default.join(t,n);try{await this.putFile(r,s,p,i);o(r,s,null)}catch(e){w=true;o(r,s,e)}})).catch(s)}));r(f.waitTillIdle())}))}finally{if(!r){p.end()}}return!w}async getDirectory(e,t,{concurrency:n=m,sftp:r=null,transferOptions:i={},recursive:s=true,tick:o=DEFAULT_TICK,validate:h=DEFAULT_VALIDATE}={}){E.default(typeof e==="string"&&e,"localDirectory must be a string");E.default(typeof t==="string"&&t,"remoteDirectory must be a string");const p=await new Promise((t=>{f.default.stat(e,((e,n)=>{t(n||null)}))}));E.default(p!=null,`localDirectory does not exist at ${e}`);E.default(p.isDirectory(),`localDirectory is not a directory at ${e}`);const y=r||await this.requestSFTP();const I=await g.default(t,{recursive:s,validate:h,concurrency:n,fileSystem:{basename(e){return u.default.posix.basename(e)},join(e,t){return u.default.posix.join(e,t)},readdir(e){return new Promise(((t,n)=>{y.readdir(e,((e,r)=>{if(e){n(e)}else{t(r.map((e=>e.filename)))}}))}))},stat(e){return new Promise(((t,n)=>{y.stat(e,((e,r)=>{if(e){n(e)}else{t(r)}}))}))}}});const b=I.files.map((e=>u.default.relative(t,e)));const w=I.directories.map((e=>u.default.relative(t,e)));w.sort(((e,t)=>e.length-t.length));let C=false;try{await new Promise(((t,r)=>{const i=new _.PromiseQueue({concurrency:n});w.forEach((t=>{i.add((async()=>{await l.default(u.default.join(e,t))})).catch(r)}));t(i.waitTillIdle())}));await new Promise(((r,s)=>{const f=new _.PromiseQueue({concurrency:n});b.forEach((n=>{f.add((async()=>{const r=u.default.join(e,n);const s=u.default.join(t,n);try{await this.getFile(r,s,y,i);o(r,s,null)}catch(e){C=true;o(r,s,e)}})).catch(s)}));r(f.waitTillIdle())}))}finally{if(!r){y.end()}}return!C}dispose(){if(this.connection){this.connection.end();this.connection=null}}}t.NodeSSH=NodeSSH},3779:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function PromiseQueue(e){var t=(e===void 0?{}:e).concurrency,n=t===void 0?1:t;this.options={concurrency:n};this.running=0;this.queue=[];this.idleCallbacks=[]}PromiseQueue.prototype.clear=function(){this.queue=[]};PromiseQueue.prototype.onIdle=function(e){var t=this;this.idleCallbacks.push(e);return function(){var n=t.idleCallbacks.indexOf(e);if(n!==-1){t.idleCallbacks.splice(n,1)}}};PromiseQueue.prototype.waitTillIdle=function(){var e=this;return new Promise((function(t){if(e.running===0){t();return}var n=e.onIdle((function(){n();t()}))}))};PromiseQueue.prototype.add=function(e){var t=this;return new Promise((function(n,r){var runCallback=function(){t.running+=1;try{Promise.resolve(e()).then((function(e){n(e);t.processNext()}),(function(e){r(e);t.processNext()}))}catch(e){r(e);t.processNext()}};if(t.running>=t.options.concurrency){t.queue.push(runCallback)}else{runCallback()}}))};PromiseQueue.prototype.processNext=function(){this.running-=1;var e=this.queue.shift();if(e){e()}else if(this.running===0){this.idleCallbacks.forEach((function(e){return e()}))}};return PromiseQueue}();t.PromiseQueue=n},869:function(e,t,n){"use strict";var r=this&&this.__assign||function(){r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i))e[i]=t[i]}return e};return r.apply(this,arguments)};var i=this&&this.__awaiter||function(e,t,n,r){function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r["throw"](e))}catch(e){i(e)}}function step(e){e.done?n(e.value):adopt(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};var s=this&&this.__generator||function(e,t){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function verb(e){return function(t){return step([e,t])}}function step(o){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(s=o[0]&2?i["return"]:o[0]?i["throw"]||((s=i["return"])&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;if(i=0,s)o=[o[0]&2,s.value];switch(o[0]){case 0:case 1:s=o;break;case 4:n.label++;return{value:o[1],done:false};case 5:n.label++;i=o[1];o=[0];continue;case 7:o=n.ops.pop();n.trys.pop();continue;default:if(!(s=n.trys,s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){n=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){n.label=o[1];break}if(o[0]===6&&n.label<s[1]){n.label=s[1];s=o;break}if(s&&n.label<s[2]){n.label=s[2];n.ops.push(o);break}if(s[2])n.ops.pop();n.trys.pop();continue}o=t.call(e,n)}catch(e){o=[6,e];i=0}finally{r=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}};var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.defaultFilesystem=void 0;var f=o(n(7147));var u=o(n(1017));var l=o(n(9491));var h=n(3779);t.defaultFilesystem={join:function(e,t){return u.default.join(e,t)},basename:function(e){return u.default.basename(e)},stat:function(e){return new Promise((function(t,n){f.default.stat(e,(function(e,r){if(e){n(e)}else{t(r)}}))}))},readdir:function(e){return new Promise((function(t,n){f.default.readdir(e,(function(e,r){if(e){n(e)}else{t(r)}}))}))}};function scanDirectoryInternal(e){var t=e.path,n=e.recursive,r=e.validate,o=e.result,f=e.fileSystem,u=e.queue,l=e.reject;return i(this,void 0,void 0,(function(){var e,i;return s(this,(function(s){switch(s.label){case 0:return[4,f.stat(t)];case 1:e=s.sent();if(e.isFile()){o.files.push(t)}else if(e.isDirectory()){o.directories.push(t)}if(!e.isDirectory()||n==="none"){return[2]}return[4,f.readdir(t)];case 2:i=s.sent();i.forEach((function(e){var i=f.join(t,e);if(!r(i)){return}u.add((function(){return scanDirectoryInternal({path:i,recursive:n==="shallow"?"none":"deep",validate:r,result:o,fileSystem:f,queue:u,reject:l})})).catch(l)}));return[2]}}))}))}function scanDirectory(e,n){var o=n===void 0?{}:n,f=o.recursive,u=f===void 0?true:f,p=o.validate,g=p===void 0?null:p,_=o.concurrency,E=_===void 0?Infinity:_,y=o.fileSystem,m=y===void 0?t.defaultFilesystem:y;return i(this,void 0,void 0,(function(){var n,i,o;return s(this,(function(s){switch(s.label){case 0:l.default(e&&typeof e==="string","path must be a valid string");l.default(typeof u==="boolean","options.recursive must be a valid boolean");l.default(g===null||typeof g==="function","options.validate must be a valid function");l.default(typeof E==="number","options.concurrency must be a valid number");l.default(m!==null&&typeof m==="object","options.fileSystem must be a valid object");n=new h.PromiseQueue({concurrency:E});i={files:[],directories:[]};o=r(r({},t.defaultFilesystem),m);return[4,new Promise((function(t,r){scanDirectoryInternal({path:e,recursive:u?"deep":"shallow",validate:g!=null?g:function(e){return o.basename(e).slice(0,1)!=="."},result:i,fileSystem:o,queue:n,reject:r}).then((function(){return n.waitTillIdle()})).then(t,r)}))];case 1:s.sent();return[2,i]}}))}))}t["default"]=scanDirectory},6674:e=>{"use strict";e.exports={i8:"1.11.0"}}};var t={};function __nccwpck_require__(n){var r=t[n];if(r!==undefined){return r.exports}var i=t[n]={exports:{}};var s=true;try{e[n].call(i.exports,i,i.exports,__nccwpck_require__);s=false}finally{if(s)delete t[n]}return i.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var n={};(()=>{"use strict";var e=n;Object.defineProperty(e,"__esModule",{value:true});const t=__nccwpck_require__(7503);const r=__nccwpck_require__(2186);const i=__nccwpck_require__(7334);const run=async()=>{try{const e=(0,r.getInput)("host",{required:true});const n=(0,r.getInput)("port");const s=(0,r.getInput)("username",{required:true});const o=(0,r.getInput)("privateKey",{required:true});const f=(0,r.getInput)("pm2");const u=(0,r.getBooleanInput)("dependencies");const l=(0,r.getInput)("destination",{required:true});const h=(0,r.getInput)("file");if(!(0,t.isIPv4)(e))throw new Error("Invalid Hostname");const p=new i.NodeSSH;await p.connect({host:e,port:parseInt(n),username:s,privateKey:o});await p.putFile(`./${h}`,`${l}/${h}`);if(u){await p.putFile("./package.json",`${l}/package.json`);await p.putFile("./package-lock.json",`${l}/package-lock.json`);await p.execCommand("npm i",{cwd:l})}if(f)await p.execCommand(`pm2 restart ${f} --cron-restart="0 0 * * *" --exp-backoff-restart-delay=100`);if(p.connection)p.connection.end()}catch(e){if(e instanceof Error)(0,r.setFailed)(e.message);else(0,r.setFailed)("Unknown Error")}finally{process.exit()}};run()})();module.exports=n})();